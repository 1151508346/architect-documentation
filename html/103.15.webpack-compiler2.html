<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>架构师成长计划</title>
    <link rel="stylesheet" type="text/css" href="../static/css/main.css">
    <link rel="stylesheet" href="../static/bootstrap/bootstrap.min.css" >
    <style>
        .page-toc > ul .red {
            background: #f3f3f3;
            z-index: 1;
            border-left: 3px solid #009a61;
            -webkit-transition: all .2s ease;
            transition: all .2s ease;
            color: #000
        }
    </style>
</head>
<body>
<div class="nav">
  <div class="logo">架构师成长计划</div>
  <ul>
    <li><a href="../index.html">0.api</a></li>
    <li><a href="../html/0.Async.html">0.Async</a></li>
    <li><a href="../html/0.module.html">0.module</a></li>
    <li><a href="../html/1.ES2015.html">1.ES2015</a></li>
    <li><a href="../html/2.Promise.html">2.Promise</a></li>
    <li><a href="../html/3.Node.html">3.Node</a></li>
    <li><a href="../html/4.NodeInstall.html">4.NodeInstall</a></li>
    <li><a href="../html/5.REPL.html">5.REPL</a></li>
    <li><a href="../html/6.NodeCore.html">6.NodeCore</a></li>
    <li><a href="../html/7.module&NPM.html">7.module&NPM</a></li>
    <li><a href="../html/8.Encoding.html">8.Encoding</a></li>
    <li><a href="../html/9.Buffer.html">9.Buffer</a></li>
    <li><a href="../html/10.fs.html">10.fs</a></li>
    <li><a href="../html/11.Stream-1.html">11.Stream-1</a></li>
    <li><a href="../html/11.Stream-2.html">11.Stream-2</a></li>
    <li><a href="../html/11.Stream-3.html">11.Stream-3</a></li>
    <li><a href="../html/11.Stream-4.html">11.Stream-4</a></li>
    <li><a href="../html/12-Network-2.html">12-Network-2</a></li>
    <li><a href="../html/12.NetWork-3.html">12.NetWork-3</a></li>
    <li><a href="../html/12.Network-1.html">12.Network-1</a></li>
    <li><a href="../html/13.tcp.html">13.tcp</a></li>
    <li><a href="../html/14.http-1.html">14.http-1</a></li>
    <li><a href="../html/14.http-2.html">14.http-2</a></li>
    <li><a href="../html/15.compress.html">15.compress</a></li>
    <li><a href="../html/16.crypto.html">16.crypto</a></li>
    <li><a href="../html/17.process.html">17.process</a></li>
    <li><a href="../html/18.yargs.html">18.yargs</a></li>
    <li><a href="../html/19.cache.html">19.cache</a></li>
    <li><a href="../html/20.action.html">20.action</a></li>
    <li><a href="../html/21.https.html">21.https</a></li>
    <li><a href="../html/22.cookie.html">22.cookie</a></li>
    <li><a href="../html/23.session.html">23.session</a></li>
    <li><a href="../html/24.express-1.html">24.express-1</a></li>
    <li><a href="../html/24.express-2.html">24.express-2</a></li>
    <li><a href="../html/24.express-3.html">24.express-3</a></li>
    <li><a href="../html/24.express-4.html">24.express-4</a></li>
    <li><a href="../html/25.koa-1.html">25.koa-1</a></li>
    <li><a href="../html/26.webpack-1-basic.html">26.webpack-1-basic</a></li>
    <li>
      <a href="../html/26.webpack-2-optimize.html">26.webpack-2-optimize</a>
    </li>
    <li><a href="../html/26.webpack-3-file.html">26.webpack-3-file</a></li>
    <li>
      <a href="../html/26.webpack-4.tapable.html">26.webpack-4.tapable</a>
    </li>
    <li><a href="../html/26.webpack-5-AST.html">26.webpack-5-AST</a></li>
    <li>
      <a href="../html/26.webpack-6-sources.html">26.webpack-6-sources</a>
    </li>
    <li><a href="../html/26.webpack-7-loader.html">26.webpack-7-loader</a></li>
    <li><a href="../html/26.webpack-8-plugin.html">26.webpack-8-plugin</a></li>
    <li><a href="../html/26.webpack-9-hand.html">26.webpack-9-hand</a></li>
    <li>
      <a href="../html/26.webpack-10-prepare.html">26.webpack-10-prepare</a>
    </li>
    <li><a href="../html/28.redux.html">28.redux</a></li>
    <li><a href="../html/28.redux-jwt-back.html">28.redux-jwt-back</a></li>
    <li><a href="../html/28.redux-jwt-front.html">28.redux-jwt-front</a></li>
    <li><a href="../html/29.mongodb-1.html">29.mongodb-1</a></li>
    <li><a href="../html/29.mongodb-2.html">29.mongodb-2</a></li>
    <li><a href="../html/29.mongodb-3.html">29.mongodb-3</a></li>
    <li><a href="../html/29.mongodb-4.html">29.mongodb-4</a></li>
    <li><a href="../html/29.mongodb-5.html">29.mongodb-5</a></li>
    <li><a href="../html/29.mongodb-6.html">29.mongodb-6</a></li>
    <li><a href="../html/30.cms-1-mysql.html">30.cms-1-mysql</a></li>
    <li><a href="../html/30.cms-2-mysql.html">30.cms-2-mysql</a></li>
    <li><a href="../html/30.cms-3-mysql.html">30.cms-3-mysql</a></li>
    <li><a href="../html/30.cms-4-nunjucks.html">30.cms-4-nunjucks</a></li>
    <li><a href="../html/30.cms-5-mock.html">30.cms-5-mock</a></li>
    <li><a href="../html/30.cms-6-egg.html">30.cms-6-egg</a></li>
    <li><a href="../html/30.cms-7-api.html">30.cms-7-api</a></li>
    <li><a href="../html/30.cms-8-roadhog.html">30.cms-8-roadhog</a></li>
    <li><a href="../html/30.cms-9-yaml.html">30.cms-9-yaml</a></li>
    <li><a href="../html/30.cms-10-umi.html">30.cms-10-umi</a></li>
    <li><a href="../html/30.cms-12-dva.html">30.cms-12-dva</a></li>
    <li><a href="../html/30.cms-13-dva-ant.html">30.cms-13-dva-ant</a></li>
    <li><a href="../html/30.cms-14-front.html">30.cms-14-front</a></li>
    <li><a href="../html/30.cms-15-deploy.html">30.cms-15-deploy</a></li>
    <li><a href="../html/31.dva.html">31.dva</a></li>
    <li>
      <a href="../html/31.cms-13-dva-antdesign.html">31.cms-13-dva-antdesign</a>
    </li>
    <li><a href="../html/33.redis.html">33.redis</a></li>
    <li><a href="../html/34.unittest.html">34.unittest</a></li>
    <li><a href="../html/35.jwt.html">35.jwt</a></li>
    <li><a href="../html/36.websocket-1.html">36.websocket-1</a></li>
    <li><a href="../html/36.websocket-2.html">36.websocket-2</a></li>
    <li><a href="../html/38.chat-api-1.html">38.chat-api-1</a></li>
    <li><a href="../html/38.chat-api-2.html">38.chat-api-2</a></li>
    <li><a href="../html/38.chat-3.html">38.chat-3</a></li>
    <li><a href="../html/38.chat-api-3.html">38.chat-api-3</a></li>
    <li><a href="../html/38.chat.html">38.chat</a></li>
    <li><a href="../html/38.chat2.html">38.chat2</a></li>
    <li><a href="../html/38.chat2.html">38.chat2</a></li>
    <li><a href="../html/39.crawl-0.html">39.crawl-0</a></li>
    <li><a href="../html/39.crawl-1.html">39.crawl-1</a></li>
    <li><a href="../html/39.crawl-2.html">39.crawl-2</a></li>
    <li><a href="../html/40.deploy.html">40.deploy</a></li>
    <li><a href="../html/41.safe.html">41.safe</a></li>
    <li><a href="../html/42.test.html">42.test</a></li>
    <li><a href="../html/43.nginx.html">43.nginx</a></li>
    <li><a href="../html/44.enzyme.html">44.enzyme</a></li>
    <li><a href="../html/45.docker.html">45.docker</a></li>
    <li><a href="../html/46.elastic.html">46.elastic</a></li>
    <li><a href="../html/47.oauth.html">47.oauth</a></li>
    <li><a href="../html/48.wxpay.html">48.wxpay</a></li>
    <li><a href="../html/index.html">index</a></li>
    <li><a href="../html/52.UML.html">52.UML</a></li>
    <li><a href="../html/53.design.html">53.design</a></li>
    <li><a href="../html/index.html">index</a></li>
    <li><a href="../html/54.linux.html">54.linux</a></li>
    <li><a href="../html/57.ts.html">57.ts</a></li>
    <li><a href="../html/56.react-ssr.html">56.react-ssr</a></li>
    <li><a href="../html/58.ts_react.html">58.ts_react</a></li>
    <li><a href="../html/59.ketang.html">59.ketang</a></li>
    <li><a href="../html/59.ketang2.html">59.ketang2</a></li>
    <li><a href="../html/61.1.devops-linux.html">61.1.devops-linux</a></li>
    <li><a href="../html/61.2.devops-vi.html">61.2.devops-vi</a></li>
    <li><a href="../html/61.3.devops-user.html">61.3.devops-user</a></li>
    <li><a href="../html/61.4.devops-auth.html">61.4.devops-auth</a></li>
    <li><a href="../html/61.5.devops-shell.html">61.5.devops-shell</a></li>
    <li><a href="../html/61.6.devops-install.html">61.6.devops-install</a></li>
    <li><a href="../html/61.7.devops-system.html">61.7.devops-system</a></li>
    <li><a href="../html/61.8.devops-service.html">61.8.devops-service</a></li>
    <li><a href="../html/61.9.devops-network.html">61.9.devops-network</a></li>
    <li><a href="../html/61.10.devops-nginx.html">61.10.devops-nginx</a></li>
    <li><a href="../html/61.11.devops-docker.html">61.11.devops-docker</a></li>
    <li><a href="../html/61.12.devops-jekins.html">61.12.devops-jekins</a></li>
    <li><a href="../html/61.13.devops-groovy.html">61.13.devops-groovy</a></li>
    <li><a href="../html/61.14.devops-php.html">61.14.devops-php</a></li>
    <li><a href="../html/61.15.devops-java.html">61.15.devops-java</a></li>
    <li><a href="../html/61.16.devops-node.html">61.16.devops-node</a></li>
    <li><a href="../html/61.17.devops-k8s.html">61.17.devops-k8s</a></li>
    <li><a href="../html/62.1.react-basic.html">62.1.react-basic</a></li>
    <li><a href="../html/62.2.react-state.html">62.2.react-state</a></li>
    <li><a href="../html/62.3.react-high.html">62.3.react-high</a></li>
    <li><a href="../html/62.4.react-optimize.html">62.4.react-optimize</a></li>
    <li><a href="../html/62.5.react-hooks.html">62.5.react-hooks</a></li>
    <li>
      <a href="../html/62.6.react-immutable.html">62.6.react-immutable</a>
    </li>
    <li><a href="../html/62.7.react-mobx.html">62.7.react-mobx</a></li>
    <li><a href="../html/62.8.react-source.html">62.8.react-source</a></li>
    <li><a href="../html/63.1.redux.html">63.1.redux</a></li>
    <li>
      <a href="../html/63.2.redux-middleware.html">63.2.redux-middleware</a>
    </li>
    <li><a href="../html/63.3.redux-hooks.html">63.3.redux-hooks</a></li>
    <li><a href="../html/63.4.redux-saga.html">63.4.redux-saga</a></li>
    <li>
      <a href="../html/63.5.redux-saga-hand.html">63.5.redux-saga-hand</a>
    </li>
    <li><a href="../html/64.1.router.html">64.1.router</a></li>
    <li>
      <a href="../html/64.2.router-connected.html">64.2.router-connected</a>
    </li>
    <li><a href="../html/65.1.typescript.html">65.1.typescript</a></li>
    <li><a href="../html/65.2.typescript.html">65.2.typescript</a></li>
    <li><a href="../html/65.3.typescript.html">65.3.typescript</a></li>
    <li><a href="../html/65.4.antd.html">65.4.antd</a></li>
    <li><a href="../html/65.4.definition.html">65.4.definition</a></li>
    <li><a href="../html/66-1.vue-base.html">66-1.vue-base</a></li>
    <li><a href="../html/66-2.vue-component.html">66-2.vue-component</a></li>
    <li><a href="../html/66-3.vue-cli3.0.html">66-3.vue-cli3.0</a></li>
    <li><a href="../html/66-4.$message组件.html">66-4.$message组件</a></li>
    <li><a href="../html/66-5.Form组件.html">66-5.Form组件</a></li>
    <li><a href="../html/66-6.tree.html">66-6.tree</a></li>
    <li>
      <a href="../html/66-7.vue-router-apply.html">66-7.vue-router-apply</a>
    </li>
    <li><a href="../html/66-8.axios-apply.html">66-8.axios-apply</a></li>
    <li><a href="../html/66-9.vuex-apply.html">66-9.vuex-apply</a></li>
    <li><a href="../html/66-10.jwt-vue.html">66-10.jwt-vue</a></li>
    <li><a href="../html/66-11.vue-ssr.html">66-11.vue-ssr</a></li>
    <li><a href="../html/66-12.nuxt-apply.html">66-12.nuxt-apply</a></li>
    <li><a href="../html/66-13.pwa.html">66-13.pwa</a></li>
    <li><a href="../html/66-14.vue单元测试.html">66-14.vue单元测试</a></li>
    <li><a href="../html/66-15.权限校验.html">66-15.权限校验</a></li>
    <li><a href="../html/67-1-network.html">67-1-network</a></li>
    <li><a href="../html/68-2-wireshark.html">68-2-wireshark</a></li>
    <li><a href="../html/7.npm2.html">7.npm2</a></li>
    <li><a href="../html/69-hooks.html">69-hooks</a></li>
    <li><a href="../html/70-deploy.html">70-deploy</a></li>
    <li><a href="../html/71-hmr.html">71-hmr</a></li>
    <li><a href="../html/72.deploy.html">72.deploy</a></li>
    <li><a href="../html/73.import.html">73.import</a></li>
    <li><a href="../html/74.mobile.html">74.mobile</a></li>
    <li>
      <a href="../html/75.webpack-1.文件分析.html">75.webpack-1.文件分析</a>
    </li>
    <li><a href="../html/75.webpack-2.loader.html">75.webpack-2.loader</a></li>
    <li>
      <a href="../html/75.webpack-3.源码流程.html">75.webpack-3.源码流程</a>
    </li>
    <li>
      <a href="../html/75.webpack-4.tapable.html">75.webpack-4.tapable</a>
    </li>
    <li>
      <a href="../html/75.webpack-5.prepare.html">75.webpack-5.prepare</a>
    </li>
    <li>
      <a href="../html/75.webpack-6.resolve.html">75.webpack-6.resolve</a>
    </li>
    <li><a href="../html/75.webpack-7.loader.html">75.webpack-7.loader</a></li>
    <li><a href="../html/75.webpack-8.module.html">75.webpack-8.module</a></li>
    <li><a href="../html/75.webpack-9.chunk.html">75.webpack-9.chunk</a></li>
    <li><a href="../html/75.webpack-10.asset.html">75.webpack-10.asset</a></li>
    <li><a href="../html/75.webpack-11.实现.html">75.webpack-11.实现</a></li>
    <li><a href="../html/76.react_optimize.html">76.react_optimize</a></li>
    <li><a href="../html/77.ts_ketang_back.html">77.ts_ketang_back</a></li>
    <li><a href="../html/77.ts_ketang_front.html">77.ts_ketang_front</a></li>
    <li><a href="../html/78.vue-domdiff.html">78.vue-domdiff</a></li>
    <li><a href="../html/79.grammar.html">79.grammar</a></li>
    <li><a href="../html/80.tree.html">80.tree</a></li>
    <li><a href="../html/81.axios.html">81.axios</a></li>
    <li><a href="../html/82.1.react.html">82.1.react</a></li>
    <li><a href="../html/82.2.react-high.html">82.2.react-high</a></li>
    <li><a href="../html/82.3.react-router.html">82.3.react-router</a></li>
    <li><a href="../html/82.4.redux.html">82.4.redux</a></li>
    <li>
      <a href="../html/82.5.redux_middleware.html">82.5.redux_middleware</a>
    </li>
    <li><a href="../html/82.6.connected.html">82.6.connected</a></li>
    <li><a href="../html/82.7.saga.html">82.7.saga</a></li>
    <li><a href="../html/82.8.dva.html">82.8.dva</a></li>
    <li><a href="../html/82.8.dva-source.html">82.8.dva-source</a></li>
    <li><a href="../html/82.9.roadhog.html">82.9.roadhog</a></li>
    <li><a href="../html/82.10.umi.html">82.10.umi</a></li>
    <li><a href="../html/82.11.antdesign.html">82.11.antdesign</a></li>
    <li><a href="../html/82.12.ketang-front.html">82.12.ketang-front</a></li>
    <li><a href="../html/82.12.ketang-back.html">82.12.ketang-back</a></li>
    <li><a href="../html/83.upload.html">83.upload</a></li>
    <li><a href="../html/84.graphql.html">84.graphql</a></li>
    <li><a href="../html/85.antpro.html">85.antpro</a></li>
    <li><a href="../html/86.1.uml.html">86.1.uml</a></li>
    <li><a href="../html/86.2.design.html">86.2.design</a></li>
    <li><a href="../html/87.postcss.html">87.postcss</a></li>
    <li><a href="../html/88.react16-1.html">88.react16-1</a></li>
    <li><a href="../html/89.nextjs.html">89.nextjs</a></li>
    <li><a href="../html/90.react-test.html">90.react-test</a></li>
    <li><a href="../html/91.react-ts.html">91.react-ts</a></li>
    <li><a href="../html/92.rbac.html">92.rbac</a></li>
    <li><a href="../html/93.tsnode.html">93.tsnode</a></li>
    <li><a href="../html/94.1.JavaScript.html">94.1.JavaScript</a></li>
    <li><a href="../html/94.2.JavaScript.html">94.2.JavaScript</a></li>
    <li><a href="../html/94.3.MODULE.html">94.3.MODULE</a></li>
    <li><a href="../html/94.4.EventLoop.html">94.4.EventLoop</a></li>
    <li><a href="../html/94.5.文件上传.html">94.5.文件上传</a></li>
    <li><a href="../html/94.6.https.html">94.6.https</a></li>
    <li><a href="../html/94.7. nginx.html">94.7. nginx</a></li>
    <li><a href="../html/95.1. react.html">95.1. react</a></li>
    <li><a href="../html/95.2.react.html">95.2.react</a></li>
    <li><a href="../html/96.1.react16.html">96.1.react16</a></li>
    <li><a href="../html/96.2.fiber.html">96.2.fiber</a></li>
    <li><a href="../html/96.3.fiber.html">96.3.fiber</a></li>
    <li><a href="../html/97.serverless.html">97.serverless</a></li>
    <li><a href="../html/98.websocket.html">98.websocket</a></li>
    <li><a href="../html/100.1.react-basic.html">100.1.react-basic</a></li>
    <li><a href="../html/101.1.monitor.html">101.1.monitor</a></li>
    <li><a href="../html/101.2.monitor.html">101.2.monitor</a></li>
    <li><a href="../html/102.java.html">102.java</a></li>
    <li><a href="../html/103.1.webpack-usage.html">103.1.webpack-usage</a></li>
    <li>
      <a href="../html/103.2.webpack-bundle.html">103.2.webpack-bundle</a>
    </li>
    <li><a href="../html/103.3.webpack-ast.html">103.3.webpack-ast</a></li>
    <li><a href="../html/103.4.webpack-flow.html">103.4.webpack-flow</a></li>
    <li>
      <a href="../html/103.5.webpack-loader.html">103.5.webpack-loader</a>
    </li>
    <li>
      <a href="../html/103.6.webpack-tapable.html">103.6.webpack-tapable</a>
    </li>
    <li>
      <a href="../html/103.7.webpack-plugin.html">103.7.webpack-plugin</a>
    </li>
    <li>
      <a href="../html/103.8.webpack-optimize1.html">103.8.webpack-optimize1</a>
    </li>
    <li>
      <a href="../html/103.9.webpack-optimize2.html">103.9.webpack-optimize2</a>
    </li>
    <li><a href="../html/103.10.webpack-hand.html">103.10.webpack-hand</a></li>
    <li><a href="../html/103.11.webpack-hmr.html">103.11.webpack-hmr</a></li>
    <li><a href="../html/103.13.splitChunks.html">103.13.splitChunks</a></li>
    <li>
      <a href="../html/103.14.webpack-sourcemap.html"
        >103.14.webpack-sourcemap</a
      >
    </li>
    <li>
      <a href="../html/103.15.webpack-compiler1.html"
        >103.15.webpack-compiler1</a
      >
    </li>
    <li>
      <a href="../html/103.15.webpack-compiler2.html"
        >103.15.webpack-compiler2</a
      >
    </li>
    <li><a href="../html/103.16.vite.basic.html">103.16.vite.basic</a></li>
    <li><a href="../html/103.16.vite.source.html">103.16.vite.source</a></li>
    <li><a href="../html/103.17.polyfill.html">103.17.polyfill</a></li>
    <li><a href="../html/104.1.binary.html">104.1.binary</a></li>
    <li><a href="../html/104.2.binary.html">104.2.binary</a></li>
    <li><a href="../html/105.skeleton.html">105.skeleton</a></li>
    <li><a href="../html/106.1.react.html">106.1.react</a></li>
    <li><a href="../html/106.2.react_hooks.html">106.2.react_hooks</a></li>
    <li><a href="../html/106.3.react_router.html">106.3.react_router</a></li>
    <li><a href="../html/106.4.redux.html">106.4.redux</a></li>
    <li>
      <a href="../html/106.5.redux_middleware.html">106.5.redux_middleware</a>
    </li>
    <li>
      <a href="../html/106.6.connected-react-router.html"
        >106.6.connected-react-router</a
      >
    </li>
    <li>
      <a href="../html/106.6.redux-first-history.html">106.6.redux-first-history</a>
    </li>
    <li><a href="../html/106.7.redux-saga.html">106.7.redux-saga</a></li>
    <li><a href="../html/106.8.dva.html">106.8.dva</a></li>
    <li><a href="../html/106.9.umi.html">106.9.umi</a></li>
    <li><a href="../html/106.10.ketang.html">106.10.ketang</a></li>
    <li><a href="../html/106.11.antdesign.html">106.11.antdesign</a></li>
    <li><a href="../html/106.12.antpro.html">106.12.antpro</a></li>
    <li><a href="../html/106.13.router-6.html">106.13.router-6</a></li>
    <li><a href="../html/107.fiber.html">107.fiber</a></li>
    <li><a href="../html/108.http.html">108.http</a></li>
    <li><a href="../html/109.1.webpack_usage.html">109.1.webpack_usage</a></li>
    <li>
      <a href="../html/109.2.webpack_source.html">109.2.webpack_source</a>
    </li>
    <li><a href="../html/109.3.dll.html">109.3.dll</a></li>
    <li><a href="../html/110.nest.js.html">110.nest.js</a></li>
    <li><a href="../html/111.xstate.html">111.xstate</a></li>
    <li><a href="../html/112.Form.html">112.Form</a></li>
    <li><a href="../html/113.redux-saga.html">113.redux-saga</a></li>
    <li>
      <a href="../html/114.react+typescript.html">114.react+typescript</a>
    </li>
    <li><a href="../html/115.immer.html">115.immer</a></li>
    <li><a href="../html/116.pro5.html">116.pro5</a></li>
    <li><a href="../html/117.css-loader.html">117.css-loader</a></li>
    <li><a href="../html/118.1.umi-core.html">118.1.umi-core</a></li>
    <li>
      <a href="../html/119.2.module-federation.html">119.2.module-federation</a>
    </li>
    <li>
      <a href="../html/119.1.module-federation.html">119.1.module-federation</a>
    </li>
    <li>
      <a href="../html/120.create-react-app.html">120.create-react-app</a>
    </li>
    <li><a href="../html/121.react-scripts.html">121.react-scripts</a></li>
    <li><a href="../html/122.react-optimize.html">122.react-optimize</a></li>
    <li><a href="../html/123.jsx-runtime.html">123.jsx-runtime</a></li>
    <li><a href="../html/124.next.js.html">124.next.js</a></li>
    <li><a href="../html/125.1.linux.html">125.1.linux</a></li>
    <li><a href="../html/125.2.linux-vi.html">125.2.linux-vi</a></li>
    <li><a href="../html/125.3.linux-user.html">125.3.linux-user</a></li>
    <li><a href="../html/125.4.linux-auth.html">125.4.linux-auth</a></li>
    <li><a href="../html/125.5.linux-shell.html">125.5.linux-shell</a></li>
    <li><a href="../html/125.6.linux-install.html">125.6.linux-install</a></li>
    <li><a href="../html/125.7.linux-system.html">125.7.linux-system</a></li>
    <li><a href="../html/125.8.linux-service.html">125.8.linux-service</a></li>
    <li><a href="../html/125.9.linux-network.html">125.9.linux-network</a></li>
    <li><a href="../html/125.10.nginx.html">125.10.nginx</a></li>
    <li><a href="../html/125.11.docker.html">125.11.docker</a></li>
    <li><a href="../html/125.12.ci.html">125.12.ci</a></li>
    <li><a href="../html/125.13.k8s.html">125.13.k8s</a></li>
    <li><a href="../html/125.14.k8s.html">125.14.k8s</a></li>
    <li><a href="../html/125.15.k8s.html">125.15.k8s</a></li>
    <li><a href="../html/125.16.k8s.html">125.16.k8s</a></li>
    <li><a href="../html/126.11.react-1.html">126.11.react-1</a></li>
    <li><a href="../html/126.12.react-2.html">126.12.react-2</a></li>
    <li><a href="../html/126.12.react-3.html">126.12.react-3</a></li>
    <li><a href="../html/126.12.react-4.html">126.12.react-4</a></li>
    <li><a href="../html/126.12.react-5.html">126.12.react-5</a></li>
    <li><a href="../html/127.frontend.html">127.frontend</a></li>
    <li><a href="../html/128.rollup.html">128.rollup</a></li>
    <li><a href="../html/129.px2rem-loader.html">129.px2rem-loader</a></li>
    <li><a href="../html/130.health.html">130.health</a></li>
    <li><a href="../html/131.hooks.html">131.hooks</a></li>
    <li><a href="../html/132.keepalive.html">132.keepalive</a></li>
    <li><a href="../html/133.vue-cli.html">133.vue-cli</a></li>
    <li><a href="../html/134.react18.html">134.react18</a></li>
    <li><a href="../html/135.function.html">135.function</a></li>
    <li><a href="../html/136.toolkit.html">136.toolkit</a></li>
    <li><a href="../html/137.lerna.html">137.lerna</a></li>
    <li><a href="../html/138.create-vite.html">138.create-vite</a></li>
    <li><a href="../html/139.cli.html">139.cli</a></li>
    <li><a href="../html/140.antd.html">140.antd</a></li>
    <li><a href="../html/141.react-dnd.html">141.react-dnd</a></li>
    <li><a href="../html/142.1.link.html">142.1.link</a></li>
    <li><a href="../html/143.1.gulp.html">143.1.gulp</a></li>
    <li><a href="../html/143.2.stream.html">143.2.stream</a></li>
    <li><a href="../html/143.3.gulp.html">143.3.gulp</a></li>
    <li><a href="../html/144.1.closure.html">144.1.closure</a></li>
    <li><a href="../html/144.2.v8.html">144.2.v8</a></li>
    <li><a href="../html/144.3.gc.html">144.3.gc</a></li>
    <li class="active"><a href="../html/145.react-router-v6.html">145.react-router-v6</a></li>
    <li><a href="../html/145.react-router-v6.html">145.react-router-v6</a></li>
    <li><a href="../html/146.browser.html">146.browser</a></li>
    <li><a href="../html/147.lighthouse.html">147.lighthouse</a></li>
    <li><a href="../html/148.1.basic.html">148.1.basic</a></li>
    <li><a href="../html/148.2.basic .html">148.2.basic </a></li>
    <li><a href="../html/148.3.basic.html">148.3.basic</a></li>
    <li class="active"><a href="../html/148.4.basic.html">148.4.basic</a></li>
    <li><a href="../html/148.5.basic.html">148.5.basic</a></li>
    <li><a href="../html/149.1.vite.html">149.1.vite</a></li>
    <li><a href="../html/149.2.vite.html">149.2.vite</a></li>
    <li><a href="../html/149.3.vite.html">149.3.vite</a></li>
    <li><a href="../html/149.4.vite.html">149.4.vite</a></li>
    <li><a href="../html/150.react-window.html">150.react-window</a></li>
    <li><a href="../html/151.react-query.html">151.react-query</a></li>
    <li><a href="../html/152.useRequest.html">152.useRequest</a></li>
    <li><a href="../html/153.transition.html">153.transition</a></li>
    <li><a href="../html/154.emotion.html">154.emotion</a></li>
    <li><a href="../html/155.1.formily.html">155.1.formily</a></li>
    <li><a href="../html/155.2.formily.html">155.2.formily</a></li>
    <li><a href="../html/155.3.formily.html">155.3.formily</a></li>
    <li><a href="../html/155.3.1.mobx.usage.html">155.3.1.mobx.usage</a></li>
    <li><a href="../html/155.3.2.mobx.source.html">155.3.2.mobx.source</a></li>
    <li><a href="../html/156.vue-loader.html">156.vue-loader</a></li>
    <li><a href="../html/103.11.mf.html">103.11.mf</a></li>
    <li><a href="../html/157.1.react18.html">157.1.react18</a></li>
    <li><a href="../html/158.umi4.html">158.umi4</a></li>
    <li><a href="../html/159.rxjs.html">159.rxjs</a></li>
    <li><a href="../html/159.rxjs2.html">159.rxjs2</a></li>
    <li><a href="../html/160.bff.html">160.bff</a></li>
    <li><a href="../html/161.zustand.html">161.zustand</a></li>
    <li><a href="../html/162.vscode.html">162.vscode</a></li>
    <li><a href="../html/163.emp.html">163.emp</a></li>
  </ul>
</div>

   
                     

                        
<div class="warpper">
    <div class="page-toc">
        <ul><li><a href="#t01.需求分析">1.需求分析</a></li><li><a href="#t12.编译器工作流">2.编译器工作流</a><ul><li><a href="#t22.1 解析(Parsing)">2.1 解析(Parsing)</a></li><li><a href="#t32.2 遍历(Traversal)">2.2 遍历(Traversal)</a></li><li><a href="#t42.3 转换(Transformation)">2.3 转换(Transformation)</a></li><li><a href="#t52.4 代码生成(Code Generation)">2.4 代码生成(Code Generation)</a></li></ul></li><li><a href="#t63. 有限状态机">3. 有限状态机</a><ul><li><a href="#t74 词法分析器">4 词法分析器</a></li><li><a href="#t84.1 tokenTypes.js">4.1 tokenTypes.js</a></li><li><a href="#t94.2 tokenizer.js">4.2 tokenizer.js</a></li></ul></li><li><a href="#t105.语法分析">5.语法分析</a><ul><li><a href="#t115.1 递归下降算法">5.1 递归下降算法</a></li><li><a href="#t125.2 上下文无关文法">5.2 上下文无关文法</a></li><li><a href="#t135.3 算术表达式">5.3 算术表达式</a></li><li><a href="#t145.4 实现">5.4 实现</a><ul><li><a href="#t155.4.1 index.js">5.4.1 index.js</a></li><li><a href="#t165.4.2 parse.js">5.4.2 parse.js</a></li><li><a href="#t175.4.3 tokenTypes.js">5.4.3 tokenTypes.js</a></li><li><a href="#t185.4.4 tokenize.js">5.4.4 tokenize.js</a></li><li><a href="#t195.4.5 nodeTypes.js">5.4.5 nodeTypes.js</a></li><li><a href="#t205.4.6 ASTNode.js">5.4.6 ASTNode.js</a></li><li><a href="#t215.4.7 toAst.js">5.4.7 toAst.js</a></li><li><a href="#t225.4.8 evaluate.js">5.4.8 evaluate.js</a></li></ul></li><li><a href="#t235.5 支持减法和除法">5.5 支持减法和除法</a><ul><li><a href="#t245.5.1 index.js">5.5.1 index.js</a></li><li><a href="#t255.5.2 tokenTypes.js">5.5.2 tokenTypes.js</a></li><li><a href="#t265.5.3 tokenize.js">5.5.3 tokenize.js</a></li><li><a href="#t275.5.4 nodeTypes.js">5.5.4 nodeTypes.js</a></li><li><a href="#t285.5.5 toAST.js">5.5.5 toAST.js</a></li><li><a href="#t295.5.6 evaluate.js">5.5.6 evaluate.js</a></li></ul></li><li><a href="#t305.6 支持括号">5.6 支持括号</a><ul><li><a href="#t315.6.1 index.js">5.6.1 index.js</a></li><li><a href="#t325.6.2 tokenTypes.js">5.6.2 tokenTypes.js</a></li><li><a href="#t335.6.3 tokenize.js">5.6.3 tokenize.js</a></li><li><a href="#t345.6.4 toAST.js">5.6.4 toAST.js</a></li></ul></li><li><a href="#t355.7 二元表达式">5.7 二元表达式</a><ul><li><a href="#t365.7.1  优先级（Priority）">5.7.1  优先级（Priority）</a></li><li><a href="#t375.7.2  结合性（Associativity）">5.7.2  结合性（Associativity）</a></li><li><a href="#t385.7.3 文法规则">5.7.3 文法规则</a></li><li><a href="#t395.7.3 左递归（Left Recursive）">5.7.3 左递归（Left Recursive）</a></li><li><a href="#t405.7.4 消除左递归">5.7.4 消除左递归</a></li><li><a href="#t415.7.5 循环消除左递归">5.7.5 循环消除左递归</a></li><li><a href="#t425.7.6 实现">5.7.6 实现</a></li></ul></li></ul></li><li><a href="#t436. 语法分析器">6. 语法分析器</a><ul><li><a href="#t446.1  nodeTypes.js">6.1  nodeTypes.js</a></li><li><a href="#t456.2  parser.js">6.2  parser.js</a></li></ul></li><li><a href="#t467. 遍历语法树">7. 遍历语法树</a></li><li><a href="#t478. 转换器">8. 转换器</a></li><li><a href="#t489. 生成器">9. 生成器</a></li></ul>
    </div>
    <div class="content markdown-body">
        <h2 id="t01.&#x9700;&#x6C42;&#x5206;&#x6790;">1.&#x9700;&#x6C42;&#x5206;&#x6790; <a href="#t01.&#x9700;&#x6C42;&#x5206;&#x6790;"> # </a></h2>
<ul>
<li>&#x5B9E;&#x73B0;JSX&#x8BED;&#x6CD5;&#x8F6C;&#x6210;JS&#x8BED;&#x6CD5;&#x7684;&#x7F16;&#x8BD1;&#x5668;</li>
<li>&#x9700;&#x6C42;&#xFF1A;&#x5C06;&#x4E00;&#x6BB5;<code>JSX</code>&#x8BED;&#x6CD5;&#x7684;&#x4EE3;&#x7801;&#x751F;&#x6210;&#x4E00;&#x4E2A;<code>AST</code>&#xFF0C;&#x5E76;&#x652F;&#x6301;&#x904D;&#x5386;&#x548C;&#x4FEE;&#x6539;&#x8FD9;&#x4E2A;<code>AST</code>&#xFF0C;&#x5C06;<code>AST</code>&#x91CD;&#x65B0;&#x751F;&#x6210;JS&#x8BED;&#x6CD5;&#x7684;&#x4EE3;&#x7801;</li>
</ul>
<p>JSX&#x4EE3;&#x7801;</p>
<pre><code class="lang-js">&lt;h1 id=&quot;title&quot;&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;
</code></pre>
<p>JS&#x4EE3;&#x7801;</p>
<pre><code class="lang-js">React.createElement(<span class="hljs-string">&quot;h1&quot;</span>, {
  <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;title&quot;</span>
},React.createElement(<span class="hljs-string">&quot;span&quot;</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">&quot;hello&quot;</span>), <span class="hljs-string">&quot;world&quot;</span>);
</code></pre>
<h2 id="t12.&#x7F16;&#x8BD1;&#x5668;&#x5DE5;&#x4F5C;&#x6D41;">2.&#x7F16;&#x8BD1;&#x5668;&#x5DE5;&#x4F5C;&#x6D41; <a href="#t12.&#x7F16;&#x8BD1;&#x5668;&#x5DE5;&#x4F5C;&#x6D41;"> # </a></h2>
<ul>
<li>&#x89E3;&#x6790;(Parsing)  <strong>&#x89E3;&#x6790;</strong>&#x662F;&#x5C06;&#x6700;&#x521D;&#x539F;&#x59CB;&#x7684;&#x4EE3;&#x7801;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x79CD;&#x66F4;&#x52A0;&#x62BD;&#x8C61;&#x7684;&#x8868;&#x793A;(&#x5373;AST)</li>
<li>&#x8F6C;&#x6362;(Transformation) <strong>&#x8F6C;&#x6362;</strong>&#x5C06;&#x5BF9;&#x8FD9;&#x4E2A;&#x62BD;&#x8C61;&#x7684;&#x8868;&#x793A;&#x505A;&#x4E00;&#x4E9B;&#x5904;&#x7406;,&#x8BA9;&#x5B83;&#x80FD;&#x505A;&#x5230;&#x7F16;&#x8BD1;&#x5668;&#x671F;&#x671B;&#x5B83;&#x505A;&#x5230;&#x7684;&#x4E8B;&#x60C5;</li>
<li>&#x4EE3;&#x7801;&#x751F;&#x6210;(Code Generation) &#x63A5;&#x6536;&#x5904;&#x7406;&#x4E4B;&#x540E;&#x7684;&#x4EE3;&#x7801;&#x8868;&#x793A;,&#x7136;&#x540E;&#x628A;&#x5B83;&#x8F6C;&#x6362;&#x6210;&#x65B0;&#x7684;&#x4EE3;&#x7801;</li>
</ul>
<h3 id="t22.1 &#x89E3;&#x6790;(Parsing)">2.1 &#x89E3;&#x6790;(Parsing) <a href="#t22.1 &#x89E3;&#x6790;(Parsing)"> # </a></h3>
<ul>
<li>&#x89E3;&#x6790;&#x4E00;&#x822C;&#x6765;&#x8BF4;&#x4F1A;&#x5206;&#x6210;&#x4E24;&#x4E2A;&#x9636;&#x6BB5;&#xFF1A;&#x8BCD;&#x6CD5;&#x5206;&#x6790;(Lexical Analysis)&#x548C;&#x8BED;&#x6CD5;&#x5206;&#x6790;(Syntactic Analysis)<ul>
<li><code>&#x8BCD;&#x6CD5;&#x5206;&#x6790;</code> &#x63A5;&#x6536;&#x539F;&#x59CB;&#x4EE3;&#x7801;,&#x7136;&#x540E;&#x628A;&#x5B83;&#x5206;&#x5272;&#x6210;&#x4E00;&#x4E9B;&#x88AB;&#x79F0;&#x4E3A; <code>token</code> &#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x662F;&#x5728;&#x8BCD;&#x6CD5;&#x5206;&#x6790;&#x5668;(Tokenizer&#x6216;&#x8005;Lexer)&#x4E2D;&#x5B8C;&#x6210;&#x7684;</li>
<li>Token &#x662F;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#xFF0C;&#x7531;&#x4E00;&#x4E9B;&#x4EE3;&#x7801;&#x8BED;&#x53E5;&#x7684;&#x788E;&#x7247;&#x7EC4;&#x6210;&#x3002;&#x5B83;&#x4EEC;&#x53EF;&#x4EE5;&#x662F;&#x6570;&#x5B57;&#x3001;&#x6807;&#x7B7E;&#x3001;&#x6807;&#x70B9;&#x7B26;&#x53F7;&#x3001;&#x8FD0;&#x7B97;&#x7B26;&#x6216;&#x8005;&#x5176;&#x5B83;&#x4EFB;&#x4F55;&#x4E1C;&#x897F;</li>
<li><code>&#x8BED;&#x6CD5;&#x5206;&#x6790;</code> &#x63A5;&#x6536;&#x4E4B;&#x524D;&#x751F;&#x6210;&#x7684; <code>token</code>&#xFF0C;&#x628A;&#x5B83;&#x4EEC;&#x8F6C;&#x6362;&#x6210;&#x4E00;&#x79CD;&#x62BD;&#x8C61;&#x7684;&#x8868;&#x793A;&#xFF0C;&#x8FD9;&#x79CD;&#x62BD;&#x8C61;&#x7684;&#x8868;&#x793A;&#x63CF;&#x8FF0;&#x4E86;&#x4EE3;&#x7801;&#x8BED;&#x53E5;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x7247;&#x6BB5;&#x4EE5;&#x53CA;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;&#x3002;&#x8FD9;&#x88AB;&#x79F0;&#x4E3A;&#x4E2D;&#x95F4;&#x8868;&#x793A;(intermediate representation)&#x6216;&#x62BD;&#x8C61;&#x8BED;&#x6CD5;&#x6811;(Abstract Syntax Tree, &#x7F29;&#x5199;&#x4E3A;AST)</li>
<li>&#x62BD;&#x8C61;&#x8BED;&#x6CD5;&#x6811;&#x662F;&#x4E00;&#x4E2A;&#x5D4C;&#x5957;&#x7A0B;&#x5EA6;&#x5F88;&#x6DF1;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x7528;&#x4E00;&#x79CD;&#x66F4;&#x5BB9;&#x6613;&#x5904;&#x7406;&#x7684;&#x65B9;&#x5F0F;&#x4EE3;&#x8868;&#x4E86;&#x4EE3;&#x7801;&#x672C;&#x8EAB;&#xFF0C;&#x4E5F;&#x80FD;&#x7ED9;&#x6211;&#x4EEC;&#x66F4;&#x591A;&#x4FE1;&#x606F;</li>
</ul>
</li>
</ul>
<p>&#x539F;&#x59CB;<code>jsx</code>&#x4EE3;&#x7801;</p>
<pre><code class="lang-js">&lt;h1 id=&quot;title&quot;&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;
</code></pre>
<p>tokens</p>
<pre><code class="lang-js">[
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&lt;&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;h1&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;id&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;=&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;String&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&quot;title&quot;&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&gt;&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&lt;&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;span&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&gt;&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXText&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;hello&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&lt;&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;/&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;span&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&gt;&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXText&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;world&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&lt;&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;/&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;h1&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Punctuator&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&gt;&apos;</span> }
  ]
</code></pre>
<p>&#x62BD;&#x8C61;&#x8BED;&#x6CD5;&#x6811;(AST)</p>
<p><a href="https://astexplorer.net/">astexplorer</a></p>
<pre><code class="lang-js">{
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;Program&quot;</span>,
    <span class="hljs-string">&quot;body&quot;</span>: [
        {
            <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;ExpressionStatement&quot;</span>,
            <span class="hljs-string">&quot;expression&quot;</span>: {
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXElement&quot;</span>,
                <span class="hljs-string">&quot;openingElement&quot;</span>: {
                    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXOpeningElement&quot;</span>,
                    <span class="hljs-string">&quot;name&quot;</span>: {
                        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
                        <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;h1&quot;</span>
                    },
                    <span class="hljs-string">&quot;attributes&quot;</span>: [
                        {
                            <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXAttribute&quot;</span>,
                            <span class="hljs-string">&quot;name&quot;</span>: {
                                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
                                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;id&quot;</span>
                            },
                            <span class="hljs-string">&quot;value&quot;</span>: {
                                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;Literal&quot;</span>,
                                <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;title&quot;</span>
                            }
                        }
                    ]
                },
                <span class="hljs-string">&quot;children&quot;</span>: [
                    {
                        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXElement&quot;</span>,
                        <span class="hljs-string">&quot;openingElement&quot;</span>: {
                            <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXOpeningElement&quot;</span>,
                            <span class="hljs-string">&quot;name&quot;</span>: {
                                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
                                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;span&quot;</span>
                            }
                            <span class="hljs-string">&quot;attributes&quot;</span>: []
                        },
                        <span class="hljs-string">&quot;children&quot;</span>: [
                            {
                                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXText&quot;</span>,
                                <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;hello&quot;</span>
                            }
                        ],
                        <span class="hljs-string">&quot;closingElement&quot;</span>: {
                            <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXClosingElement&quot;</span>,
                            <span class="hljs-string">&quot;name&quot;</span>: {
                                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
                                <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;span&quot;</span>
                            }
                        }
                    },
                    {
                        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXText&quot;</span>,
                        <span class="hljs-string">&quot;value&quot;</span>: <span class="hljs-string">&quot;world&quot;</span>
                    }
                ],
                <span class="hljs-string">&quot;closingElement&quot;</span>: {
                    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXClosingElement&quot;</span>,
                    <span class="hljs-string">&quot;name&quot;</span>: {
                        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
                        <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;h1&quot;</span>
                    }
                }
            }
        }
    ]
}
</code></pre>
<h3 id="t32.2 &#x904D;&#x5386;(Traversal)">2.2 &#x904D;&#x5386;(Traversal) <a href="#t32.2 &#x904D;&#x5386;(Traversal)"> # </a></h3>
<ul>
<li>&#x4E3A;&#x4E86;&#x80FD;&#x5904;&#x7406;&#x6240;&#x6709;&#x7684;&#x7ED3;&#x70B9;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x904D;&#x5386;&#x5B83;&#x4EEC;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x6DF1;&#x5EA6;&#x4F18;&#x5148;&#x904D;&#x5386;</li>
<li>&#x5BF9;&#x4E8E;&#x4E0A;&#x9762;&#x7684; <code>AST</code> &#x7684;&#x904D;&#x5386;&#x6D41;&#x7A0B;&#x662F;&#x8FD9;&#x6837;&#x7684;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> esprima = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;esprima&apos;</span>);<span class="hljs-comment">//&#x628A;JS&#x6E90;&#x4EE3;&#x7801;&#x8F6C;&#x6210;AST&#x8BED;&#x6CD5;&#x6811;</span>
<span class="hljs-keyword">let</span> code = <span class="hljs-string">`&lt;h1 id=&quot;title&quot;&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;`</span>;
<span class="hljs-keyword">let</span> estraverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;estraverse-fb&apos;</span>);<span class="hljs-comment">///&#x904D;&#x5386;&#x8BED;&#x6CD5;&#x6811;,&#x4FEE;&#x6539;&#x6811;&#x4E0A;&#x7684;&#x8282;&#x70B9;</span>
<span class="hljs-keyword">let</span> ast = esprima.parseScript(code, {  <span class="hljs-attr">tokens</span>: <span class="hljs-literal">true</span>,<span class="hljs-attr">jsx</span>: <span class="hljs-literal">true</span> });
<span class="hljs-keyword">let</span> indent = <span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">padding</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot; &quot;</span>.repeat(indent);
}
estraverse.traverse(ast,{
    enter(node){
        <span class="hljs-built_in">console</span>.log(padding()+node.type+<span class="hljs-string">&apos;&#x8FDB;&#x5165;&apos;</span>);
        indent+=<span class="hljs-number">2</span>;
    },
    leave(node){
        indent-=<span class="hljs-number">2</span>;
        <span class="hljs-built_in">console</span>.log(padding()+node.type+<span class="hljs-string">&apos;&#x79BB;&#x5F00;&apos;</span>);
    }
});
</code></pre>
<pre><code class="lang-js">Program&#x8FDB;&#x5165;
  ExpressionStatement&#x8FDB;&#x5165;
    JSXElement&#x8FDB;&#x5165;
      JSXOpeningElement&#x8FDB;&#x5165;
        JSXIdentifier&#x8FDB;&#x5165;
        JSXIdentifier&#x79BB;&#x5F00;
        JSXAttribute&#x8FDB;&#x5165;
          JSXIdentifier&#x8FDB;&#x5165;
          JSXIdentifier&#x79BB;&#x5F00;
          Literal&#x8FDB;&#x5165;
          Literal&#x79BB;&#x5F00;
        JSXAttribute&#x79BB;&#x5F00;
      JSXOpeningElement&#x79BB;&#x5F00;
      JSXClosingElement&#x8FDB;&#x5165;
        JSXIdentifier&#x8FDB;&#x5165;
        JSXIdentifier&#x79BB;&#x5F00;
      JSXClosingElement&#x79BB;&#x5F00;
      JSXElement&#x8FDB;&#x5165;
        JSXOpeningElement&#x8FDB;&#x5165;
          JSXIdentifier&#x8FDB;&#x5165;
          JSXIdentifier&#x79BB;&#x5F00;
        JSXOpeningElement&#x79BB;&#x5F00;
        JSXClosingElement&#x8FDB;&#x5165;
          JSXIdentifier&#x8FDB;&#x5165;
          JSXIdentifier&#x79BB;&#x5F00;
        JSXClosingElement&#x79BB;&#x5F00;
        JSXText&#x8FDB;&#x5165;
        JSXText&#x79BB;&#x5F00;
      JSXElement&#x79BB;&#x5F00;
      JSXText&#x8FDB;&#x5165;
      JSXText&#x79BB;&#x5F00;
    JSXElement&#x79BB;&#x5F00;
  ExpressionStatement&#x79BB;&#x5F00;
Program&#x79BB;&#x5F00;
</code></pre>
<h3 id="t42.3 &#x8F6C;&#x6362;(Transformation)">2.3 &#x8F6C;&#x6362;(Transformation) <a href="#t42.3 &#x8F6C;&#x6362;(Transformation)"> # </a></h3>
<ul>
<li>&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x4E0B;&#x4E00;&#x6B65;&#x5C31;&#x662F;&#x8F6C;&#x6362;,&#x5B83;&#x53EA;&#x662F;&#x628A; AST &#x62FF;&#x8FC7;&#x6765;&#x7136;&#x540E;&#x5BF9;&#x5B83;&#x505A;&#x4E00;&#x4E9B;&#x4FEE;&#x6539;.&#x5B83;&#x53EF;&#x4EE5;&#x5728;&#x540C;&#x79CD;&#x8BED;&#x8A00;&#x4E0B;&#x64CD;&#x4F5C; AST&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x628A; AST &#x7FFB;&#x8BD1;&#x6210;&#x5168;&#x65B0;&#x7684;&#x8BED;&#x8A00;</li>
<li>&#x4F60;&#x6216;&#x8BB8;&#x6CE8;&#x610F;&#x5230;&#x4E86;&#x6211;&#x4EEC;&#x7684; <code>AST</code> &#x4E2D;&#x6709;&#x5F88;&#x591A;&#x76F8;&#x4F3C;&#x7684;&#x5143;&#x7D20;&#xFF0C;&#x8FD9;&#x4E9B;&#x5143;&#x7D20;&#x90FD;&#x6709;<code>type</code> &#x5C5E;&#x6027;&#xFF0C;&#x5B83;&#x4EEC;&#x88AB;&#x79F0;&#x4E3A; <code>AST</code>&#x7ED3;&#x70B9;&#x3002;&#x8FD9;&#x4E9B;&#x7ED3;&#x70B9;&#x542B;&#x6709;&#x82E5;&#x5E72;&#x5C5E;&#x6027;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x63CF;&#x8FF0; AST &#x7684;&#x90E8;&#x5206;&#x4FE1;&#x606F;</li>
<li>&#x5F53;&#x8F6C;&#x6362; AST &#x7684;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;&#x3001;&#x79FB;&#x52A8;&#x3001;&#x66FF;&#x4EE3;&#x8FD9;&#x4E9B;&#x7ED3;&#x70B9;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x73B0;&#x6709;&#x7684; AST &#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5168;&#x65B0;&#x7684; AST</li>
<li>&#x65E2;&#x7136;&#x6211;&#x4EEC;&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x76EE;&#x6807;&#x662F;&#x628A;&#x8F93;&#x5165;&#x7684;&#x4EE3;&#x7801;&#x8F6C;&#x6362;&#x4E3A;&#x4E00;&#x79CD;&#x65B0;&#x7684;&#x8BED;&#x8A00;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x5C06;&#x4F1A;&#x7740;&#x91CD;&#x4E8E;&#x4EA7;&#x751F;&#x4E00;&#x4E2A;&#x9488;&#x5BF9;&#x65B0;&#x8BED;&#x8A00;&#x7684;&#x5168;&#x65B0;&#x7684; AST</li>
</ul>
<h3 id="t52.4 &#x4EE3;&#x7801;&#x751F;&#x6210;(Code Generation)">2.4 &#x4EE3;&#x7801;&#x751F;&#x6210;(Code Generation) <a href="#t52.4 &#x4EE3;&#x7801;&#x751F;&#x6210;(Code Generation)"> # </a></h3>
<ul>
<li>&#x7F16;&#x8BD1;&#x5668;&#x7684;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x9636;&#x6BB5;&#x662F;&#x4EE3;&#x7801;&#x751F;&#x6210;&#xFF0C;&#x8FD9;&#x4E2A;&#x9636;&#x6BB5;&#x505A;&#x7684;&#x4E8B;&#x60C5;&#x6709;&#x65F6;&#x5019;&#x4F1A;&#x548C;&#x8F6C;&#x6362;(transformation)&#x91CD;&#x53E0;,&#x4F46;&#x662F;&#x4EE3;&#x7801;&#x751F;&#x6210;&#x6700;&#x4E3B;&#x8981;&#x7684;&#x90E8;&#x5206;&#x8FD8;&#x662F;&#x6839;&#x636E; AST &#x6765;&#x8F93;&#x51FA;&#x4EE3;&#x7801;</li>
<li>&#x4EE3;&#x7801;&#x751F;&#x6210;&#x6709;&#x51E0;&#x79CD;&#x4E0D;&#x540C;&#x7684;&#x5DE5;&#x4F5C;&#x65B9;&#x5F0F;&#xFF0C;&#x6709;&#x4E9B;&#x7F16;&#x8BD1;&#x5668;&#x5C06;&#x4F1A;&#x91CD;&#x7528;&#x4E4B;&#x524D;&#x751F;&#x6210;&#x7684; token&#xFF0C;&#x6709;&#x4E9B;&#x4F1A;&#x521B;&#x5EFA;&#x72EC;&#x7ACB;&#x7684;&#x4EE3;&#x7801;&#x8868;&#x793A;&#xFF0C;&#x4EE5;&#x4FBF;&#x4E8E;&#x7EBF;&#x6027;&#x5730;&#x8F93;&#x51FA;&#x4EE3;&#x7801;&#x3002;&#x4F46;&#x662F;&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x8FD8;&#x662F;&#x7740;&#x91CD;&#x4E8E;&#x4F7F;&#x7528;&#x4E4B;&#x524D;&#x751F;&#x6210;&#x597D;&#x7684; <code>AST</code></li>
<li>&#x6211;&#x4EEC;&#x7684;&#x4EE3;&#x7801;&#x751F;&#x6210;&#x5668;&#x9700;&#x8981;&#x77E5;&#x9053;&#x5982;&#x4F55;<code>&#x6253;&#x5370;</code>AST &#x4E2D;&#x6240;&#x6709;&#x7C7B;&#x578B;&#x7684;&#x7ED3;&#x70B9;&#xFF0C;&#x7136;&#x540E;&#x5B83;&#x4F1A;&#x9012;&#x5F52;&#x5730;&#x8C03;&#x7528;&#x81EA;&#x8EAB;&#xFF0C;&#x76F4;&#x5230;&#x6240;&#x6709;&#x4EE3;&#x7801;&#x90FD;&#x88AB;&#x6253;&#x5370;&#x5230;&#x4E00;&#x4E2A;&#x5F88;&#x957F;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#x4E2D;</li>
</ul>
<h2 id="t63. &#x6709;&#x9650;&#x72B6;&#x6001;&#x673A;">3. &#x6709;&#x9650;&#x72B6;&#x6001;&#x673A; <a href="#t63. &#x6709;&#x9650;&#x72B6;&#x6001;&#x673A;"> # </a></h2>
<ul>
<li>&#x6BCF;&#x4E00;&#x4E2A;&#x72B6;&#x6001;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x673A;&#x5668;,&#x6BCF;&#x4E2A;&#x673A;&#x5668;&#x90FD;&#x53EF;&#x4EE5;&#x63A5;&#x6536;&#x8F93;&#x5165;&#x548C;&#x8BA1;&#x7B97;&#x8F93;&#x51FA;</li>
<li>&#x673A;&#x5668;&#x672C;&#x8EAB;&#x6CA1;&#x6709;&#x72B6;&#x6001;,&#x6BCF;&#x4E00;&#x4E2A;&#x673A;&#x5668;&#x4F1A;&#x6839;&#x636E;&#x8F93;&#x5165;&#x51B3;&#x5B9A;&#x4E0B;&#x4E00;&#x4E2A;&#x72B6;&#x6001;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> WHITESPACE = <span class="hljs-regexp">/\s/</span>;
<span class="hljs-keyword">let</span> NUMBERS = <span class="hljs-regexp">/[0-9]/</span>;

<span class="hljs-keyword">const</span> <span class="hljs-built_in">Number</span> = <span class="hljs-string">&apos;Number&apos;</span>;
<span class="hljs-keyword">const</span> Plus = <span class="hljs-string">&apos;Plus&apos;</span>;

<span class="hljs-keyword">let</span> currentToken;
<span class="hljs-keyword">let</span> tokens = [];
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">emit</span>(<span class="hljs-params">token</span>)</span>{
    currentToken = { <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&quot;&quot;</span> };
    tokens.push(token);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params">char</span>)</span>{
    <span class="hljs-keyword">if</span>(NUMBERS.test(char)){
        currentToken = {
            <span class="hljs-attr">type</span>:<span class="hljs-built_in">Number</span>,
            <span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&apos;</span>
        }
        <span class="hljs-keyword">return</span> number(char);
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&apos;&#x51FD;&#x6570;&#x540D;&#x5FC5;&#x987B;&#x662F;&#x5B57;&#x7B26; &apos;</span>+ char); 
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">number</span>(<span class="hljs-params">char</span>)</span>{
    <span class="hljs-keyword">if</span>(NUMBERS.test(char)){
        currentToken.value += char;
        <span class="hljs-keyword">return</span> number;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(char == <span class="hljs-string">&quot;+&quot;</span>){
        emit(currentToken);
        emit({ <span class="hljs-attr">type</span>: Plus,  <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;+&apos;</span>});
        currentToken = {
            <span class="hljs-attr">type</span>:<span class="hljs-built_in">Number</span>,
            <span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&apos;</span>
        }
        <span class="hljs-keyword">return</span> number;
    }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tokenizer</span>(<span class="hljs-params">input</span>)</span>{
    <span class="hljs-keyword">let</span> state = start;
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> char <span class="hljs-keyword">of</span> input){
        state = state(char);
    }
    emit(currentToken);
}

tokenizer(<span class="hljs-string">&apos;10+20&apos;</span>)
<span class="hljs-built_in">console</span>.log(tokens);
</code></pre>
<pre><code class="lang-js">[
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Number&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;10&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Plus&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;+&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;Number&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;20&apos;</span> }
]
</code></pre>
<h3 id="t74 &#x8BCD;&#x6CD5;&#x5206;&#x6790;&#x5668;">4 &#x8BCD;&#x6CD5;&#x5206;&#x6790;&#x5668; <a href="#t74 &#x8BCD;&#x6CD5;&#x5206;&#x6790;&#x5668;"> # </a></h3>
<ul>
<li>&#x6211;&#x4EEC;&#x53EA;&#x662F;&#x63A5;&#x6536;&#x4EE3;&#x7801;&#x7EC4;&#x6210;&#x7684;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x7136;&#x540E;&#x628A;&#x5B83;&#x4EEC;&#x5206;&#x5272;&#x6210; <code>token</code> &#x7EC4;&#x6210;&#x7684;&#x6570;&#x7EC4;</li>
</ul>
<h3 id="t84.1 tokenTypes.js">4.1 tokenTypes.js <a href="#t84.1 tokenTypes.js"> # </a></h3>
<p>src\tokenTypes.js</p>
<pre><code class="lang-js">exports.LeftParentheses = <span class="hljs-string">&apos;LeftParentheses&apos;</span>;<span class="hljs-comment">// &lt; </span>
exports.RightParentheses = <span class="hljs-string">&apos;RightParentheses&apos;</span>;<span class="hljs-comment">// &lt; </span>
exports.JSXIdentifier = <span class="hljs-string">&apos;JSXIdentifier&apos;</span>;<span class="hljs-comment">//&#x6807;&#x8BC6;&#x7B26;</span>
exports.AttributeKey = <span class="hljs-string">&apos;AttributeKey&apos;</span>;<span class="hljs-comment">//&#x5C5E;&#x6027;&#x7684;key</span>
exports.AttributeStringValue = <span class="hljs-string">&apos;AttributeStringValue&apos;</span>;<span class="hljs-comment">//&#x5B57;&#x7B26;&#x4E32;&#x683C;&#x5F0F;&#x7684;&#x5C5E;&#x6027;&#x503C;</span>
exports.JSXText = <span class="hljs-string">&apos;JSXText&apos;</span>;<span class="hljs-comment">//&#x6587;&#x672C;</span>
exports.BackSlash = <span class="hljs-string">&apos;BackSlash&apos;</span>;<span class="hljs-comment">//&#x53CD;&#x659C;&#x6760;</span>
</code></pre>
<h3 id="t94.2 tokenizer.js">4.2 tokenizer.js <a href="#t94.2 tokenizer.js"> # </a></h3>
<p>src\tokenizer.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> LETTERS = <span class="hljs-regexp">/[a-z0-9]/</span>;
<span class="hljs-keyword">const</span> tokenTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./tokenTypes&apos;</span>);
<span class="hljs-keyword">let</span> currentToken = {<span class="hljs-attr">type</span>:<span class="hljs-string">&apos;&apos;</span>,<span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&apos;</span>};
<span class="hljs-keyword">let</span> tokens = [];
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">emit</span>(<span class="hljs-params">token</span>)</span>{<span class="hljs-comment">//&#x4E00;&#x65E6;&#x53D1;&#x5C04;&#x4E86;&#x4E00;&#x4E2A;token&#x4E4B;&#x540E;,&#x5C31;&#x53EF;&#x4EE5;&#x6E05;&#x7A7A;currentToken,&#x7136;&#x540E;&#x653E;&#x5165;&#x6570;&#x7EC4;</span>
    currentToken = {<span class="hljs-attr">type</span>:<span class="hljs-string">&apos;&apos;</span>,<span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&apos;</span>};
    tokens.push(token);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params">char</span>)</span>{
    <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos;&lt;&apos;</span>){
        emit({<span class="hljs-attr">type</span>:tokenTypes.LeftParentheses,<span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&lt;&apos;</span>});
        <span class="hljs-keyword">return</span> foundLeftParentheses;<span class="hljs-comment">//&#x627E;&#x5230;&#x4E86;&lt;</span>
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x5FC5;&#x987B;&#x662F;&lt;&apos;</span>);
}
<span class="hljs-comment">/* function eof(){
    if(currentToken.value.length&gt;0)
        emit(currentToken);
} */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foundLeftParentheses</span>(<span class="hljs-params">char</span>)</span>{<span class="hljs-comment">//char=h1</span>
    <span class="hljs-keyword">if</span>(LETTERS.test(char)){<span class="hljs-comment">//&#x5982;&#x679C;char&#x662F;&#x4E00;&#x4E2A;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x7684;&#x8BDD;</span>
        currentToken.type = tokenTypes.JSXIdentifier;
        currentToken.value += char;<span class="hljs-comment">//h</span>
        <span class="hljs-keyword">return</span> jsxIdentifier;<span class="hljs-comment">//&#x7EE7;&#x7EED;&#x6536;&#x96C6;&#x6807;&#x8BC6;&#x7B26;</span>
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos;/&apos;</span>){
        emit({<span class="hljs-attr">type</span>:tokenTypes.BackSlash,<span class="hljs-attr">value</span>:<span class="hljs-string">&apos;/&apos;</span>});
        <span class="hljs-keyword">return</span> foundLeftParentheses;
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x5FC5;&#x987B;&#x662F;&lt;&apos;</span>);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsxIdentifier</span>(<span class="hljs-params">char</span>)</span>{
    <span class="hljs-keyword">if</span>(LETTERS.test(char)){<span class="hljs-comment">//&#x5982;&#x679C;&#x662F;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#x6216;&#x8005;&#x662F;&#x6570;&#x5B57;&#x7684;&#x8BDD;</span>
        currentToken.value+=char;
        <span class="hljs-keyword">return</span> jsxIdentifier;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos; &apos;</span>){<span class="hljs-comment">//&#x5982;&#x679C;&#x6536;&#x96C6;&#x6807;&#x8BC6;&#x7B26;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x9047;&#x5230;&#x4E86;&#x7A7A;&#x683C;&#x4E86;,&#x8BF4;&#x660E;&#x6807;&#x8BC6;&#x7B26;&#x7ED3;&#x675F; </span>
        emit(currentToken);
        <span class="hljs-keyword">return</span> attribute;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(char == <span class="hljs-string">&apos;&gt;&apos;</span>){<span class="hljs-comment">//&#x8BF4;&#x660E;&#x6B64;&#x6807;&#x7B7E;&#x6CA1;&#x6709;&#x5C5E;&#x6027;,&#x76F4;&#x63A5;&#x7ED3;&#x675F;&#x4E86;</span>
        emit(currentToken);
        emit({<span class="hljs-attr">type</span>:tokenTypes.RightParentheses,<span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&gt;&apos;</span>});
        <span class="hljs-keyword">return</span> foundRightParentheses;
    }   
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;&#x7B2C;&#x4E00;&#x4E2A;&#x5B57;&#x7B26;&#x5FC5;&#x987B;&#x662F;&lt;&apos;</span>);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attribute</span>(<span class="hljs-params">char</span>)</span>{<span class="hljs-comment">//char=i</span>
    <span class="hljs-keyword">if</span>(LETTERS.test(char)){
        currentToken.type = tokenTypes.AttributeKey;<span class="hljs-comment">//&#x5C5E;&#x6027;&#x7684;key</span>
        currentToken.value += char;<span class="hljs-comment">//&#x5C5E;&#x6027;key&#x7684;&#x540D;&#x5B57;</span>
        <span class="hljs-keyword">return</span> attributeKey;
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&apos;Error&apos;</span>);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attributeKey</span>(<span class="hljs-params">char</span>)</span>{
    <span class="hljs-keyword">if</span>(LETTERS.test(char)){<span class="hljs-comment">//d</span>
        currentToken.value += char;
        <span class="hljs-keyword">return</span> attributeKey;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos;=&apos;</span>){<span class="hljs-comment">//&#x8BF4;&#x660E;&#x5C5E;&#x6027;&#x7684;key&#x7684;&#x540D;&#x5B57;&#x5DF2;&#x7ECF;&#x7ED3;&#x675F;&#x4E86;</span>
        emit(currentToken);<span class="hljs-comment">// { type: &apos;JSXIdentifier&apos;, value: &apos;h1&apos; },</span>
        <span class="hljs-keyword">return</span> attributeValue;
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&apos;Error&apos;</span>);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attributeValue</span>(<span class="hljs-params">char</span>)</span>{<span class="hljs-comment">//char=&quot;</span>
    <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos;&quot;&apos;</span>){
        currentToken.type = tokenTypes.AttributeStringValue;
        currentToken.value = <span class="hljs-string">&apos;&apos;</span>;
        <span class="hljs-keyword">return</span> attributeStringValue;<span class="hljs-comment">//&#x5F00;&#x59CB;&#x8BFB;&#x5B57;&#x7B26;&#x4E32;&#x5C5E;&#x6027;&#x503C;</span>
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&apos;Error&apos;</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attributeStringValue</span>(<span class="hljs-params">char</span>)</span>{<span class="hljs-comment">//title</span>
    <span class="hljs-keyword">if</span>(LETTERS.test(char)){
        currentToken.value+=char;
        <span class="hljs-keyword">return</span> attributeStringValue;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos;&quot;&apos;</span>){<span class="hljs-comment">//&#x8BF4;&#x660E;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x503C;&#x7ED3;&#x675F;&#x4E86;</span>
        emit(currentToken);<span class="hljs-comment">//{ type: &apos;AttributeStringValue&apos;, value: &apos;&quot;title&quot;&apos; },</span>
        <span class="hljs-keyword">return</span> tryLeaveAttribute;
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&apos;Error&apos;</span>);
}
<span class="hljs-comment">//&#x56E0;&#x4E3A;&#x540E;&#x9762;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x5C5E;&#x6027;,&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x5F00;&#x59CB;&#x6807;&#x7B7E;&#x7684;&#x7ED3;&#x675F;</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tryLeaveAttribute</span>(<span class="hljs-params">char</span>)</span>{
    <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos; &apos;</span>){
        <span class="hljs-keyword">return</span> attribute;<span class="hljs-comment">//&#x5982;&#x679C;&#x540E;&#x9762;&#x662F;&#x7A7A;&#x683C;&#x7684;&#x8BDD;,&#x8BF4;&#x660E;&#x540E;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5C5E;&#x6027;</span>
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos;&gt;&apos;</span>){<span class="hljs-comment">//&#x8BF4;&#x660E;&#x5F00;&#x59CB;&#x6807;&#x7B7E;&#x7ED3;&#x675F;&#x4E86;</span>
        emit({<span class="hljs-attr">type</span>:tokenTypes.RightParentheses,<span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&gt;&apos;</span>});
        <span class="hljs-keyword">return</span> foundRightParentheses;
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&apos;Error&apos;</span>);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">foundRightParentheses</span>(<span class="hljs-params">char</span>)</span>{
    <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos;&lt;&apos;</span>){
        emit({<span class="hljs-attr">type</span>:tokenTypes.LeftParentheses,<span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&lt;&apos;</span>});
        <span class="hljs-keyword">return</span> foundLeftParentheses;<span class="hljs-comment">//&#x627E;&#x5230;&#x4E86;&lt;</span>
    }<span class="hljs-keyword">else</span>{
        currentToken.type = tokenTypes.JSXText;
        currentToken.value += char;
        <span class="hljs-keyword">return</span> jsxText;
    }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">jsxText</span>(<span class="hljs-params">char</span>)</span>{
  <span class="hljs-keyword">if</span>(char === <span class="hljs-string">&apos;&lt;&apos;</span>){
    emit(currentToken);<span class="hljs-comment">//{ type: &apos;JSXText&apos;, value: &apos;hello&apos; },</span>
    emit({<span class="hljs-attr">type</span>:tokenTypes.LeftParentheses,<span class="hljs-attr">value</span>:<span class="hljs-string">&apos;&lt;&apos;</span>});
    <span class="hljs-keyword">return</span> foundLeftParentheses;
  }<span class="hljs-keyword">else</span>{
    currentToken.value += char;
    <span class="hljs-keyword">return</span> jsxText;
  }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tokenizer</span>(<span class="hljs-params">input</span>)</span>{
    <span class="hljs-keyword">let</span> state = start;<span class="hljs-comment">//&#x521A;&#x5F00;&#x59CB;&#x5904;&#x4E8E;&#x5F00;&#x59CB;&#x72B6;&#x6001;</span>
    <span class="hljs-keyword">debugger</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> char <span class="hljs-keyword">of</span> input){<span class="hljs-comment">//&#x904D;&#x5386;&#x6216;&#x8005;&#x8BF4;&#x5FAA;&#x73AF;&#x6240;&#x6709;&#x7684;&#x5B57;&#x7B26;</span>
        <span class="hljs-keyword">if</span>(state) state = state(char);
    }
    <span class="hljs-keyword">return</span> tokens;
}

<span class="hljs-comment">/* let sourceCode = &apos;&lt;h1 id=&quot;title&quot; name={name}&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;&apos;;
console.log(tokenizer(sourceCode));
 */</span>
<span class="hljs-built_in">module</span>.exports = {
    tokenizer
}
<span class="hljs-comment">/**
[    &lt;h1 id=&quot;title&quot;&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;
    { type: &apos;LeftParentheses&apos;, value: &apos;&lt;&apos; },
    { type: &apos;JSXIdentifier&apos;, value: &apos;h1&apos; },
    { type: &apos;AttributeKey&apos;, value: &apos;id&apos; },
    { type: &apos;AttributeStringValue&apos;, value: &apos;&quot;title&quot;&apos; },
    { type: &apos;RightParentheses&apos;, value: &apos;&gt;&apos; },
    { type: &apos;LeftParentheses&apos;, value: &apos;&lt;&apos; },
    { type: &apos;JSXIdentifier&apos;, value: &apos;span&apos; },
    { type: &apos;RightParentheses&apos;, value: &apos;&gt;&apos; },
    { type: &apos;JSXText&apos;, value: &apos;hello&apos; },
    { type: &apos;LeftParentheses&apos;, value: &apos;&lt;&apos; },
    { type: &apos;BackSlash&apos;, value: &apos;/&apos; },
    { type: &apos;JSXIdentifier&apos;, value: &apos;span&apos; },
    { type: &apos;RightParentheses&apos;, value: &apos;&gt;&apos; },
    { type: &apos;JSXText&apos;, value: &apos;world&apos; },
    { type: &apos;LeftParentheses&apos;, value: &apos;&lt;&apos; },
    { type: &apos;BackSlash&apos;, value: &apos;/&apos; },
    { type: &apos;JSXIdentifier&apos;, value: &apos;h1&apos; },
    { type: &apos;RightParentheses&apos;, value: &apos;&gt;&apos; }
  ]
 */</span>
</code></pre>
<p>&#x5206;&#x8BCD;&#x7ED3;&#x679C;</p>
<pre><code class="lang-js">[
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;LeftParentheses&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&lt;&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;h1&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;AttributeKey&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;id&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;AttributeStringValue&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;title&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;RightParentheses&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&gt;&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;LeftParentheses&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&lt;&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;span&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;RightParentheses&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&gt;&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXText&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;hello&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;LeftParentheses&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&lt;&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;BackSlash&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;/&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;span&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;RightParentheses&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&gt;&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXText&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;world&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;LeftParentheses&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&lt;&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;BackSlash&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;/&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;JSXIdentifier&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;h1&apos;</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;RightParentheses&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;&gt;&apos;</span> }
]
</code></pre>
<h2 id="t105.&#x8BED;&#x6CD5;&#x5206;&#x6790;">5.&#x8BED;&#x6CD5;&#x5206;&#x6790; <a href="#t105.&#x8BED;&#x6CD5;&#x5206;&#x6790;"> # </a></h2>
<ul>
<li>&#x8BED;&#x6CD5;&#x5206;&#x6790;&#x7684;&#x539F;&#x7406;&#x548C;&#x9012;&#x5F52;&#x4E0B;&#x964D;&#x7B97;&#x6CD5;&#xFF08;Recursive Descent Parsing&#xFF09;</li>
<li>&#x5E76;&#x521D;&#x6B65;&#x4E86;&#x89E3;&#x4E0A;&#x4E0B;&#x6587;&#x65E0;&#x5173;&#x6587;&#x6CD5;&#xFF08;Context-free Grammar&#xFF0C;CFG&#xFF09;</li>
</ul>
<h3 id="t115.1 &#x9012;&#x5F52;&#x4E0B;&#x964D;&#x7B97;&#x6CD5;">5.1 &#x9012;&#x5F52;&#x4E0B;&#x964D;&#x7B97;&#x6CD5; <a href="#t115.1 &#x9012;&#x5F52;&#x4E0B;&#x964D;&#x7B97;&#x6CD5;"> # </a></h3>
<ul>
<li>&#x5B83;&#x7684;&#x5DE6;&#x8FB9;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x7EC8;&#x7ED3;&#x7B26;&#xFF08;Non-terminal&#xFF09;</li>
<li>&#x53F3;&#x8FB9;&#x662F;&#x5B83;&#x7684;&#x4EA7;&#x751F;&#x5F0F;&#xFF08;Production Rule&#xFF09;</li>
<li>&#x5728;&#x8BED;&#x6CD5;&#x89E3;&#x6790;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x5DE6;&#x8FB9;&#x4F1A;&#x88AB;&#x53F3;&#x8FB9;&#x66FF;&#x4EE3;&#x3002;&#x5982;&#x679C;&#x66FF;&#x4EE3;&#x4E4B;&#x540E;&#x8FD8;&#x6709;&#x975E;&#x7EC8;&#x7ED3;&#x7B26;&#xFF0C;&#x90A3;&#x4E48;&#x7EE7;&#x7EED;&#x8FD9;&#x4E2A;&#x66FF;&#x4EE3;&#x8FC7;&#x7A0B;&#xFF0C;&#x76F4;&#x5230;&#x6700;&#x540E;&#x5168;&#x90E8;&#x90FD;&#x662F;&#x7EC8;&#x7ED3;&#x7B26;&#xFF08;Terminal&#xFF09;&#xFF0C;&#x4E5F;&#x5C31;&#x662F; <code>Token</code></li>
<li>&#x53EA;&#x6709;&#x7EC8;&#x7ED3;&#x7B26;&#x624D;&#x53EF;&#x4EE5;&#x6210;&#x4E3A; <code>AST</code> &#x7684;&#x53F6;&#x5B50;&#x8282;&#x70B9;&#x3002;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#xFF0C;&#x4E5F;&#x53EB;&#x505A;&#x63A8;&#x5BFC;&#xFF08;Derivation&#xFF09;&#x8FC7;&#x7A0B;</li>
<li>&#x4E0A;&#x7EA7;&#x6587;&#x6CD5;&#x5D4C;&#x5957;&#x4E0B;&#x7EA7;&#x6587;&#x6CD5;&#xFF0C;&#x4E0A;&#x7EA7;&#x7684;&#x7B97;&#x6CD5;&#x8C03;&#x7528;&#x4E0B;&#x7EA7;&#x7684;&#x7B97;&#x6CD5;&#x3002;&#x8868;&#x73B0;&#x5728;&#x751F;&#x6210; AST &#x4E2D;&#xFF0C;&#x4E0A;&#x7EA7;&#x7B97;&#x6CD5;&#x751F;&#x6210;&#x4E0A;&#x7EA7;&#x8282;&#x70B9;&#xFF0C;&#x4E0B;&#x7EA7;&#x7B97;&#x6CD5;&#x751F;&#x6210;&#x4E0B;&#x7EA7;&#x8282;&#x70B9;&#x3002;&#x8FD9;&#x5C31;&#x662F;<code>&#x4E0B;&#x964D;</code>&#x7684;&#x542B;&#x4E49;</li>
</ul>
<h3 id="t125.2 &#x4E0A;&#x4E0B;&#x6587;&#x65E0;&#x5173;&#x6587;&#x6CD5;">5.2 &#x4E0A;&#x4E0B;&#x6587;&#x65E0;&#x5173;&#x6587;&#x6CD5; <a href="#t125.2 &#x4E0A;&#x4E0B;&#x6587;&#x65E0;&#x5173;&#x6587;&#x6CD5;"> # </a></h3>
<ul>
<li>&#x4E0A;&#x4E0B;&#x6587;&#x65E0;&#x5173;&#x7684;&#x610F;&#x601D;&#x662F;&#xFF0C;&#x65E0;&#x8BBA;&#x5728;&#x4EFB;&#x4F55;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6587;&#x6CD5;&#x7684;&#x63A8;&#x5BFC;&#x89C4;&#x5219;&#x90FD;&#x662F;&#x4E00;&#x6837;&#x7684;</li>
<li>&#x89C4;&#x5219;&#x5206;&#x6210;&#x4E24;&#x7EA7;&#xFF1A;&#x7B2C;&#x4E00;&#x7EA7;&#x662F;&#x52A0;&#x6CD5;&#x89C4;&#x5219;&#xFF0C;&#x7B2C;&#x4E8C;&#x7EA7;&#x662F;&#x4E58;&#x6CD5;&#x89C4;&#x5219;&#x3002;&#x628A;&#x4E58;&#x6CD5;&#x89C4;&#x5219;&#x4F5C;&#x4E3A;&#x52A0;&#x6CD5;&#x89C4;&#x5219;&#x7684;&#x5B50;&#x89C4;&#x5219;</li>
<li>&#x89E3;&#x6790;&#x5F62;&#x6210; AST &#x65F6;&#xFF0C;&#x4E58;&#x6CD5;&#x8282;&#x70B9;&#x5C31;&#x4E00;&#x5B9A;&#x662F;&#x52A0;&#x6CD5;&#x8282;&#x70B9;&#x7684;&#x5B50;&#x8282;&#x70B9;&#xFF0C;&#x4ECE;&#x800C;&#x88AB;&#x4F18;&#x5148;&#x8BA1;&#x7B97;</li>
<li>&#x52A0;&#x6CD5;&#x89C4;&#x5219;&#x4E2D;&#x8FD8;<code>&#x9012;&#x5F52;</code>&#x5730;&#x53C8;&#x5F15;&#x7528;&#x4E86;&#x52A0;&#x6CD5;&#x89C4;&#x5219;</li>
</ul>
<h3 id="t135.3 &#x7B97;&#x672F;&#x8868;&#x8FBE;&#x5F0F;">5.3 &#x7B97;&#x672F;&#x8868;&#x8FBE;&#x5F0F; <a href="#t135.3 &#x7B97;&#x672F;&#x8868;&#x8FBE;&#x5F0F;"> # </a></h3>
<p>&#x7B97;&#x672F;&#x8868;&#x8FBE;&#x5F0F;</p>
<pre><code class="lang-js"><span class="hljs-number">2</span>+<span class="hljs-number">3</span>*<span class="hljs-number">4</span>
</code></pre>
<p>&#x8BED;&#x6CD5;&#x89C4;&#x5219;</p>
<pre><code class="lang-js">add -&gt;  multiple|multiple + add
multiple -&gt; NUMBER | NUMBER *  multiple
</code></pre>
<p>tokens</p>
<pre><code class="lang-js"> [
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;NUMBER&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;2&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;PLUS&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;+&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;NUMBER&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;3&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;MULTIPLY&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;*&apos;</span> },
    { <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;NUMBER&apos;</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;4&apos;</span> }
  ]
</code></pre>
<p><img src="https://img.zhufengpeixun.com/formularast.png" alt="formularast.png"></p>
<p><img src="https://img.zhufengpeixun.com/binaryast.jpg" alt="binaryast.jpg"></p>
<p>ast</p>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Program&quot;</span>,
  <span class="hljs-attr">&quot;children&quot;</span>: [
    {
      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Additive&quot;</span>,
      <span class="hljs-attr">&quot;children&quot;</span>: [
        {
          <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Numeric&quot;</span>,
          <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>
        },
        {
          <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Multiplicative&quot;</span>,
          <span class="hljs-attr">&quot;children&quot;</span>: [
            {
              <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Numeric&quot;</span>,
              <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>
            },
            {
              <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Numeric&quot;</span>,
              <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>
            }
          ]
        }
      ]
    }
  ]
}
</code></pre>
<h3 id="t145.4 &#x5B9E;&#x73B0;">5.4 &#x5B9E;&#x73B0; <a href="#t145.4 &#x5B9E;&#x73B0;"> # </a></h3>
<h4 id="t155.4.1 index.js">5.4.1 index.js <a href="#t155.4.1 index.js"> # </a></h4>
<p>index.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> parse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./parse&apos;</span>);
<span class="hljs-keyword">let</span> evaluate = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./evaluate&apos;</span>);
<span class="hljs-keyword">let</span> sourceCode = <span class="hljs-string">&quot;2+3*4&quot;</span>;
<span class="hljs-keyword">let</span> ast = parse(sourceCode);
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(ast, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>));
<span class="hljs-keyword">let</span> result = evaluate(ast);
<span class="hljs-built_in">console</span>.log(result);
</code></pre>
<h4 id="t165.4.2 parse.js">5.4.2 parse.js <a href="#t165.4.2 parse.js"> # </a></h4>
<p>parse.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> tokenize = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./tokenize&apos;</span>);
<span class="hljs-keyword">let</span> toAst = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./toAst&apos;</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parse</span>(<span class="hljs-params">script</span>) </span>{
    <span class="hljs-keyword">let</span> tokens = tokenize(script);
    <span class="hljs-built_in">console</span>.log(tokens);
    <span class="hljs-keyword">let</span> ast = toAst(tokens);
    <span class="hljs-keyword">return</span> ast;
}

<span class="hljs-built_in">module</span>.exports = parse;
</code></pre>
<h4 id="t175.4.3 tokenTypes.js">5.4.3 tokenTypes.js <a href="#t175.4.3 tokenTypes.js"> # </a></h4>
<p>tokenTypes.js</p>
<pre><code class="lang-js">exports.Program = <span class="hljs-string">&apos;Program&apos;</span>;
exports.Numeric = <span class="hljs-string">&apos;Numeric&apos;</span>;
exports.Additive = <span class="hljs-string">&apos;Additive&apos;</span>;
exports.Multiplicative = <span class="hljs-string">&apos;Multiplicative&apos;</span>;
</code></pre>
<h4 id="t185.4.4 tokenize.js">5.4.4 tokenize.js <a href="#t185.4.4 tokenize.js"> # </a></h4>
<p>tokenize.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> RegExpObject = <span class="hljs-regexp">/([0-9]+)|(\+)|(\*)/g</span>;
<span class="hljs-keyword">let</span> tokenTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./tokenTypes&apos;</span>);
<span class="hljs-keyword">let</span> tokenArray = [tokenTypes.NUMBER,tokenTypes.PLUS,tokenTypes.MULTIPLY];
<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">tokenizer</span>(<span class="hljs-params">source</span>)</span>{
  <span class="hljs-keyword">let</span> result = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>){
      result = RegExpObject.exec(source);
      <span class="hljs-keyword">if</span>(!result) <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">let</span> token = {<span class="hljs-attr">type</span>:<span class="hljs-literal">null</span>,<span class="hljs-attr">value</span>:<span class="hljs-literal">null</span>};
      <span class="hljs-keyword">let</span> index = result.findIndex(<span class="hljs-function">(<span class="hljs-params">item,index</span>)=&gt;</span>index&gt;<span class="hljs-number">0</span>&amp;&amp;!!item);<span class="hljs-comment">//&#x83B7;&#x53D6;&#x5339;&#x914D;&#x7684;&#x5206;&#x7EC4;&#x7684;&#x7D22;&#x5F15;</span>
      token.type = tokenArray[index<span class="hljs-number">-1</span>];
      token.value = result[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">yield</span> token;
  }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tokenize</span>(<span class="hljs-params">script</span>)</span>{
    <span class="hljs-keyword">let</span> tokens = [];
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> token <span class="hljs-keyword">of</span> tokenizer(script)){
        tokens.push(token);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TokenReader(tokens);
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TokenReader</span></span>{
    <span class="hljs-keyword">constructor</span>(tokens){
        <span class="hljs-keyword">this</span>.tokens = tokens;
        <span class="hljs-keyword">this</span>.pos = <span class="hljs-number">0</span>;
    }
    read() {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos &lt; <span class="hljs-keyword">this</span>.tokens.length) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tokens[<span class="hljs-keyword">this</span>.pos++];
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    peek() {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos &lt; <span class="hljs-keyword">this</span>.tokens.length) {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tokens[<span class="hljs-keyword">this</span>.pos];
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    unread() {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pos &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">this</span>.pos--;
        }
    }
    getPosition() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pos;
    }
    setPosition(position) {
        <span class="hljs-keyword">if</span> (position &gt;=<span class="hljs-number">0</span> &amp;&amp; position &lt; tokens.length){
            <span class="hljs-keyword">this</span>.pos = position;
        }
    }
}
<span class="hljs-built_in">module</span>.exports = tokenize;
<span class="hljs-comment">/* let tokens = tokenize(&apos;2+3*4&apos;);
console.log(tokens); */</span>
</code></pre>
<h4 id="t195.4.5 nodeTypes.js">5.4.5 nodeTypes.js <a href="#t195.4.5 nodeTypes.js"> # </a></h4>
<p>nodeTypes.js</p>
<pre><code class="lang-js">exports.Program = <span class="hljs-string">&apos;Program&apos;</span>;
exports.Numeric = <span class="hljs-string">&apos;Numeric&apos;</span>;
exports.Additive = <span class="hljs-string">&apos;Additive&apos;</span>;
exports.Multiplicative = <span class="hljs-string">&apos;Multiplicative&apos;</span>;
</code></pre>
<h4 id="t205.4.6 ASTNode.js">5.4.6 ASTNode.js <a href="#t205.4.6 ASTNode.js"> # </a></h4>
<p>ASTNode.js</p>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ASTNode</span></span>{
  <span class="hljs-keyword">constructor</span>(type,value){
      <span class="hljs-keyword">this</span>.type = type;
      <span class="hljs-keyword">if</span>(value)<span class="hljs-keyword">this</span>.value = value;
  }
  addChild(child) {
    <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.children) <span class="hljs-keyword">this</span>.children=[];
    <span class="hljs-keyword">this</span>.children.push(child);
  }
}

<span class="hljs-built_in">module</span>.exports = ASTNode;
</code></pre>
<h4 id="t215.4.7 toAst.js">5.4.7 toAst.js <a href="#t215.4.7 toAst.js"> # </a></h4>
<p>toAst.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> ASTNode = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./ASTNode&apos;</span>);
<span class="hljs-keyword">let</span> tokenTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./tokenTypes&apos;</span>);
<span class="hljs-keyword">let</span> nodeTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./nodeTypes&apos;</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toAst</span>(<span class="hljs-params">tokenReader</span>)</span>{
    <span class="hljs-keyword">let</span> node = <span class="hljs-keyword">new</span> ASTNode(<span class="hljs-string">&apos;Program&apos;</span>);
    <span class="hljs-keyword">let</span> child = additive(tokenReader);
    <span class="hljs-keyword">if</span> (child != <span class="hljs-literal">null</span>) {
        node.addChild(child);
    }
    <span class="hljs-keyword">return</span> node;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">additive</span>(<span class="hljs-params">tokenReader</span>)</span>{
    <span class="hljs-keyword">let</span> child1 = multiplicative(tokenReader);
    <span class="hljs-keyword">let</span> node = child1;
    <span class="hljs-keyword">let</span> token = tokenReader.peek();
    <span class="hljs-keyword">if</span> (child1 != <span class="hljs-literal">null</span> &amp;&amp; token != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (token.type == tokenTypes.PLUS) {
            token = tokenReader.read();
            <span class="hljs-keyword">let</span> child2 = additive(tokenReader);
            <span class="hljs-keyword">if</span> (child2 != <span class="hljs-literal">null</span>) {
                node = <span class="hljs-keyword">new</span> ASTNode(nodeTypes.Additive);
                node.addChild(child1);
                node.addChild(child2);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">&quot;&#x975E;&#x6CD5;&#x7684;&#x52A0;&#x6CD5;&#x8868;&#x8FBE;&#x5F0F;,&#x9700;&#x8981;&#x53F3;&#x534A;&#x90E8;&#x5206;&quot;</span>);
            }
        }
    }
    <span class="hljs-keyword">return</span> node;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">multiplicative</span>(<span class="hljs-params">tokenReader</span>)</span>{
    <span class="hljs-keyword">let</span> child1 = primary(tokenReader);
    <span class="hljs-keyword">let</span> node = child1;

    <span class="hljs-keyword">let</span> token = tokenReader.peek();
    <span class="hljs-keyword">if</span> (child1 != <span class="hljs-literal">null</span> &amp;&amp; token != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (token.type == tokenTypes.MULTIPLY) {
            token = tokenReader.read();
            <span class="hljs-keyword">let</span> child2 = primary(tokenReader);
            <span class="hljs-keyword">if</span> (child2 != <span class="hljs-literal">null</span>) {
                node = <span class="hljs-keyword">new</span> ASTNode(nodeTypes.Multiplicative);
                node.addChild(child1);
                node.addChild(child2);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">&quot;&#x975E;&#x6CD5;&#x7684;&#x4E58;&#x6CD5;&#x8868;&#x8FBE;&#x5F0F;,&#x9700;&#x8981;&#x53F3;&#x534A;&#x90E8;&#x5206;&quot;</span>);
            }
        }
    }
    <span class="hljs-keyword">return</span> node;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">primary</span>(<span class="hljs-params">tokenReader</span>)</span>{
    <span class="hljs-keyword">let</span> node = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> token = tokenReader.peek();
    <span class="hljs-keyword">if</span> (token != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (token.type == tokenTypes.NUMBER) {
            token = tokenReader.read();
            node = <span class="hljs-keyword">new</span> ASTNode(nodeTypes.Numeric, token.value);
        }
    }
    <span class="hljs-keyword">return</span> node;
}

<span class="hljs-built_in">module</span>.exports = toAst;
</code></pre>
<h4 id="t225.4.8 evaluate.js">5.4.8 evaluate.js <a href="#t225.4.8 evaluate.js"> # </a></h4>
<p>evaluate.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> nodeTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./nodeTypes&apos;</span>);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">evaluate</span>(<span class="hljs-params">node</span>) </span>{
    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">switch</span> (node.type) {
        <span class="hljs-keyword">case</span> nodeTypes.Program:
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> child <span class="hljs-keyword">of</span> node.children) {
                result = evaluate(child);
            }
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> nodeTypes.Additive:
            result = evaluate(node.children[<span class="hljs-number">0</span>]) + evaluate(node.children[<span class="hljs-number">1</span>]);    
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> nodeTypes.Multiplicative:
            result = evaluate(node.children[<span class="hljs-number">0</span>]) * evaluate(node.children[<span class="hljs-number">1</span>]);   
            <span class="hljs-keyword">break</span>; 
        <span class="hljs-keyword">case</span> nodeTypes.Numeric:
            result = <span class="hljs-built_in">parseFloat</span>(node.value);   
            <span class="hljs-keyword">break</span>;
    }
    <span class="hljs-keyword">return</span> result;
}
<span class="hljs-built_in">module</span>.exports = evaluate;
</code></pre>
<h3 id="t235.5 &#x652F;&#x6301;&#x51CF;&#x6CD5;&#x548C;&#x9664;&#x6CD5;">5.5 &#x652F;&#x6301;&#x51CF;&#x6CD5;&#x548C;&#x9664;&#x6CD5; <a href="#t235.5 &#x652F;&#x6301;&#x51CF;&#x6CD5;&#x548C;&#x9664;&#x6CD5;"> # </a></h3>
<h4 id="t245.5.1 index.js">5.5.1 index.js <a href="#t245.5.1 index.js"> # </a></h4>
<pre><code class="lang-diff"><span class="hljs-deletion">-let sourceCode = &apos;2+2*2+4&apos;;</span>
<span class="hljs-addition">+let sourceCode = &apos;6+1-3*4/2&apos;;</span>
</code></pre>
<h4 id="t255.5.2 tokenTypes.js">5.5.2 tokenTypes.js <a href="#t255.5.2 tokenTypes.js"> # </a></h4>
<pre><code class="lang-diff"><span class="hljs-addition">+exports.MINUS = &apos;MINUS&apos;;</span>
<span class="hljs-addition">+exports.MULTIPLY = &apos;MULTIPLY&apos;;//&#x4E58;&#x53F7;</span>
<span class="hljs-addition">+exports.DIVIDE = &apos;DIVIDE&apos;;</span>
</code></pre>
<h4 id="t265.5.3 tokenize.js">5.5.3 tokenize.js <a href="#t265.5.3 tokenize.js"> # </a></h4>
<pre><code class="lang-diff"><span class="hljs-addition">+let RegExpObject  = /([0-9]+)|(\+)|(\-)|(\*)|(\/)/g;</span>
<span class="hljs-addition">+let tokenNames = [tokenTypes.NUMBER,tokenTypes.PLUS,tokenTypes.MINUS,tokenTypes.MULTIPLY,tokenTypes.DIVIDE];</span>
</code></pre>
<h4 id="t275.5.4 nodeTypes.js">5.5.4 nodeTypes.js <a href="#t275.5.4 nodeTypes.js"> # </a></h4>
<pre><code class="lang-diff"><span class="hljs-addition">+exports.Minus = &apos;Minus&apos;;//&#x52A0;&#x6CD5;&#x8FD0;&#x7B97;</span>
<span class="hljs-addition">+exports.Multiplicative = &apos;Multiplicative&apos;;//&#x4E58;&#x6CD5;&#x8FD0;&#x7B97;</span>
<span class="hljs-addition">+exports.Divide = &apos;Divide&apos;;//&#x52A0;&#x6CD5;&#x8FD0;&#x7B97;</span>
</code></pre>
<h4 id="t285.5.5 toAST.js">5.5.5 toAST.js <a href="#t285.5.5 toAST.js"> # </a></h4>
<pre><code class="lang-diff">function additive(tokenReader){
     let child1 = multiple(tokenReader);   
     let node = child1;
     let token = tokenReader.peek();//&#x770B;&#x770B;&#x4E00;&#x4E0B;&#x7B26;&#x53F7;&#x662F;&#x4E0D;&#x662F;&#x52A0;&#x53F7;
     if(child1 != null &amp;&amp; token != null){
<span class="hljs-addition">+        if(token.type === tokenTypes.PLUS||token.type === tokenTypes.MINUS){//&#x5982;&#x679C;&#x540E;&#x9762;&#x662F;&#x52A0;&#x53F7;&#x7684;&#x8BDD;</span>
            token = tokenReader.read();//&#x628A;+&#x8BFB;&#x51FA;&#x6765;&#x5E76;&#x4E14;&#x6D88;&#x8017;&#x6389;
            let child2 = additive(tokenReader);
            if(child2 != null){
<span class="hljs-addition">+                node = new ASTNode(token.type === tokenTypes.PLUS?nodeTypes.Additive:nodeTypes.Minus);</span>
                node.appendChild(child1);
                node.appendChild(child2);
            }
        }
     }
     return node;
}
//multiple -&gt; NUMBER | NUMBER *  multiple
function multiple(tokenReader){
    let child1 = number(tokenReader);//&#x5148;&#x914D;&#x7F6E;&#x51FA;&#x6765;NUMBER,&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x4E58;&#x6CD5;&#x89C4;&#x5219;&#x5E76;&#x6CA1;&#x6709;&#x5339;&#x914D;&#x7ED3;&#x675F;
    let node = child1; //node=3
    let token = tokenReader.peek();//*
    if(child1 != null &amp;&amp; token != null){
<span class="hljs-addition">+       if(token.type === tokenTypes.MULTIPLY||token.type === tokenTypes.DIVIDE){</span>
         token = tokenReader.read();//&#x8BFB;&#x53D6;&#x4E0B;&#x4E00;&#x4E2A;token  *
         let child2 = multiple(tokenReader);//4
         if(child2 != null){
<span class="hljs-addition">+            node = new ASTNode(token.type === tokenTypes.MULTIPLY?nodeTypes.Multiplicative:nodeTypes.Divide);</span>
            node.appendChild(child1);
            node.appendChild(child2);
         }
       }
    }
    return node;
}
</code></pre>
<h4 id="t295.5.6 evaluate.js">5.5.6 evaluate.js <a href="#t295.5.6 evaluate.js"> # </a></h4>
<pre><code class="lang-diff"> switch(node.type){
    case nodeTypes.Program:
        for(let child of node.children){
            result = evaluate(child);//child  Additive
        }
        break;
    case nodeTypes.Additive://&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x52A0;&#x6CD5;&#x8282;&#x70B9;&#x7684;&#x8BDD;,&#x5982;&#x4F55;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;
        result = evaluate(node.children[0])+evaluate(node.children[1]);
        break;   
<span class="hljs-addition">+    case nodeTypes.Minus://&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x52A0;&#x6CD5;&#x8282;&#x70B9;&#x7684;&#x8BDD;,&#x5982;&#x4F55;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;</span>
<span class="hljs-addition">+        result = evaluate(node.children[0]) - evaluate(node.children[1]);</span>
<span class="hljs-addition">+        break;     </span>
    case nodeTypes.Multiplicative://&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x52A0;&#x6CD5;&#x8282;&#x70B9;&#x7684;&#x8BDD;,&#x5982;&#x4F55;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;
        result = evaluate(node.children[0]) * evaluate(node.children[1]);
        break;   
<span class="hljs-addition">+    case nodeTypes.Divide://&#x5982;&#x679C;&#x662F;&#x4E00;&#x4E2A;&#x52A0;&#x6CD5;&#x8282;&#x70B9;&#x7684;&#x8BDD;,&#x5982;&#x4F55;&#x8BA1;&#x7B97;&#x7ED3;&#x679C;</span>
<span class="hljs-addition">+        result = evaluate(node.children[0]) / evaluate(node.children[1]);</span>
<span class="hljs-addition">+        break;        </span>
    case nodeTypes.Numeric:
        result = parseFloat(node.value);
    default:
        break;        
  }  
</code></pre>
<h3 id="t305.6 &#x652F;&#x6301;&#x62EC;&#x53F7;">5.6 &#x652F;&#x6301;&#x62EC;&#x53F7; <a href="#t305.6 &#x652F;&#x6301;&#x62EC;&#x53F7;"> # </a></h3>
<h4 id="t315.6.1 index.js">5.6.1 index.js <a href="#t315.6.1 index.js"> # </a></h4>
<pre><code class="lang-diff"><span class="hljs-addition">+ let sourceCode = &apos;(1+2)*3*(2+2)&apos;;</span>
</code></pre>
<h4 id="t325.6.2 tokenTypes.js">5.6.2 tokenTypes.js <a href="#t325.6.2 tokenTypes.js"> # </a></h4>
<pre><code class="lang-diff"><span class="hljs-addition">+ exports.LEFT_PARA = &apos;LEFT_PARA&apos;;</span>
<span class="hljs-addition">+ exports.RIGHT_PARA = &apos;RIGHT_PARA&apos;;</span>
</code></pre>
<h4 id="t335.6.3 tokenize.js">5.6.3 tokenize.js <a href="#t335.6.3 tokenize.js"> # </a></h4>
<pre><code class="lang-diff"><span class="hljs-addition">+let RegExpObject  = /([0-9]+)|(\+)|(\-)|(\*)|(\/)|(\()|(\))/g;</span>
let tokenTypes = require(&apos;./tokenTypes&apos;);
<span class="hljs-addition">+let tokenNames = [tokenTypes.NUMBER,tokenTypes.PLUS,tokenTypes.MINUS,tokenTypes.MULTIPLY,tokenTypes.DIVIDE,tokenTypes.LEFT_PARA,tokenTypes.RIGHT_PARA];</span>
</code></pre>
<h4 id="t345.6.4 toAST.js">5.6.4 toAST.js <a href="#t345.6.4 toAST.js"> # </a></h4>
<pre><code class="lang-diff">additive -&gt; multiple|multiple + additive
multiple -&gt; primary | primary *  multiple
primary -&gt; NUMBER | (add)

function multiple(tokenReader){
<span class="hljs-addition">+    let child1 = primary(tokenReader);//&#x5148;&#x914D;&#x7F6E;&#x51FA;&#x6765;NUMBER,&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x4E58;&#x6CD5;&#x89C4;&#x5219;&#x5E76;&#x6CA1;&#x6709;&#x5339;&#x914D;&#x7ED3;&#x675F;</span>
    let node = child1; //node=3
    let token = tokenReader.peek();//*
    if(child1 != null &amp;&amp; token != null){
       if(token.type <span class="hljs-comment">=== tokenTypes.MULTIPLY||token.type === tokenTypes.DIVIDE){</span>
         token = tokenReader.read();//&#x8BFB;&#x53D6;&#x4E0B;&#x4E00;&#x4E2A;token  *
         let child2 = multiple(tokenReader);//4
         if(child2 != null){
            node = new ASTNode(token.type <span class="hljs-comment">=== tokenTypes.MULTIPLY?nodeTypes.Multiplicative:nodeTypes.Divide);</span>
            node.appendChild(child1);
            node.appendChild(child2);
         }
       }
    }
    return node;
}
<span class="hljs-addition">+function primary(tokenReader){ //(1+2)*3</span>
<span class="hljs-addition">+  let node = number(tokenReader);</span>
<span class="hljs-addition">+  if(!node){</span>
<span class="hljs-addition">+    let token = tokenReader.peek();</span>
<span class="hljs-addition">+    if(token != null &amp;&amp; token.type === tokenTypes.LEFT_PARA){</span>
<span class="hljs-addition">+      tokenReader.read();</span>
<span class="hljs-addition">+      node  = additive(tokenReader);</span>
<span class="hljs-addition">+      tokenReader.read();</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+  }</span>
<span class="hljs-addition">+  return node;</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h3 id="t355.7 &#x4E8C;&#x5143;&#x8868;&#x8FBE;&#x5F0F;">5.7 &#x4E8C;&#x5143;&#x8868;&#x8FBE;&#x5F0F; <a href="#t355.7 &#x4E8C;&#x5143;&#x8868;&#x8FBE;&#x5F0F;"> # </a></h3>
<h4 id="t365.7.1  &#x4F18;&#x5148;&#x7EA7;&#xFF08;Priority&#xFF09;">5.7.1  &#x4F18;&#x5148;&#x7EA7;&#xFF08;Priority&#xFF09; <a href="#t365.7.1  &#x4F18;&#x5148;&#x7EA7;&#xFF08;Priority&#xFF09;"> # </a></h4>
<ul>
<li>&#x4E0D;&#x540C;&#x7684;&#x8FD0;&#x7B97;&#x7B26;&#x4E4B;&#x95F4;&#x662F;&#x6709;&#x4F18;&#x5148;&#x7EA7;&#x7684;</li>
<li>&#x52A0;&#x51CF;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x4E00;&#x6837;,&#x4E58;&#x9664;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x4E00;&#x6837;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-number">2</span>+<span class="hljs-number">3</span>*<span class="hljs-number">4</span>
</code></pre>
<h4 id="t375.7.2  &#x7ED3;&#x5408;&#x6027;&#xFF08;Associativity&#xFF09;">5.7.2  &#x7ED3;&#x5408;&#x6027;&#xFF08;Associativity&#xFF09; <a href="#t375.7.2  &#x7ED3;&#x5408;&#x6027;&#xFF08;Associativity&#xFF09;"> # </a></h4>
<ul>
<li>&#x540C;&#x6837;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x8FD0;&#x7B97;&#x7B26;&#x662F;&#x4ECE;&#x5DE6;&#x5230;&#x53F3;&#x8BA1;&#x7B97;&#x8FD8;&#x662F;&#x4ECE;&#x53F3;&#x5230;&#x5DE6;&#x8BA1;&#x7B97;&#x53EB;&#x505A;&#x7ED3;&#x5408;&#x6027;</li>
<li>&#x52A0;&#x51CF;&#x4E58;&#x9664;&#x7B49;&#x7B97;&#x672F;&#x8FD0;&#x7B97;&#x662F;&#x5DE6;&#x7ED3;&#x5408;&#x7684;&#xFF0C;<code>.</code>&#x7B26;&#x53F7;&#x4E5F;&#x662F;&#x5DE6;&#x7ED3;&#x5408;&#x7684;&#x3002;</li>
<li>&#x7ED3;&#x5408;&#x6027;&#x662F;&#x8DDF;&#x5DE6;&#x9012;&#x5F52;&#x8FD8;&#x662F;&#x53F3;&#x9012;&#x5F52;&#x6709;&#x5173;&#x7684;&#xFF0C;&#x5DE6;&#x9012;&#x5F52;&#x5BFC;&#x81F4;&#x5DE6;&#x7ED3;&#x5408;&#xFF0C;&#x53F3;&#x9012;&#x5F52;&#x5BFC;&#x81F4;&#x53F3;&#x7ED3;&#x5408;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-number">4</span>+<span class="hljs-number">3</span><span class="hljs-number">-2</span><span class="hljs-number">-2</span>
<span class="hljs-number">8</span>/<span class="hljs-number">2</span>/<span class="hljs-number">2</span>
</code></pre>
<h4 id="t385.7.3 &#x6587;&#x6CD5;&#x89C4;&#x5219;">5.7.3 &#x6587;&#x6CD5;&#x89C4;&#x5219; <a href="#t385.7.3 &#x6587;&#x6CD5;&#x89C4;&#x5219;"> # </a></h4>
<ul>
<li>&#x4F18;&#x5148;&#x7EA7;&#x662F;&#x901A;&#x8FC7;&#x5728;&#x8BED;&#x6CD5;&#x63A8;&#x5BFC;&#x4E2D;&#x7684;&#x5C42;&#x6B21;&#x6765;&#x51B3;&#x5B9A;&#x7684;&#xFF0C;&#x4F18;&#x5148;&#x7EA7;&#x8D8A;&#x4F4E;&#x7684;&#xFF0C;&#x8D8A;&#x5148;&#x5C1D;&#x8BD5;&#x63A8;&#x5BFC;</li>
<li>&#x901A;&#x8FC7;&#x6587;&#x6CD5;&#x7684;&#x5D4C;&#x5957;&#xFF0C;&#x5B9E;&#x73B0;&#x5BF9;&#x8FD0;&#x7B97;&#x4F18;&#x5148;&#x7EA7;&#x7684;&#x652F;&#x6301;</li>
</ul>
<pre><code class="lang-js">additive : multiple|additive+multiple
<span class="hljs-attr">multiple</span> : NUMBER|multiple*NUMBER
</code></pre>
<p><img src="https://img.zhufengpeixun.com/twoplustheemultiplyfour.jpg" alt="twoplustheemultiplyfour.jpg"></p>
<p><img src="https://img.zhufengpeixun.com/twoplustheeplusfour" alt="twoplustheeplusfour"></p>
<h4 id="t395.7.3 &#x5DE6;&#x9012;&#x5F52;&#xFF08;Left Recursive&#xFF09;">5.7.3 &#x5DE6;&#x9012;&#x5F52;&#xFF08;Left Recursive&#xFF09; <a href="#t395.7.3 &#x5DE6;&#x9012;&#x5F52;&#xFF08;Left Recursive&#xFF09;"> # </a></h4>
<ul>
<li>&#x5728;&#x4E8C;&#x5143;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x8BED;&#x6CD5;&#x89C4;&#x5219;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x4EA7;&#x751F;&#x5F0F;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x5143;&#x7D20;&#x662F;&#x5B83;&#x81EA;&#x8EAB;&#xFF0C;&#x90A3;&#x4E48;&#x7A0B;&#x5E8F;&#x5C31;&#x4F1A;&#x65E0;&#x9650;&#x5730;&#x9012;&#x5F52;&#x4E0B;&#x53BB;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x5C31;&#x53EB;&#x505A;&#x5DE6;&#x9012;&#x5F52;</li>
<li>&#x5DF4;&#x79D1;&#x65AF;&#x8303;&#x5F0F; &#x4EE5;&#x7F8E;&#x56FD;&#x4EBA;&#x5DF4;&#x79D1;&#x65AF;&#x548C;&#x4E39;&#x9EA6;&#x4EBA;&#x8BFA;&#x5C14;&#x7684;&#x540D;&#x5B57;&#x547D;&#x540D;&#x7684;&#x4E00;&#x79CD;&#x5F62;&#x5F0F;&#x5316;&#x7684;&#x8BED;&#x6CD5;&#x8868;&#x793A;&#x65B9;&#x6CD5;&#xFF0C;&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x8BED;&#x6CD5;&#x7684;&#x4E00;&#x79CD;&#x5F62;&#x5F0F;&#x4F53;&#x7CFB;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params"></span>)</span>{
    add();
    multiply();
}
</code></pre>
<h4 id="t405.7.4 &#x6D88;&#x9664;&#x5DE6;&#x9012;&#x5F52;">5.7.4 &#x6D88;&#x9664;&#x5DE6;&#x9012;&#x5F52; <a href="#t405.7.4 &#x6D88;&#x9664;&#x5DE6;&#x9012;&#x5F52;"> # </a></h4>
<ul>
<li>&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x6D88;&#x9664;&#x5DE6;&#x9012;&#x5F52;,&#x4F46;&#x662F;&#x4F1A;&#x5E26;&#x6765;&#x7ED3;&#x5408;&#x6027;&#x7684;&#x95EE;&#x9898;</li>
</ul>
<pre><code class="lang-js">additive : multiple|multiple+additive
<span class="hljs-attr">multiple</span> : NUMBER|NUMBER*multiple
</code></pre>
<p><img src="https://img.zhufengpeixun.com/twoplustheeplusfour2.jpg" alt="twoplustheeplusfour2.jpg"></p>
<h4 id="t415.7.5 &#x5FAA;&#x73AF;&#x6D88;&#x9664;&#x5DE6;&#x9012;&#x5F52;">5.7.5 &#x5FAA;&#x73AF;&#x6D88;&#x9664;&#x5DE6;&#x9012;&#x5F52; <a href="#t415.7.5 &#x5FAA;&#x73AF;&#x6D88;&#x9664;&#x5DE6;&#x9012;&#x5F52;"> # </a></h4>
<ul>
<li>&#x6269;&#x5C55;&#x5DF4;&#x79D1;&#x65AF;&#x8303;&#x5F0F; (EBNF)&#x4F1A;&#x7528;&#x5230;&#x7C7B;&#x4F3C;<code>&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;</code>&#x7684;&#x4E00;&#x4E9B;&#x5199;&#x6CD5;</li>
<li>&#x53EF;&#x4EE5;&#x628A;&#x9012;&#x5F52;&#x6539;&#x6210;<code>&#x5FAA;&#x73AF;</code></li>
</ul>
<pre><code class="lang-js">additive -&gt; multiple (+ multiple)*
multiple -&gt; NUMBER (* NUMBER)*
</code></pre>
<h4 id="t425.7.6 &#x5B9E;&#x73B0;">5.7.6 &#x5B9E;&#x73B0; <a href="#t425.7.6 &#x5B9E;&#x73B0;"> # </a></h4>
<p>toAST.js</p>
<pre><code class="lang-diff">
const ASTNode = require(&apos;./ASTNode&apos;);
let nodeTypes = require(&apos;./nodeTypes&apos;);
let tokenTypes = require(&apos;./tokenTypes&apos;);
/**
4+3-2-2
<span class="hljs-addition">+additive -&gt; multiple|multiple [+-] additive   &#x5305;&#x62EC;+-</span>
<span class="hljs-addition">+multiple -&gt; primary|primary [&#x661F;/] multiple    &#x5305;&#x62EC;&#x661F;/</span>
<span class="hljs-addition">+primary -&gt; NUMBER | (additive) &#x57FA;&#x7840;&#x89C4;&#x5219;</span>
*/
function toAST(tokenReader) {
  let rootNode = new ASTNode(nodeTypes.Program);
  //&#x5F00;&#x59CB;&#x63A8;&#x5BFC;&#x4E86; &#x52A0;&#x6CD5; &#x4E58;&#x6CD5; &#x5148;&#x63A8;&#x5BFC;&#x52A0;&#x6CD5;
  //&#x5B9E;&#x73B0;&#x7684;&#x65F6;&#x5019;,&#x6BCF;&#x4E00;&#x4E2A;&#x89C4;&#x5219;&#x90FD;&#x662F;&#x4E00;&#x4E2A;&#x51FD;&#x6570;additive&#x5BF9;&#x5E94;&#x52A0;&#x6CD5;&#x89C4;&#x5219;
  let child = additive(tokenReader);
  if (child)
    rootNode.appendChild(child);
  return rootNode;
}
//additive -&gt; multiple|multiple [+-] additive
function additive(tokenReader) {
<span class="hljs-addition">+  let child1 = multiple(tokenReader);</span>
<span class="hljs-addition">+  let node = child1;</span>
<span class="hljs-addition">+  if (child1 != null) {</span>
<span class="hljs-addition">+    while (true) {</span>
<span class="hljs-addition">+      let token = tokenReader.peek();//&#x770B;&#x770B;&#x4E00;&#x4E0B;&#x7B26;&#x53F7;&#x662F;&#x4E0D;&#x662F;&#x52A0;&#x53F7;</span>
<span class="hljs-addition">+      if (token != null &amp;&amp; (token.type === tokenTypes.PLUS || token.type === tokenTypes.MINUS)) {</span>
<span class="hljs-addition">+        token = tokenReader.read();//&#x628A;+-&#x8BFB;&#x51FA;&#x6765;&#x5E76;&#x4E14;&#x6D88;&#x8017;&#x6389;</span>
<span class="hljs-addition">+        let child2 = multiple(tokenReader);</span>
<span class="hljs-addition">+        node = new ASTNode(token.type === tokenTypes.PLUS ? nodeTypes.Additive : nodeTypes.Minus);</span>
<span class="hljs-addition">+        node.appendChild(child1);</span>
<span class="hljs-addition">+        node.appendChild(child2);</span>
<span class="hljs-addition">+        child1 = node;</span>
<span class="hljs-addition">+      } else {</span>
<span class="hljs-addition">+        break;</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+  }</span>
  return node;
}
//multiple -&gt; primary|primary [&#x661F;/] multiple
function multiple(tokenReader) {
<span class="hljs-addition">+  let child1 = primary(tokenReader);//&#x5148;&#x914D;&#x7F6E;&#x51FA;&#x6765;NUMBER,&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x4E58;&#x6CD5;&#x89C4;&#x5219;&#x5E76;&#x6CA1;&#x6709;&#x5339;&#x914D;&#x7ED3;&#x675F;</span>
<span class="hljs-addition">+  let node = child1; //node=3</span>
<span class="hljs-addition">+  if (child1 != null) {</span>
<span class="hljs-addition">+    while (true) {</span>
<span class="hljs-addition">+      let token = tokenReader.peek();//*/</span>
<span class="hljs-addition">+      if (token != null &amp;&amp; (token.type === tokenTypes.MULTIPLY || token.type === tokenTypes.DIVIDE)) {</span>
<span class="hljs-addition">+        token = tokenReader.read();//&#x628A;*/&#x8BFB;&#x51FA;&#x6765;&#x5E76;&#x4E14;&#x6D88;&#x8017;&#x6389;</span>
<span class="hljs-addition">+        let child2 = primary(tokenReader);</span>
<span class="hljs-addition">+        node = new ASTNode(token.type === tokenTypes.MULTIPLY ? nodeTypes.Multiplicative : nodeTypes.Divide);</span>
<span class="hljs-addition">+        node.appendChild(child1);</span>
<span class="hljs-addition">+        node.appendChild(child2);</span>
<span class="hljs-addition">+        child1 = node;</span>
<span class="hljs-addition">+      } else {</span>
<span class="hljs-addition">+        break;</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+  }</span>
  return node;
}
//primary -&gt; NUMBER | (additive) &#x57FA;&#x7840;&#x89C4;&#x5219;
function primary(tokenReader) {
  let node = number(tokenReader);
  if (!node) {
    let token = tokenReader.peek();
    if (token != null &amp;&amp; token.type <span class="hljs-comment">=== tokenTypes.LEFT_PARA) {</span>
      tokenReader.read();
      node = additive(tokenReader);
      tokenReader.read();
    }
  }
  return node;
}
function number(tokenReader) {
  let node = null;
  let token = tokenReader.peek();//&#x770B;&#x770B;&#x5F53;&#x524D;&#x7684;&#x8FD9;&#x4E2A;token
  //&#x5982;&#x679C;&#x80FD;&#x53D6;&#x51FA; token,&#x5E76;&#x4E14;token&#x7684;&#x7C7B;&#x578B;&#x662F;&#x6570;&#x5B57;&#x7684;&#x8BDD; &#x5339;&#x914D;&#x4E0A;&#x4E86;
  if (token != null &amp;&amp; token.type <span class="hljs-comment">=== tokenTypes.NUMBER) {</span>
    token = tokenReader.read();//&#x8BFB;&#x53D6;&#x5E76;&#x6D88;&#x8017;&#x6389;&#x8FD9;&#x4E2A;Token
    //&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x8BED;&#x6CD5;&#x6811;&#x8282;&#x70B9;,&#x7C7B;&#x578B;&#x662F;Numeric,&#x503C;&#x662F;2
    node = new ASTNode(nodeTypes.Numeric, token.value);
  }
  return node;
}

module.exports = toAST;
</code></pre>
<h2 id="t436. &#x8BED;&#x6CD5;&#x5206;&#x6790;&#x5668;">6. &#x8BED;&#x6CD5;&#x5206;&#x6790;&#x5668; <a href="#t436. &#x8BED;&#x6CD5;&#x5206;&#x6790;&#x5668;"> # </a></h2>
<ul>
<li>&#x8BED;&#x6CD5;&#x5206;&#x6790;&#x5668;&#x63A5;&#x53D7; token &#x6570;&#x7EC4;&#xFF0C;&#x7136;&#x540E;&#x628A;&#x5B83;&#x8F6C;&#x5316;&#x4E3A; <code>AST</code></li>
</ul>
<h3 id="t446.1  nodeTypes.js">6.1  nodeTypes.js <a href="#t446.1  nodeTypes.js"> # </a></h3>
<p>src\nodeTypes.js</p>
<pre><code class="lang-js">exports.Program = <span class="hljs-string">&apos;Program&apos;</span>;
exports.ExpressionStatement = <span class="hljs-string">&apos;ExpressionStatement&apos;</span>;
<span class="hljs-comment">//JSX&#x5143;&#x7D20;</span>
exports.JSXElement = <span class="hljs-string">&apos;JSXElement&apos;</span>;
<span class="hljs-comment">//&#x5F00;&#x59CB;&#x6807;&#x7B7E;</span>
exports.JSXOpeningElement = <span class="hljs-string">&apos;JSXOpeningElement&apos;</span>;
<span class="hljs-comment">//&#x5C5E;&#x6027;</span>
exports.JSXAttribute = <span class="hljs-string">&apos;JSXAttribute&apos;</span>;
<span class="hljs-comment">//&#x6807;&#x7B7E;&#x540D;</span>
exports.JSXIdentifier = <span class="hljs-string">&apos;JSXIdentifier&apos;</span>;
<span class="hljs-comment">//&#x5143;&#x7D20;&#x5C5E;&#x6027;</span>
exports.AttributeKey=<span class="hljs-string">&apos;AttributeKey&apos;</span>;
<span class="hljs-comment">//&#x7ED3;&#x675F;&#x6807;&#x7B7E;</span>
exports.JSXClosingElement=<span class="hljs-string">&apos;JSXClosingElement&apos;</span>;
<span class="hljs-comment">//&#x5B57;&#x7B26;&#x4E32;&#x5B57;&#x9762;&#x91CF;</span>
exports.StringLiteral = <span class="hljs-string">&apos;StringLiteral&apos;</span>;
<span class="hljs-comment">//JSX&#x6587;&#x672C;</span>
exports.JSXText = <span class="hljs-string">&apos;JSXText&apos;</span>;

exports.MemberExpression = <span class="hljs-string">&apos;MemberExpression&apos;</span>;
exports.ObjectExpression = <span class="hljs-string">&apos;ObjectExpression&apos;</span>;
exports.ObjectProperty = <span class="hljs-string">&apos;ObjectProperty&apos;</span>;
exports.CallExpression = <span class="hljs-string">&apos;CallExpression&apos;</span>;
exports.Identifier = <span class="hljs-string">&apos;Identifier&apos;</span>;
exports.NumberLiteral = <span class="hljs-string">&apos;NumberLiteral&apos;</span>;
exports.StringLiteral = <span class="hljs-string">&apos;StringLiteral&apos;</span>;
exports.NullLiteral = <span class="hljs-string">&apos;NullLiteral&apos;</span>;
</code></pre>
<h3 id="t456.2  parser.js">6.2  parser.js <a href="#t456.2  parser.js"> # </a></h3>
<p>src\parser.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> { tokenizer } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./tokenizer&apos;</span>);
<span class="hljs-keyword">const</span> tokenTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./tokenTypes&apos;</span>);
<span class="hljs-keyword">const</span> nodeTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./nodeTypes&apos;</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parser</span>(<span class="hljs-params">code</span>) </span>{
    <span class="hljs-keyword">let</span> tokens = tokenizer(code);
    <span class="hljs-keyword">let</span> current = <span class="hljs-number">0</span>;
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">walk</span>(<span class="hljs-params">parent</span>) </span>{
        <span class="hljs-keyword">let</span> token = tokens[current]; <span class="hljs-comment">//&#x5F53;&#x524D;token</span>
        <span class="hljs-keyword">let</span> next = tokens[current + <span class="hljs-number">1</span>]; 
        <span class="hljs-comment">// &#x4E0B;&#x4E00;&#x4E2A;&#x5355;&#x8BCD;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x9884;&#x5224;&#x4E00;&#x4E0B;&#x5F53;&#x524D;&lt;&#x662F;&#x5C5E;&#x4E8E;&#x5F00;&#x59CB;&#x7684;&#x62EC;&#x53F7;&#x8FD8;&#x662F;&#x95ED;&#x5408;&#x7684;&#x62EC;&#x53F7;</span>
        <span class="hljs-comment">// &#x8FD9;&#x4E2A;&#x662F;&#x5904;&#x7406;&#x5F00;&#x59CB;&#x6807;&#x7B7E;</span>
        <span class="hljs-keyword">if</span> (token.type === tokenTypes.LeftParentheses &amp;&amp; next.type === tokenTypes.JSXIdentifier) {
            <span class="hljs-keyword">let</span> node = {
                <span class="hljs-attr">type</span>: nodeTypes.JSXElement,
                <span class="hljs-attr">openingElement</span>: <span class="hljs-literal">null</span>,
                <span class="hljs-attr">closingElement</span>: <span class="hljs-literal">null</span>,
                <span class="hljs-attr">children</span>: []
            }
            token = tokens[++current]; <span class="hljs-comment">// &#x6807;&#x7B7E;</span>
            node.openingElement = {
                <span class="hljs-attr">type</span>: nodeTypes.JSXOpeningElement,
                <span class="hljs-attr">name</span>: {
                    <span class="hljs-attr">type</span>: nodeTypes.JSXIdentifier,
                    <span class="hljs-attr">name</span>: token.value
                },
                <span class="hljs-attr">attributes</span>: []
            }

            token = tokens[++current]; <span class="hljs-comment">// &#x53D6;&#x4E0B;&#x4E00;&#x4E2A;&#x6807;&#x7B7E;</span>
            <span class="hljs-comment">//&#x83B7;&#x53D6;&#x6240;&#x6709;&#x7684;&#x5C5E;&#x6027;</span>
            <span class="hljs-keyword">while</span> (token.type === tokenTypes.AttributeKey) {
                node.openingElement.attributes.push(walk());
                token = tokens[current];
            }
            token = tokens[++current]; <span class="hljs-comment">// &#x8DF3;&#x8FC7;&gt;,token=&lt;</span>
            next = tokens[current+<span class="hljs-number">1</span>]; <span class="hljs-comment">// &#x4E0B;&#x4E00;&#x4E2A;token span</span>
            <span class="hljs-comment">// &#x6839;&#x636E;&#x7ED3;&#x675F;&#x6807;&#x7B7E;&#x7684;&#x6807;&#x7B7E;&#x540D;&#x4E00;&#x81F4;&#xFF0C;&#x4E2D;&#x95F4;&#x7684;&#x5185;&#x5BB9;&#x90FD;&#x662F;&#x5B69;&#x5B50;&#x8282;&#x70B9;</span>
            <span class="hljs-keyword">while</span> (
                token.type !== tokenTypes.LeftParentheses <span class="hljs-comment">//&#x5B57;&#x9762;&#x91CF;&#x5B50;&#x8282;&#x70B9;</span>
                ||( token.type === tokenTypes.LeftParentheses 
                    &amp;&amp; next.type !== tokenTypes.BackSlash)) { <span class="hljs-comment">// walk&#x6240;&#x6709;&#x5B69;&#x5B50;</span>
                node.children.push(walk());
                token = tokens[current];
                next = tokens[current+<span class="hljs-number">1</span>]; <span class="hljs-comment">// &#x4E0B;&#x4E00;&#x4E2A;token</span>
            }
            node.closingElement = walk(node); <span class="hljs-comment">// walk&#x95ED;&#x5408;&#x6807;&#x7B7E;</span>
            <span class="hljs-keyword">return</span> node;
        } 
        <span class="hljs-comment">//&#x5904;&#x7406;&#x7ED3;&#x675F;&#x6807;&#x7B7E;</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(parent &amp;&amp; token.type === tokenTypes.LeftParentheses &amp;&amp; next.type === tokenTypes.BackSlash){
            current++; <span class="hljs-comment">// &#x8DF3;&#x8FC7;&lt;&#x5355;&#x8BCD;</span>
            token = tokens[++current]; <span class="hljs-comment">// &#x95ED;&#x5408;&#x6807;&#x7B7E;&#xFF0C;&#x8DF3;&#x8FC7;&#x53CD;&#x659C;&#x6760;</span>
            current++; <span class="hljs-comment">// &#x8DF3;&#x8FC7;&#x6807;&#x7B7E;</span>
            current++; <span class="hljs-comment">// &#x8DF3;&#x8FC7;&gt;&#x5355;&#x8BCD;</span>
            <span class="hljs-keyword">return</span> parent.closingElement = {
                <span class="hljs-attr">type</span>: nodeTypes.JSXClosingElement,
                <span class="hljs-attr">name</span>: {
                    <span class="hljs-attr">type</span>: nodeTypes.JSXIdentifier,
                    <span class="hljs-attr">name</span>: token.value
                }
            }
        }<span class="hljs-comment">//&#x5904;&#x7406;&#x5C5E;&#x6027;</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(token.type === tokenTypes.AttributeKey){
            <span class="hljs-keyword">let</span> next = tokens[++current]; <span class="hljs-comment">// attributeValue</span>
            <span class="hljs-keyword">let</span> node = {
                <span class="hljs-attr">type</span>: nodeTypes.JSXAttribute,
                <span class="hljs-attr">name</span>: {
                    <span class="hljs-attr">type</span>: nodeTypes.JSXIdentifier,
                    <span class="hljs-attr">name</span>: token.value
                },
                <span class="hljs-attr">value</span>: {
                    <span class="hljs-attr">type</span>: nodeTypes.StringLiteral,
                    <span class="hljs-attr">value</span>: next.value
                }
            }
            current++; <span class="hljs-comment">// &#x8DF3;&#x8FC7;attributeValue</span>
            <span class="hljs-keyword">return</span> node;
        }<span class="hljs-comment">//&#x5904;&#x7406;&#x6587;&#x672C;</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(token.type === tokenTypes.JSXText){
            current++; <span class="hljs-comment">// &#x8DF3;&#x8FC7;&gt;</span>
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">type</span>: nodeTypes.JSXText,
                <span class="hljs-attr">value</span>: token.value
            }
        }
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(token.type);
    }
    <span class="hljs-keyword">var</span> ast = {
        <span class="hljs-attr">type</span>: nodeTypes.Program,
        <span class="hljs-attr">body</span>: [
            {
                <span class="hljs-attr">type</span>: nodeTypes.ExpressionStatement,
                <span class="hljs-attr">expression</span>: walk()
            }
        ]
    };
    <span class="hljs-keyword">return</span> ast;
}

<span class="hljs-built_in">module</span>.exports = {
    parser
}

<span class="hljs-comment">/*
let code = &apos;&lt;h1 id=&quot;title&quot;&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;&apos;;
console.log(JSON.stringify(parser(code), null, 2));
*/</span>
</code></pre>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Program&quot;</span>,
  <span class="hljs-attr">&quot;body&quot;</span>: [
    {
      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;ExpressionStatement&quot;</span>,
      <span class="hljs-attr">&quot;expression&quot;</span>: {
        <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXElement&quot;</span>,
        <span class="hljs-attr">&quot;openingElement&quot;</span>: {
          <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXOpeningElement&quot;</span>,
          <span class="hljs-attr">&quot;name&quot;</span>: {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;h1&quot;</span>
          },
          <span class="hljs-attr">&quot;attributes&quot;</span>: [
            {
              <span class="hljs-attr">&quot;name&quot;</span>: {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;id&quot;</span>
              },
              <span class="hljs-attr">&quot;value&quot;</span>: {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringLiteral&quot;</span>,
                <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;title&quot;</span>
              }
            }
          ]
        },
        <span class="hljs-attr">&quot;closingElement&quot;</span>: {
          <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXClosingElement&quot;</span>,
          <span class="hljs-attr">&quot;name&quot;</span>: {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;h1&quot;</span>
          }
        },
        <span class="hljs-attr">&quot;children&quot;</span>: [
          {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXElement&quot;</span>,
            <span class="hljs-attr">&quot;openingElement&quot;</span>: {
              <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXOpeningElement&quot;</span>,
              <span class="hljs-attr">&quot;name&quot;</span>: {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;span&quot;</span>
              },
              <span class="hljs-attr">&quot;attributes&quot;</span>: []
            },
            <span class="hljs-attr">&quot;closingElement&quot;</span>: {
              <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXClosingElement&quot;</span>,
              <span class="hljs-attr">&quot;name&quot;</span>: {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXIdentifier&quot;</span>,
                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;span&quot;</span>
              }
            },
            <span class="hljs-attr">&quot;children&quot;</span>: [
              {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXText&quot;</span>,
                <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;hello&quot;</span>
              }
            ]
          },
          {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;JSXText&quot;</span>,
            <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;world&quot;</span>
          }
        ]
      }
    }
  ]
}
</code></pre>
<h2 id="t467. &#x904D;&#x5386;&#x8BED;&#x6CD5;&#x6811;">7. &#x904D;&#x5386;&#x8BED;&#x6CD5;&#x6811; <a href="#t467. &#x904D;&#x5386;&#x8BED;&#x6CD5;&#x6811;"> # </a></h2>
<p>src\traverse.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> { parser } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./parser&apos;</span>);
<span class="hljs-keyword">const</span> replace = <span class="hljs-function">(<span class="hljs-params">parent,oldNode,newNode</span>)=&gt;</span>{
    <span class="hljs-keyword">if</span>(parent){
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> parent) {
            <span class="hljs-keyword">if</span> (parent.hasOwnProperty(key)) {
                <span class="hljs-keyword">if</span>(parent[key] === oldNode){
                    parent[key] = newNode;
                }
            }
        }
    }
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">ast, visitor</span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverseArray</span>(<span class="hljs-params">array, parent</span>) </span>{
        array.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">child</span>) </span>{
            traverseNode(child, parent);
        });
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverseNode</span>(<span class="hljs-params">node, parent</span>) </span>{
        <span class="hljs-keyword">let</span> replaceWith  = replace.bind(node,parent,node);
        <span class="hljs-keyword">var</span> method = visitor[node.type];
        <span class="hljs-keyword">if</span> (method) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> method === <span class="hljs-string">&apos;function&apos;</span>) {
                method({node,replaceWith}, parent)
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.enter) {
                method.enter({node,replaceWith}, parent);
            }
        }
        <span class="hljs-keyword">switch</span> (node.type) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;Program&apos;</span>:
                traverseArray(node.body, node);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;ExpressionStatement&apos;</span>: <span class="hljs-comment">// &#x8868;&#x8FBE;&#x5F0F;</span>
                traverseNode(node.expression, node);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-comment">// JSX&#x6807;&#x7B7E;&#x7684;&#x904D;&#x5386;</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;JSXElement&apos;</span>: <span class="hljs-comment">// JSX&#x6807;&#x7B7E;</span>
                traverseNode(node.openingElement, node);
                traverseNode(node.closingElement, node);
                traverseArray(node.children, node);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;JSXOpeningElement&apos;</span>: <span class="hljs-comment">// &#x5F00;&#x6807;&#x7B7E;</span>
                traverseNode(node.name, node); <span class="hljs-comment">// &#x6807;&#x7B7E;&#x540D;</span>
                traverseArray(node.attributes, node);
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;JSXAttribute&apos;</span>: <span class="hljs-comment">// &#x5C5E;&#x6027;</span>
                traverseNode(node.name, node); <span class="hljs-comment">// &#x5C5E;&#x6027;&#x540D;</span>
                traverseNode(node.value, node); <span class="hljs-comment">// &#x5C5E;&#x6027;&#x503C;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;JSXClosingElement&apos;</span>: <span class="hljs-comment">// &#x95ED;&#x5408;&#x6807;&#x7B7E;</span>
                traverseNode(node.name, node); <span class="hljs-comment">// &#x6807;&#x7B7E;&#x540D;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;JSXIdentifier&apos;</span>: <span class="hljs-comment">// &#x5C5E;&#x6027;&#x540D;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;StringLiteral&apos;</span>: <span class="hljs-comment">// &#x5B57;&#x7B26;&#x4E32;&#x5C5E;&#x6027;&#x503C;&#xFF0C;&#x5B57;&#x7B26;&#x4E32;&#x53C2;&#x6570;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;JSXText&apos;</span>: <span class="hljs-comment">// &#x6587;&#x672C;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-comment">// ============React.createElement&#x7684;&#x904D;&#x5386;================</span>
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;CallExpression&apos;</span>:
                traverseNode(node.callee, node); <span class="hljs-comment">// &#x6210;&#x5458;&#x8868;&#x8FBE;&#x5F0F;</span>
                traverseArray(node.arguments, node); <span class="hljs-comment">// &#x53C2;&#x6570;&#x5217;&#x8868;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;MemberExpression&apos;</span>:
                traverseNode(node.object, node); <span class="hljs-comment">// &#xFF08;&#x6210;&#x5458;&#xFF09;&#x5BF9;&#x8C61;</span>
                traverseNode(node.property, node); <span class="hljs-comment">// &#xFF08;&#x6210;&#x5458;&#xFF09;&#x5BF9;&#x8C61;&#x5C5E;&#x6027;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;Identifier&apos;</span>: <span class="hljs-comment">// &quot;&#x53D8;&#x91CF;&quot;&#x540D;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;ObjectExpression&apos;</span>: <span class="hljs-comment">// &#x5BF9;&#x8C61;&#x6570;&#x7EC4;</span>
                traverseArray(node.properties, node); <span class="hljs-comment">// &#x5BF9;&#x8C61;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;ObjectProperty&apos;</span>: <span class="hljs-comment">// &#x5BF9;&#x8C61;&#x5C5E;&#x6027;</span>
                traverseNode(node.key, node); <span class="hljs-comment">// &#x5BF9;&#x8C61;&#x5C5E;&#x6027;&#x540D;</span>
                traverseNode(node.value, node); <span class="hljs-comment">// &#x5BF9;&#x8C61;&#x5C5E;&#x6027;&#x503C;</span>
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&apos;NullLiteral&apos;</span>:
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(node.type);
        }
        <span class="hljs-keyword">if</span> (method &amp;&amp; method.exit) {
            method.exit({node,replaceWith}, parent);
        }
    }

    <span class="hljs-comment">// &#x5F00;&#x59CB;&#x904D;&#x5386;ast</span>
    traverseNode(ast, <span class="hljs-literal">null</span>);
}

<span class="hljs-built_in">module</span>.exports = {
    traverse
};


<span class="hljs-comment">/* let code = &apos;&lt;h1 id=&quot;title&quot;&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;&apos;;
let ast = parser(code);
traverse(ast, {
    JSXOpeningElement: {
        enter: function (node, parent) {
            console.log(&apos;&#x8FDB;&#x5165;&#x5F00;&#x6807;&#x7B7E;&apos;, node);
        },
        exit: function (node, parent) {
            console.log(&apos;&#x9000;&#x51FA;&#x5F00;&#x6807;&#x7B7E;&apos;, node);
        }
    }
}) */</span>
</code></pre>
<h2 id="t478. &#x8F6C;&#x6362;&#x5668;">8. &#x8F6C;&#x6362;&#x5668; <a href="#t478. &#x8F6C;&#x6362;&#x5668;"> # </a></h2>
<p>src\transformer.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> { traverse } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./traverse&apos;</span>);
<span class="hljs-keyword">const</span> { parser } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./parser&apos;</span>);
<span class="hljs-keyword">const</span> nodeTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./nodeTypes&apos;</span>);
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">t</span> </span>{
    <span class="hljs-keyword">static</span> nullLiteral() {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: nodeTypes.NullLiteral
        }
    }

    <span class="hljs-keyword">static</span> memberExpression(object, property) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: nodeTypes.MemberExpression,
            object,
            property
        }
    }

    <span class="hljs-keyword">static</span> identifier(name) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: nodeTypes.Identifier,
            name
        }
    }

    <span class="hljs-keyword">static</span> stringLiteral(value) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: nodeTypes.StringLiteral,
            value
        }
    }

    <span class="hljs-keyword">static</span> objectExpression(properties) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: nodeTypes.ObjectExpression,
            properties
        }
    }

    <span class="hljs-keyword">static</span> objectProperty(key, value) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: nodeTypes.ObjectProperty,
            key,
            value
        }
    }

    <span class="hljs-keyword">static</span> callExpression(callee, _arguments) {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">type</span>: nodeTypes.CallExpression,
            callee,
            <span class="hljs-attr">arguments</span>: _arguments
        }
    }

    <span class="hljs-keyword">static</span> isJSXText(node) {
        <span class="hljs-keyword">return</span> node.type ===nodeTypes.JSXText
    }

    <span class="hljs-keyword">static</span> isJSXElement(node) {
        <span class="hljs-keyword">return</span> node.type === nodeTypes.JSXElement;
    }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformer</span>(<span class="hljs-params">ast</span>) </span>{
    traverse(ast, {
        JSXElement(nodePath) {
            <span class="hljs-keyword">const</span> transform = <span class="hljs-function">(<span class="hljs-params">node</span>) =&gt;</span> {<span class="hljs-keyword">debugger</span>
                <span class="hljs-keyword">if</span> (!node) <span class="hljs-keyword">return</span> t.nullLiteral();
                <span class="hljs-comment">// JSX &#x6807;&#x7B7E;&#x8282;&#x70B9;</span>
                <span class="hljs-keyword">if</span> (t.isJSXElement(node)) {
                    <span class="hljs-comment">// React.createElement&#x51FD;&#x6570;</span>
                    <span class="hljs-keyword">let</span> memberExpression = t.memberExpression(
                        t.identifier(<span class="hljs-string">&quot;React&quot;</span>),
                        t.identifier(<span class="hljs-string">&quot;createElement&quot;</span>)
                    );
                    <span class="hljs-comment">// &#x51FD;&#x6570;&#x53C2;&#x6570;&#x5217;&#x8868;</span>
                    <span class="hljs-keyword">let</span> _arguments = [];
                    <span class="hljs-comment">// &#x6807;&#x7B7E;</span>
                    <span class="hljs-keyword">let</span> stringLiteral = t.stringLiteral(node.openingElement.name.name);
                    <span class="hljs-comment">// &#x5C5E;&#x6027;</span>
                    <span class="hljs-keyword">let</span> objectExpression = node.openingElement.attributes.length
                        ? t.objectExpression(
                            node.openingElement.attributes.map(<span class="hljs-function">(<span class="hljs-params">attr</span>) =&gt;</span>
                                t.objectProperty(t.identifier(attr.name.name), attr.value)
                            )
                        )
                        : t.nullLiteral();
                    _arguments = [stringLiteral, objectExpression];
                    <span class="hljs-comment">// &#x9012;&#x5F52;&#x5904;&#x7406;&#x5B50;&#x8282;&#x70B9;</span>
                    _arguments.push(...node.children.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> transform(item)));
                    <span class="hljs-keyword">return</span> t.callExpression(memberExpression, _arguments);
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (t.isJSXText(node)) {
                    <span class="hljs-comment">// JSX &#x6587;&#x672C;&#x8282;&#x70B9;</span>
                    <span class="hljs-keyword">return</span> t.stringLiteral(node.value);
                }
            };
            <span class="hljs-keyword">let</span> targetNode = transform(nodePath.node);
            nodePath.replaceWith(targetNode);
        },
    });
}

<span class="hljs-built_in">module</span>.exports = {
    transformer
}


<span class="hljs-comment">/* let code = &apos;&lt;h1 id=&quot;title&quot;&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;&apos;;
let ast = parser(code);
transformer(ast);
console.log(JSON.stringify(ast, null, 2)); */</span>
</code></pre>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Program&quot;</span>,
  <span class="hljs-attr">&quot;body&quot;</span>: [
    {
      <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;ExpressionStatement&quot;</span>,
      <span class="hljs-attr">&quot;expression&quot;</span>: {
        <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;CallExpression&quot;</span>,
        <span class="hljs-attr">&quot;callee&quot;</span>: {
          <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;MemberExpression&quot;</span>,
          <span class="hljs-attr">&quot;object&quot;</span>: {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Identifier&quot;</span>,
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;React&quot;</span>
          },
          <span class="hljs-attr">&quot;property&quot;</span>: {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Identifier&quot;</span>,
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;createElement&quot;</span>
          }
        },
        <span class="hljs-attr">&quot;arguments&quot;</span>: [
          {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringLiteral&quot;</span>,
            <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;h1&quot;</span>
          },
          {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;ObjectExpression&quot;</span>,
            <span class="hljs-attr">&quot;properties&quot;</span>: [
              {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;ObjectProperty&quot;</span>,
                <span class="hljs-attr">&quot;key&quot;</span>: {
                  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Identifier&quot;</span>,
                  <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;id&quot;</span>
                },
                <span class="hljs-attr">&quot;value&quot;</span>: {
                  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringLiteral&quot;</span>,
                  <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;title&quot;</span>
                }
              }
            ]
          },
          {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;CallExpression&quot;</span>,
            <span class="hljs-attr">&quot;callee&quot;</span>: {
              <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;MemberExpression&quot;</span>,
              <span class="hljs-attr">&quot;object&quot;</span>: {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Identifier&quot;</span>,
                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;React&quot;</span>
              },
              <span class="hljs-attr">&quot;property&quot;</span>: {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;Identifier&quot;</span>,
                <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;createElement&quot;</span>
              }
            },
            <span class="hljs-attr">&quot;arguments&quot;</span>: [
              {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringLiteral&quot;</span>,
                <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;span&quot;</span>
              },
              {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;NullLiteral&quot;</span>
              },
              {
                <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringLiteral&quot;</span>,
                <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;hello&quot;</span>
              }
            ]
          },
          {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;StringLiteral&quot;</span>,
            <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-string">&quot;world&quot;</span>
          }
        ]
      }
    }
  ]
}
</code></pre>
<h2 id="t489. &#x751F;&#x6210;&#x5668;">9. &#x751F;&#x6210;&#x5668; <a href="#t489. &#x751F;&#x6210;&#x5668;"> # </a></h2>
<ul>
<li>&#x5148;&#x5E8F;&#x904D;&#x5386;&#x62BD;&#x8C61;&#x8BED;&#x6CD5;&#x6811;&#xFF0C;&#x5C06;&#x7279;&#x5B9A;&#x7684;&#x8282;&#x70B9;&#x7C7B;&#x578B;&#x8F6C;&#x6362;&#x6210;&#x5BF9;&#x5E94;&#x7684;js&#x4EE3;&#x7801;&#x5373;&#x53EF;</li>
</ul>
<p>src\codeGenerator.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> nodeTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./nodeTypes&apos;</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">codeGenerator</span>(<span class="hljs-params">node</span>) </span>{
    <span class="hljs-keyword">switch</span> (node.type) {
        <span class="hljs-keyword">case</span> nodeTypes.Program:
            <span class="hljs-keyword">return</span> node.body.map(codeGenerator).join(<span class="hljs-string">&apos;\n&apos;</span>);
        <span class="hljs-keyword">case</span> nodeTypes.ExpressionStatement:
            <span class="hljs-keyword">return</span> (
                codeGenerator(node.expression) + <span class="hljs-string">&apos;;&apos;</span>
            );

        <span class="hljs-keyword">case</span> nodeTypes.MemberExpression:
            <span class="hljs-keyword">return</span> (
                codeGenerator(node.object) +
                <span class="hljs-string">&apos;.&apos;</span> +
                codeGenerator(node.property)
            )

        <span class="hljs-keyword">case</span> nodeTypes.ObjectExpression:
            <span class="hljs-keyword">return</span> (
                <span class="hljs-string">&apos;{&apos;</span> +
                node.properties.map(codeGenerator).join(<span class="hljs-string">&apos;, &apos;</span>) +
                <span class="hljs-string">&apos;}&apos;</span>
            )

        <span class="hljs-keyword">case</span> nodeTypes.ObjectProperty:
            <span class="hljs-keyword">return</span> (
                codeGenerator(node.key) +
                <span class="hljs-string">&apos;:&apos;</span> +
                codeGenerator(node.value)
            )

        <span class="hljs-keyword">case</span> nodeTypes.CallExpression:
            <span class="hljs-keyword">return</span> (
                codeGenerator(node.callee) +
                <span class="hljs-string">&apos;(&apos;</span> +
                node.arguments.map(codeGenerator).join(<span class="hljs-string">&apos;, &apos;</span>) +
                <span class="hljs-string">&apos;)&apos;</span>
            );

        <span class="hljs-keyword">case</span> nodeTypes.Identifier:
            <span class="hljs-keyword">return</span> node.name;

        <span class="hljs-keyword">case</span> nodeTypes.NumberLiteral:
            <span class="hljs-keyword">return</span> node.value;

        <span class="hljs-keyword">case</span> nodeTypes.StringLiteral:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&apos;&quot;&apos;</span> + node.value + <span class="hljs-string">&apos;&quot;&apos;</span>;

        <span class="hljs-keyword">case</span> nodeTypes.NullLiteral:
            <span class="hljs-keyword">return</span> <span class="hljs-string">&apos;null&apos;</span>

        <span class="hljs-attr">default</span>:
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(node.type);
    }
}

<span class="hljs-built_in">module</span>.exports = {
    codeGenerator
}
</code></pre>
<p>src\index.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> { parser } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./parser&apos;</span>);
<span class="hljs-keyword">const</span> { transformer } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./transformer&apos;</span>);
<span class="hljs-keyword">const</span> { codeGenerator } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./codeGenerator&apos;</span>);
<span class="hljs-keyword">let</span> code = <span class="hljs-string">&apos;&lt;h1 id=&quot;title&quot;&gt;&lt;span&gt;hello&lt;/span&gt;world&lt;/h1&gt;&apos;</span>;
<span class="hljs-keyword">let</span> ast = parser(code);
transformer(ast);
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">JSON</span>.stringify(ast, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>)); 
<span class="hljs-keyword">let</span> result = codeGenerator(ast);
<span class="hljs-built_in">console</span>.log(result);
</code></pre>

    </div>
</div>
<div class="modal fade" id="loginModal" tabindex="-1" role="dialog"
    aria-labelledby="loginModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                    aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="loginModalLabel">请登录</h4>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="username" class="control-label">姓名:</label>
                        <input type="text" class="form-control" id="username" placeholder="珠峰架构VIP会员系统用户名">
                    </div>
                    <div class="form-group">
                        <label for="password" class="control-label">密码:</label>
                        <input type="text" class="form-control" id="password" placeholder="珠峰架构VIP会员系统密码">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                    data-dismiss="modal">登录</button>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script src="../static/bootstrap/bootstrap.min.js"></script>
<script>
$('.warpper .page-toc ul ul li a').on('click',function(){
  $('.warpper .page-toc ul ul li a').removeClass('my-active')
  $(this).addClass('my-active')
})
$('.logo').on('mouseenter',function(){
  $('.nav').height('450px');
})
$('.nav').on('mouseleave',function(){
  $('.nav').height('80px');
})
$('.logo').on('click',function(){
  // $(".nav").css("display", "none");
 $('.warpper').css('padding','0px');
})
</script><script type="text/javascript" src="../static/js/theme.js"></script>
</body>
</html>
