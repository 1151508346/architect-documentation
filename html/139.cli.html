<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>架构师成长计划</title>
    <link rel="stylesheet" type="text/css" href="../static/css/main.css">
    <link rel="stylesheet" href="../static/bootstrap/bootstrap.min.css" >
    <style>
        .page-toc > ul .red {
            background: #f3f3f3;
            z-index: 1;
            border-left: 3px solid #009a61;
            -webkit-transition: all .2s ease;
            transition: all .2s ease;
            color: #000
        }
    </style>
</head>
<body>
<div class="nav">
  <div class="logo">架构师成长计划</div>
  <ul>
    <li><a href="../index.html">0.api</a></li>
    <li><a href="../html/0.Async.html">0.Async</a></li>
    <li><a href="../html/0.module.html">0.module</a></li>
    <li><a href="../html/1.ES2015.html">1.ES2015</a></li>
    <li><a href="../html/2.Promise.html">2.Promise</a></li>
    <li><a href="../html/3.Node.html">3.Node</a></li>
    <li><a href="../html/4.NodeInstall.html">4.NodeInstall</a></li>
    <li><a href="../html/5.REPL.html">5.REPL</a></li>
    <li><a href="../html/6.NodeCore.html">6.NodeCore</a></li>
    <li><a href="../html/7.module&NPM.html">7.module&NPM</a></li>
    <li><a href="../html/8.Encoding.html">8.Encoding</a></li>
    <li><a href="../html/9.Buffer.html">9.Buffer</a></li>
    <li><a href="../html/10.fs.html">10.fs</a></li>
    <li><a href="../html/11.Stream-1.html">11.Stream-1</a></li>
    <li><a href="../html/11.Stream-2.html">11.Stream-2</a></li>
    <li><a href="../html/11.Stream-3.html">11.Stream-3</a></li>
    <li><a href="../html/11.Stream-4.html">11.Stream-4</a></li>
    <li><a href="../html/12-Network-2.html">12-Network-2</a></li>
    <li><a href="../html/12.NetWork-3.html">12.NetWork-3</a></li>
    <li><a href="../html/12.Network-1.html">12.Network-1</a></li>
    <li><a href="../html/13.tcp.html">13.tcp</a></li>
    <li><a href="../html/14.http-1.html">14.http-1</a></li>
    <li><a href="../html/14.http-2.html">14.http-2</a></li>
    <li><a href="../html/15.compress.html">15.compress</a></li>
    <li><a href="../html/16.crypto.html">16.crypto</a></li>
    <li><a href="../html/17.process.html">17.process</a></li>
    <li><a href="../html/18.yargs.html">18.yargs</a></li>
    <li><a href="../html/19.cache.html">19.cache</a></li>
    <li><a href="../html/20.action.html">20.action</a></li>
    <li><a href="../html/21.https.html">21.https</a></li>
    <li><a href="../html/22.cookie.html">22.cookie</a></li>
    <li><a href="../html/23.session.html">23.session</a></li>
    <li><a href="../html/24.express-1.html">24.express-1</a></li>
    <li><a href="../html/24.express-2.html">24.express-2</a></li>
    <li><a href="../html/24.express-3.html">24.express-3</a></li>
    <li><a href="../html/24.express-4.html">24.express-4</a></li>
    <li><a href="../html/25.koa-1.html">25.koa-1</a></li>
    <li><a href="../html/26.webpack-1-basic.html">26.webpack-1-basic</a></li>
    <li>
      <a href="../html/26.webpack-2-optimize.html">26.webpack-2-optimize</a>
    </li>
    <li><a href="../html/26.webpack-3-file.html">26.webpack-3-file</a></li>
    <li>
      <a href="../html/26.webpack-4.tapable.html">26.webpack-4.tapable</a>
    </li>
    <li><a href="../html/26.webpack-5-AST.html">26.webpack-5-AST</a></li>
    <li>
      <a href="../html/26.webpack-6-sources.html">26.webpack-6-sources</a>
    </li>
    <li><a href="../html/26.webpack-7-loader.html">26.webpack-7-loader</a></li>
    <li><a href="../html/26.webpack-8-plugin.html">26.webpack-8-plugin</a></li>
    <li><a href="../html/26.webpack-9-hand.html">26.webpack-9-hand</a></li>
    <li>
      <a href="../html/26.webpack-10-prepare.html">26.webpack-10-prepare</a>
    </li>
    <li><a href="../html/28.redux.html">28.redux</a></li>
    <li><a href="../html/28.redux-jwt-back.html">28.redux-jwt-back</a></li>
    <li><a href="../html/28.redux-jwt-front.html">28.redux-jwt-front</a></li>
    <li><a href="../html/29.mongodb-1.html">29.mongodb-1</a></li>
    <li><a href="../html/29.mongodb-2.html">29.mongodb-2</a></li>
    <li><a href="../html/29.mongodb-3.html">29.mongodb-3</a></li>
    <li><a href="../html/29.mongodb-4.html">29.mongodb-4</a></li>
    <li><a href="../html/29.mongodb-5.html">29.mongodb-5</a></li>
    <li><a href="../html/29.mongodb-6.html">29.mongodb-6</a></li>
    <li><a href="../html/30.cms-1-mysql.html">30.cms-1-mysql</a></li>
    <li><a href="../html/30.cms-2-mysql.html">30.cms-2-mysql</a></li>
    <li><a href="../html/30.cms-3-mysql.html">30.cms-3-mysql</a></li>
    <li><a href="../html/30.cms-4-nunjucks.html">30.cms-4-nunjucks</a></li>
    <li><a href="../html/30.cms-5-mock.html">30.cms-5-mock</a></li>
    <li><a href="../html/30.cms-6-egg.html">30.cms-6-egg</a></li>
    <li><a href="../html/30.cms-7-api.html">30.cms-7-api</a></li>
    <li><a href="../html/30.cms-8-roadhog.html">30.cms-8-roadhog</a></li>
    <li><a href="../html/30.cms-9-yaml.html">30.cms-9-yaml</a></li>
    <li><a href="../html/30.cms-10-umi.html">30.cms-10-umi</a></li>
    <li><a href="../html/30.cms-12-dva.html">30.cms-12-dva</a></li>
    <li><a href="../html/30.cms-13-dva-ant.html">30.cms-13-dva-ant</a></li>
    <li><a href="../html/30.cms-14-front.html">30.cms-14-front</a></li>
    <li><a href="../html/30.cms-15-deploy.html">30.cms-15-deploy</a></li>
    <li><a href="../html/31.dva.html">31.dva</a></li>
    <li>
      <a href="../html/31.cms-13-dva-antdesign.html">31.cms-13-dva-antdesign</a>
    </li>
    <li><a href="../html/33.redis.html">33.redis</a></li>
    <li><a href="../html/34.unittest.html">34.unittest</a></li>
    <li><a href="../html/35.jwt.html">35.jwt</a></li>
    <li><a href="../html/36.websocket-1.html">36.websocket-1</a></li>
    <li><a href="../html/36.websocket-2.html">36.websocket-2</a></li>
    <li><a href="../html/38.chat-api-1.html">38.chat-api-1</a></li>
    <li><a href="../html/38.chat-api-2.html">38.chat-api-2</a></li>
    <li><a href="../html/38.chat-3.html">38.chat-3</a></li>
    <li><a href="../html/38.chat-api-3.html">38.chat-api-3</a></li>
    <li><a href="../html/38.chat.html">38.chat</a></li>
    <li><a href="../html/38.chat2.html">38.chat2</a></li>
    <li><a href="../html/38.chat2.html">38.chat2</a></li>
    <li><a href="../html/39.crawl-0.html">39.crawl-0</a></li>
    <li><a href="../html/39.crawl-1.html">39.crawl-1</a></li>
    <li><a href="../html/39.crawl-2.html">39.crawl-2</a></li>
    <li><a href="../html/40.deploy.html">40.deploy</a></li>
    <li><a href="../html/41.safe.html">41.safe</a></li>
    <li><a href="../html/42.test.html">42.test</a></li>
    <li><a href="../html/43.nginx.html">43.nginx</a></li>
    <li><a href="../html/44.enzyme.html">44.enzyme</a></li>
    <li><a href="../html/45.docker.html">45.docker</a></li>
    <li><a href="../html/46.elastic.html">46.elastic</a></li>
    <li><a href="../html/47.oauth.html">47.oauth</a></li>
    <li><a href="../html/48.wxpay.html">48.wxpay</a></li>
    <li><a href="../html/index.html">index</a></li>
    <li><a href="../html/52.UML.html">52.UML</a></li>
    <li><a href="../html/53.design.html">53.design</a></li>
    <li><a href="../html/index.html">index</a></li>
    <li><a href="../html/54.linux.html">54.linux</a></li>
    <li><a href="../html/57.ts.html">57.ts</a></li>
    <li><a href="../html/56.react-ssr.html">56.react-ssr</a></li>
    <li><a href="../html/58.ts_react.html">58.ts_react</a></li>
    <li><a href="../html/59.ketang.html">59.ketang</a></li>
    <li><a href="../html/59.ketang2.html">59.ketang2</a></li>
    <li><a href="../html/61.1.devops-linux.html">61.1.devops-linux</a></li>
    <li><a href="../html/61.2.devops-vi.html">61.2.devops-vi</a></li>
    <li><a href="../html/61.3.devops-user.html">61.3.devops-user</a></li>
    <li><a href="../html/61.4.devops-auth.html">61.4.devops-auth</a></li>
    <li><a href="../html/61.5.devops-shell.html">61.5.devops-shell</a></li>
    <li><a href="../html/61.6.devops-install.html">61.6.devops-install</a></li>
    <li><a href="../html/61.7.devops-system.html">61.7.devops-system</a></li>
    <li><a href="../html/61.8.devops-service.html">61.8.devops-service</a></li>
    <li><a href="../html/61.9.devops-network.html">61.9.devops-network</a></li>
    <li><a href="../html/61.10.devops-nginx.html">61.10.devops-nginx</a></li>
    <li><a href="../html/61.11.devops-docker.html">61.11.devops-docker</a></li>
    <li><a href="../html/61.12.devops-jekins.html">61.12.devops-jekins</a></li>
    <li><a href="../html/61.13.devops-groovy.html">61.13.devops-groovy</a></li>
    <li><a href="../html/61.14.devops-php.html">61.14.devops-php</a></li>
    <li><a href="../html/61.15.devops-java.html">61.15.devops-java</a></li>
    <li><a href="../html/61.16.devops-node.html">61.16.devops-node</a></li>
    <li><a href="../html/61.17.devops-k8s.html">61.17.devops-k8s</a></li>
    <li><a href="../html/62.1.react-basic.html">62.1.react-basic</a></li>
    <li><a href="../html/62.2.react-state.html">62.2.react-state</a></li>
    <li><a href="../html/62.3.react-high.html">62.3.react-high</a></li>
    <li><a href="../html/62.4.react-optimize.html">62.4.react-optimize</a></li>
    <li><a href="../html/62.5.react-hooks.html">62.5.react-hooks</a></li>
    <li>
      <a href="../html/62.6.react-immutable.html">62.6.react-immutable</a>
    </li>
    <li><a href="../html/62.7.react-mobx.html">62.7.react-mobx</a></li>
    <li><a href="../html/62.8.react-source.html">62.8.react-source</a></li>
    <li><a href="../html/63.1.redux.html">63.1.redux</a></li>
    <li>
      <a href="../html/63.2.redux-middleware.html">63.2.redux-middleware</a>
    </li>
    <li><a href="../html/63.3.redux-hooks.html">63.3.redux-hooks</a></li>
    <li><a href="../html/63.4.redux-saga.html">63.4.redux-saga</a></li>
    <li>
      <a href="../html/63.5.redux-saga-hand.html">63.5.redux-saga-hand</a>
    </li>
    <li><a href="../html/64.1.router.html">64.1.router</a></li>
    <li>
      <a href="../html/64.2.router-connected.html">64.2.router-connected</a>
    </li>
    <li><a href="../html/65.1.typescript.html">65.1.typescript</a></li>
    <li><a href="../html/65.2.typescript.html">65.2.typescript</a></li>
    <li><a href="../html/65.3.typescript.html">65.3.typescript</a></li>
    <li><a href="../html/65.4.antd.html">65.4.antd</a></li>
    <li><a href="../html/65.4.definition.html">65.4.definition</a></li>
    <li><a href="../html/66-1.vue-base.html">66-1.vue-base</a></li>
    <li><a href="../html/66-2.vue-component.html">66-2.vue-component</a></li>
    <li><a href="../html/66-3.vue-cli3.0.html">66-3.vue-cli3.0</a></li>
    <li><a href="../html/66-4.$message组件.html">66-4.$message组件</a></li>
    <li><a href="../html/66-5.Form组件.html">66-5.Form组件</a></li>
    <li><a href="../html/66-6.tree.html">66-6.tree</a></li>
    <li>
      <a href="../html/66-7.vue-router-apply.html">66-7.vue-router-apply</a>
    </li>
    <li><a href="../html/66-8.axios-apply.html">66-8.axios-apply</a></li>
    <li><a href="../html/66-9.vuex-apply.html">66-9.vuex-apply</a></li>
    <li><a href="../html/66-10.jwt-vue.html">66-10.jwt-vue</a></li>
    <li><a href="../html/66-11.vue-ssr.html">66-11.vue-ssr</a></li>
    <li><a href="../html/66-12.nuxt-apply.html">66-12.nuxt-apply</a></li>
    <li><a href="../html/66-13.pwa.html">66-13.pwa</a></li>
    <li><a href="../html/66-14.vue单元测试.html">66-14.vue单元测试</a></li>
    <li><a href="../html/66-15.权限校验.html">66-15.权限校验</a></li>
    <li><a href="../html/67-1-network.html">67-1-network</a></li>
    <li><a href="../html/68-2-wireshark.html">68-2-wireshark</a></li>
    <li><a href="../html/7.npm2.html">7.npm2</a></li>
    <li><a href="../html/69-hooks.html">69-hooks</a></li>
    <li><a href="../html/70-deploy.html">70-deploy</a></li>
    <li><a href="../html/71-hmr.html">71-hmr</a></li>
    <li><a href="../html/72.deploy.html">72.deploy</a></li>
    <li><a href="../html/73.import.html">73.import</a></li>
    <li><a href="../html/74.mobile.html">74.mobile</a></li>
    <li>
      <a href="../html/75.webpack-1.文件分析.html">75.webpack-1.文件分析</a>
    </li>
    <li><a href="../html/75.webpack-2.loader.html">75.webpack-2.loader</a></li>
    <li>
      <a href="../html/75.webpack-3.源码流程.html">75.webpack-3.源码流程</a>
    </li>
    <li>
      <a href="../html/75.webpack-4.tapable.html">75.webpack-4.tapable</a>
    </li>
    <li>
      <a href="../html/75.webpack-5.prepare.html">75.webpack-5.prepare</a>
    </li>
    <li>
      <a href="../html/75.webpack-6.resolve.html">75.webpack-6.resolve</a>
    </li>
    <li><a href="../html/75.webpack-7.loader.html">75.webpack-7.loader</a></li>
    <li><a href="../html/75.webpack-8.module.html">75.webpack-8.module</a></li>
    <li><a href="../html/75.webpack-9.chunk.html">75.webpack-9.chunk</a></li>
    <li><a href="../html/75.webpack-10.asset.html">75.webpack-10.asset</a></li>
    <li><a href="../html/75.webpack-11.实现.html">75.webpack-11.实现</a></li>
    <li><a href="../html/76.react_optimize.html">76.react_optimize</a></li>
    <li><a href="../html/77.ts_ketang_back.html">77.ts_ketang_back</a></li>
    <li><a href="../html/77.ts_ketang_front.html">77.ts_ketang_front</a></li>
    <li><a href="../html/78.vue-domdiff.html">78.vue-domdiff</a></li>
    <li><a href="../html/79.grammar.html">79.grammar</a></li>
    <li><a href="../html/80.tree.html">80.tree</a></li>
    <li><a href="../html/81.axios.html">81.axios</a></li>
    <li><a href="../html/82.1.react.html">82.1.react</a></li>
    <li><a href="../html/82.2.react-high.html">82.2.react-high</a></li>
    <li><a href="../html/82.3.react-router.html">82.3.react-router</a></li>
    <li><a href="../html/82.4.redux.html">82.4.redux</a></li>
    <li>
      <a href="../html/82.5.redux_middleware.html">82.5.redux_middleware</a>
    </li>
    <li><a href="../html/82.6.connected.html">82.6.connected</a></li>
    <li><a href="../html/82.7.saga.html">82.7.saga</a></li>
    <li><a href="../html/82.8.dva.html">82.8.dva</a></li>
    <li><a href="../html/82.8.dva-source.html">82.8.dva-source</a></li>
    <li><a href="../html/82.9.roadhog.html">82.9.roadhog</a></li>
    <li><a href="../html/82.10.umi.html">82.10.umi</a></li>
    <li><a href="../html/82.11.antdesign.html">82.11.antdesign</a></li>
    <li><a href="../html/82.12.ketang-front.html">82.12.ketang-front</a></li>
    <li><a href="../html/82.12.ketang-back.html">82.12.ketang-back</a></li>
    <li><a href="../html/83.upload.html">83.upload</a></li>
    <li><a href="../html/84.graphql.html">84.graphql</a></li>
    <li><a href="../html/85.antpro.html">85.antpro</a></li>
    <li><a href="../html/86.1.uml.html">86.1.uml</a></li>
    <li><a href="../html/86.2.design.html">86.2.design</a></li>
    <li><a href="../html/87.postcss.html">87.postcss</a></li>
    <li><a href="../html/88.react16-1.html">88.react16-1</a></li>
    <li><a href="../html/89.nextjs.html">89.nextjs</a></li>
    <li><a href="../html/90.react-test.html">90.react-test</a></li>
    <li><a href="../html/91.react-ts.html">91.react-ts</a></li>
    <li><a href="../html/92.rbac.html">92.rbac</a></li>
    <li><a href="../html/93.tsnode.html">93.tsnode</a></li>
    <li><a href="../html/94.1.JavaScript.html">94.1.JavaScript</a></li>
    <li><a href="../html/94.2.JavaScript.html">94.2.JavaScript</a></li>
    <li><a href="../html/94.3.MODULE.html">94.3.MODULE</a></li>
    <li><a href="../html/94.4.EventLoop.html">94.4.EventLoop</a></li>
    <li><a href="../html/94.5.文件上传.html">94.5.文件上传</a></li>
    <li><a href="../html/94.6.https.html">94.6.https</a></li>
    <li><a href="../html/94.7. nginx.html">94.7. nginx</a></li>
    <li><a href="../html/95.1. react.html">95.1. react</a></li>
    <li><a href="../html/95.2.react.html">95.2.react</a></li>
    <li><a href="../html/96.1.react16.html">96.1.react16</a></li>
    <li><a href="../html/96.2.fiber.html">96.2.fiber</a></li>
    <li><a href="../html/96.3.fiber.html">96.3.fiber</a></li>
    <li><a href="../html/97.serverless.html">97.serverless</a></li>
    <li><a href="../html/98.websocket.html">98.websocket</a></li>
    <li><a href="../html/100.1.react-basic.html">100.1.react-basic</a></li>
    <li><a href="../html/101.1.monitor.html">101.1.monitor</a></li>
    <li><a href="../html/101.2.monitor.html">101.2.monitor</a></li>
    <li><a href="../html/102.java.html">102.java</a></li>
    <li><a href="../html/103.1.webpack-usage.html">103.1.webpack-usage</a></li>
    <li>
      <a href="../html/103.2.webpack-bundle.html">103.2.webpack-bundle</a>
    </li>
    <li><a href="../html/103.3.webpack-ast.html">103.3.webpack-ast</a></li>
    <li><a href="../html/103.4.webpack-flow.html">103.4.webpack-flow</a></li>
    <li>
      <a href="../html/103.5.webpack-loader.html">103.5.webpack-loader</a>
    </li>
    <li>
      <a href="../html/103.6.webpack-tapable.html">103.6.webpack-tapable</a>
    </li>
    <li>
      <a href="../html/103.7.webpack-plugin.html">103.7.webpack-plugin</a>
    </li>
    <li>
      <a href="../html/103.8.webpack-optimize1.html">103.8.webpack-optimize1</a>
    </li>
    <li>
      <a href="../html/103.9.webpack-optimize2.html">103.9.webpack-optimize2</a>
    </li>
    <li><a href="../html/103.10.webpack-hand.html">103.10.webpack-hand</a></li>
    <li><a href="../html/103.11.webpack-hmr.html">103.11.webpack-hmr</a></li>
    <li><a href="../html/103.13.splitChunks.html">103.13.splitChunks</a></li>
    <li>
      <a href="../html/103.14.webpack-sourcemap.html"
        >103.14.webpack-sourcemap</a
      >
    </li>
    <li>
      <a href="../html/103.15.webpack-compiler1.html"
        >103.15.webpack-compiler1</a
      >
    </li>
    <li>
      <a href="../html/103.15.webpack-compiler2.html"
        >103.15.webpack-compiler2</a
      >
    </li>
    <li><a href="../html/103.16.vite.basic.html">103.16.vite.basic</a></li>
    <li><a href="../html/103.16.vite.source.html">103.16.vite.source</a></li>
    <li><a href="../html/103.17.polyfill.html">103.17.polyfill</a></li>
    <li><a href="../html/104.1.binary.html">104.1.binary</a></li>
    <li><a href="../html/104.2.binary.html">104.2.binary</a></li>
    <li><a href="../html/105.skeleton.html">105.skeleton</a></li>
    <li><a href="../html/106.1.react.html">106.1.react</a></li>
    <li><a href="../html/106.2.react_hooks.html">106.2.react_hooks</a></li>
    <li><a href="../html/106.3.react_router.html">106.3.react_router</a></li>
    <li><a href="../html/106.4.redux.html">106.4.redux</a></li>
    <li>
      <a href="../html/106.5.redux_middleware.html">106.5.redux_middleware</a>
    </li>
    <li>
      <a href="../html/106.6.connected-react-router.html"
        >106.6.connected-react-router</a
      >
    </li>
    <li>
      <a href="../html/106.6.redux-first-history.html">106.6.redux-first-history</a>
    </li>
    <li><a href="../html/106.7.redux-saga.html">106.7.redux-saga</a></li>
    <li><a href="../html/106.8.dva.html">106.8.dva</a></li>
    <li><a href="../html/106.9.umi.html">106.9.umi</a></li>
    <li><a href="../html/106.10.ketang.html">106.10.ketang</a></li>
    <li><a href="../html/106.11.antdesign.html">106.11.antdesign</a></li>
    <li><a href="../html/106.12.antpro.html">106.12.antpro</a></li>
    <li><a href="../html/106.13.router-6.html">106.13.router-6</a></li>
    <li><a href="../html/107.fiber.html">107.fiber</a></li>
    <li><a href="../html/108.http.html">108.http</a></li>
    <li><a href="../html/109.1.webpack_usage.html">109.1.webpack_usage</a></li>
    <li>
      <a href="../html/109.2.webpack_source.html">109.2.webpack_source</a>
    </li>
    <li><a href="../html/109.3.dll.html">109.3.dll</a></li>
    <li><a href="../html/110.nest.js.html">110.nest.js</a></li>
    <li><a href="../html/111.xstate.html">111.xstate</a></li>
    <li><a href="../html/112.Form.html">112.Form</a></li>
    <li><a href="../html/113.redux-saga.html">113.redux-saga</a></li>
    <li>
      <a href="../html/114.react+typescript.html">114.react+typescript</a>
    </li>
    <li><a href="../html/115.immer.html">115.immer</a></li>
    <li><a href="../html/116.pro5.html">116.pro5</a></li>
    <li><a href="../html/117.css-loader.html">117.css-loader</a></li>
    <li><a href="../html/118.1.umi-core.html">118.1.umi-core</a></li>
    <li>
      <a href="../html/119.2.module-federation.html">119.2.module-federation</a>
    </li>
    <li>
      <a href="../html/119.1.module-federation.html">119.1.module-federation</a>
    </li>
    <li>
      <a href="../html/120.create-react-app.html">120.create-react-app</a>
    </li>
    <li><a href="../html/121.react-scripts.html">121.react-scripts</a></li>
    <li><a href="../html/122.react-optimize.html">122.react-optimize</a></li>
    <li><a href="../html/123.jsx-runtime.html">123.jsx-runtime</a></li>
    <li><a href="../html/124.next.js.html">124.next.js</a></li>
    <li><a href="../html/125.1.linux.html">125.1.linux</a></li>
    <li><a href="../html/125.2.linux-vi.html">125.2.linux-vi</a></li>
    <li><a href="../html/125.3.linux-user.html">125.3.linux-user</a></li>
    <li><a href="../html/125.4.linux-auth.html">125.4.linux-auth</a></li>
    <li><a href="../html/125.5.linux-shell.html">125.5.linux-shell</a></li>
    <li><a href="../html/125.6.linux-install.html">125.6.linux-install</a></li>
    <li><a href="../html/125.7.linux-system.html">125.7.linux-system</a></li>
    <li><a href="../html/125.8.linux-service.html">125.8.linux-service</a></li>
    <li><a href="../html/125.9.linux-network.html">125.9.linux-network</a></li>
    <li><a href="../html/125.10.nginx.html">125.10.nginx</a></li>
    <li><a href="../html/125.11.docker.html">125.11.docker</a></li>
    <li><a href="../html/125.12.ci.html">125.12.ci</a></li>
    <li><a href="../html/125.13.k8s.html">125.13.k8s</a></li>
    <li><a href="../html/125.14.k8s.html">125.14.k8s</a></li>
    <li><a href="../html/125.15.k8s.html">125.15.k8s</a></li>
    <li><a href="../html/125.16.k8s.html">125.16.k8s</a></li>
    <li><a href="../html/126.11.react-1.html">126.11.react-1</a></li>
    <li><a href="../html/126.12.react-2.html">126.12.react-2</a></li>
    <li><a href="../html/126.12.react-3.html">126.12.react-3</a></li>
    <li><a href="../html/126.12.react-4.html">126.12.react-4</a></li>
    <li><a href="../html/126.12.react-5.html">126.12.react-5</a></li>
    <li><a href="../html/127.frontend.html">127.frontend</a></li>
    <li><a href="../html/128.rollup.html">128.rollup</a></li>
    <li><a href="../html/129.px2rem-loader.html">129.px2rem-loader</a></li>
    <li><a href="../html/130.health.html">130.health</a></li>
    <li><a href="../html/131.hooks.html">131.hooks</a></li>
    <li><a href="../html/132.keepalive.html">132.keepalive</a></li>
    <li><a href="../html/133.vue-cli.html">133.vue-cli</a></li>
    <li><a href="../html/134.react18.html">134.react18</a></li>
    <li><a href="../html/134.2.react18.html">134.2.react18</a></li>
    <li><a href="../html/134.3.react18.html">134.3.react18</a></li>
    <li><a href="../html/135.function.html">135.function</a></li>
    <li><a href="../html/136.toolkit.html">136.toolkit</a></li>
    <li><a href="../html/137.lerna.html">137.lerna</a></li>
    <li><a href="../html/138.create-vite.html">138.create-vite</a></li>
    <li><a href="../html/139.cli.html">139.cli</a></li>
    <li><a href="../html/140.antd.html">140.antd</a></li>
    <li><a href="../html/141.react-dnd.html">141.react-dnd</a></li>
    <li><a href="../html/142.1.link.html">142.1.link</a></li>
    <li><a href="../html/143.1.gulp.html">143.1.gulp</a></li>
    <li><a href="../html/143.2.stream.html">143.2.stream</a></li>
    <li><a href="../html/143.3.gulp.html">143.3.gulp</a></li>
    <li><a href="../html/144.1.closure.html">144.1.closure</a></li>
    <li><a href="../html/144.2.v8.html">144.2.v8</a></li>
    <li><a href="../html/144.3.gc.html">144.3.gc</a></li>
    <li class="active"><a href="../html/145.react-router-v6.html">145.react-router-v6</a></li>
    <li><a href="../html/145.react-router-v6.html">145.react-router-v6</a></li>
    <li><a href="../html/146.browser.html">146.browser</a></li>
    <li><a href="../html/147.lighthouse.html">147.lighthouse</a></li>
    <li><a href="../html/148.1.basic.html">148.1.basic</a></li>
    <li><a href="../html/148.2.basic .html">148.2.basic </a></li>
    <li><a href="../html/148.3.basic.html">148.3.basic</a></li>
    <li class="active"><a href="../html/148.4.basic.html">148.4.basic</a></li>
    <li><a href="../html/148.5.basic.html">148.5.basic</a></li>
    <li><a href="../html/149.1.vite.html">149.1.vite</a></li>
    <li><a href="../html/149.2.vite.html">149.2.vite</a></li>
    <li><a href="../html/149.3.vite.html">149.3.vite</a></li>
    <li><a href="../html/149.4.vite.html">149.4.vite</a></li>
    <li><a href="../html/150.react-window.html">150.react-window</a></li>
    <li><a href="../html/151.react-query.html">151.react-query</a></li>
    <li><a href="../html/152.useRequest.html">152.useRequest</a></li>
    <li><a href="../html/153.transition.html">153.transition</a></li>
    <li><a href="../html/154.emotion.html">154.emotion</a></li>
    <li><a href="../html/155.1.formily.html">155.1.formily</a></li>
    <li><a href="../html/155.2.formily.html">155.2.formily</a></li>
    <li><a href="../html/155.3.formily.html">155.3.formily</a></li>
    <li><a href="../html/155.3.1.mobx.usage.html">155.3.1.mobx.usage</a></li>
    <li><a href="../html/155.3.2.mobx.source.html">155.3.2.mobx.source</a></li>
    <li><a href="../html/156.vue-loader.html">156.vue-loader</a></li>
    <li><a href="../html/103.11.mf.html">103.11.mf</a></li>
    <li><a href="../html/157.1.react18.html">157.1.react18</a></li>
    <li><a href="../html/158.umi4.html">158.umi4</a></li>
    <li><a href="../html/159.rxjs.html">159.rxjs</a></li>
    <li><a href="../html/159.rxjs2.html">159.rxjs2</a></li>
    <li><a href="../html/160.bff.html">160.bff</a></li>
    <li><a href="../html/161.zustand.html">161.zustand</a></li>
    <li><a href="../html/162.vscode.html">162.vscode</a></li>
    <li><a href="../html/163.emp.html">163.emp</a></li>
  </ul>
</div>

               
<div class="warpper">
    <div class="page-toc">
        <ul><li><a href="#t01.create-vite">1.create-vite</a><ul><li><a href="#t11.1 create-vite简介">1.1 create-vite简介</a></li><li><a href="#t21.2 使用">1.2 使用</a></li><li><a href="#t31.3 create-vite源码调试">1.3 create-vite源码调试</a></li><li><a href="#t41.4 create-vite功能">1.4 create-vite功能</a></li></ul></li><li><a href="#t52.初始化项目">2.初始化项目</a><ul><li><a href="#t62.1 lerna初始化">2.1 lerna初始化</a></li><li><a href="#t72.2 使用yarn workspace">2.2 使用yarn workspace</a><ul><li><a href="#t82.2.1 lerna.json">2.2.1 lerna.json</a></li><li><a href="#t92.2.2 package.json">2.2.2 package.json</a></li></ul></li><li><a href="#t102.3 创建子包">2.3 创建子包</a></li><li><a href="#t112.4 安装依赖">2.4 安装依赖</a><ul><li><a href="#t122.4.1 config\package.json">2.4.1 config\package.json</a></li><li><a href="#t132.4.2  create\package.json">2.4.2  create\package.json</a></li><li><a href="#t142.4.3 utils\package.json">2.4.3 utils\package.json</a></li><li><a href="#t152.4.4 vite100\package.json">2.4.4 vite100\package.json</a></li><li><a href="#t162.4.5 publishConfig">2.4.5 publishConfig</a></li></ul></li><li><a href="#t172.5 配置命令">2.5 配置命令</a><ul><li><a href="#t182.5.1 package.json">2.5.1 package.json</a></li><li><a href="#t192.5.2  index.js">2.5.2  index.js</a></li><li><a href="#t202.5.3 link">2.5.3 link</a></li></ul></li></ul></li><li><a href="#t213.实现配置命令">3.实现配置命令</a><ul><li><a href="#t223.1 安装依赖">3.1 安装依赖</a></li><li><a href="#t233.2 settings\index.js">3.2 settings\index.js</a></li><li><a href="#t243.3 config.js">3.3 config.js</a></li><li><a href="#t253.4 executeNodeScript.js">3.4 executeNodeScript.js</a></li><li><a href="#t263.5 log.js">3.5 log.js</a></li><li><a href="#t273.6 utils\index.js">3.6 utils\index.js</a></li><li><a href="#t283.7 config\command.js">3.7 config\command.js</a></li><li><a href="#t293.8 config\index.js">3.8 config\index.js</a></li><li><a href="#t303.9 vite100\index.js">3.9 vite100\index.js</a></li></ul></li><li><a href="#t314.创建项目目录">4.创建项目目录</a><ul><li><a href="#t324.1 create\command.js">4.1 create\command.js</a></li><li><a href="#t334.2 create\index.js">4.2 create\index.js</a></li><li><a href="#t344.3 vite100\index.js">4.3 vite100\index.js</a></li></ul></li><li><a href="#t355. 获取选择项">5. 获取选择项</a><ul><li><a href="#t365.1 router.js">5.1 router.js</a></li><li><a href="#t375.2 getPromptModules.js">5.2 getPromptModules.js</a></li><li><a href="#t385.3 create\index.js">5.3 create\index.js</a></li></ul></li><li><a href="#t396. 获取回答">6. 获取回答</a><ul><li><a href="#t406.1 PromptModuleAPI.js">6.1 PromptModuleAPI.js</a></li><li><a href="#t416.2 Creator.js">6.2 Creator.js</a></li><li><a href="#t426.3 create\index.js">6.3 create\index.js</a></li></ul></li><li><a href="#t437. 准备项目目录">7. 准备项目目录</a><ul><li><a href="#t447.1 Creator.js">7.1 Creator.js</a></li></ul></li><li><a href="#t458. 下载模板">8. 下载模板</a><ul><li><a href="#t468.1 request.js">8.1 request.js</a></li><li><a href="#t478.2 withLoading.js">8.2 withLoading.js</a></li><li><a href="#t488.3 utils\index.js">8.3 utils\index.js</a></li><li><a href="#t498.4 settings\index.js">8.4 settings\index.js</a></li><li><a href="#t508.5 Creator.js">8.5 Creator.js</a></li></ul></li><li><a href="#t519.启动项目">9.启动项目</a><ul><li><a href="#t529.1 Creator.js">9.1 Creator.js</a></li><li><a href="#t539.2 create\index.js">9.2 create\index.js</a></li></ul></li><li><a href="#t5410.添加路由插件">10.添加路由插件</a><ul><li><a href="#t5510.1 router.js">10.1 router.js</a></li><li><a href="#t5610.2 Creator.js">10.2 Creator.js</a></li></ul></li><li><a href="#t5711. 解析并应用插件">11. 解析并应用插件</a><ul><li><a href="#t5811.1 mergeDeps.js">11.1 mergeDeps.js</a></li><li><a href="#t5911.2 loadModule.js">11.2 loadModule.js</a></li><li><a href="#t6011.3 extractCallDir.js">11.3 extractCallDir.js</a></li><li><a href="#t6111.4 writeFileTree.js">11.4 writeFileTree.js</a></li><li><a href="#t6211.5 utils\index.js">11.5 utils\index.js</a></li><li><a href="#t6311.6 GeneratorAPI.js">11.6 GeneratorAPI.js</a></li><li><a href="#t6411.7 injectImports.js">11.7 injectImports.js</a></li><li><a href="#t6511.8 Creator.js">11.8 Creator.js</a></li></ul></li><li><a href="#t6612. 实现插件">12. 实现插件</a><ul><li><a href="#t6712.1 App.js.ejs">12.1 App.js.ejs</a></li><li><a href="#t6812.2 routesConfig.js">12.2 routesConfig.js</a></li><li><a href="#t6912.3  generator.js">12.3  generator.js</a></li><li><a href="#t7012.4 injectRouter.js">12.4 injectRouter.js</a></li></ul></li><li><a href="#t7113.发布">13.发布</a><ul><li><a href="#t7213.1 创建组织">13.1 创建组织</a></li><li><a href="#t7313.2 发布">13.2 发布</a></li></ul></li><li><a href="#t7414.参考">14.参考</a><ul><li><a href="#t7514.1 lerna">14.1 lerna</a></li><li><a href="#t7614.3 yarn">14.3 yarn</a></li><li><a href="#t7714.4  workspace">14.4  workspace</a></li><li><a href="#t7814.3 yargs">14.3 yargs</a></li><li><a href="#t7914.5 node -e">14.5 node -e</a></li><li><a href="#t8014.6 clone">14.6 clone</a></li><li><a href="#t8114.7 jscodeshift">14.7 jscodeshift</a></li><li><a href="#t8214.8 vue-codemod">14.8 vue-codemod</a></li></ul></li></ul>
    </div>
    <div class="content markdown-body">
        <h2 id="t01.create-vite">1.create-vite <a href="#t01.create-vite"> # </a></h2>
<h3 id="t11.1 create-vite&#x7B80;&#x4ECB;">1.1 create-vite&#x7B80;&#x4ECB; <a href="#t11.1 create-vite&#x7B80;&#x4ECB;"> # </a></h3>
<ul>
<li><a href="https://cn.vitejs.dev/guide/#scaffolding-your-first-vite-project">vite&#x5B98;&#x7F51;</a></li>
<li><a href="https://www.npmjs.com/package/create-vite">create-vite&#x5305;</a></li>
<li><a href="https://github.com/vitejs/vite/tree/main/packages/create-vite">create-vite&#x6E90;&#x7801;</a></li>
</ul>
<h3 id="t21.2 &#x4F7F;&#x7528;">1.2 &#x4F7F;&#x7528; <a href="#t21.2 &#x4F7F;&#x7528;"> # </a></h3>
<pre><code class="lang-js">npm init vite
Need to install the following packages:
  create-vite
Ok to proceed? (y) y
&#x221A; Project name: ... vite-project
&#x221A; Select a framework: &#xBB; react
&#x221A; Select a variant: &#xBB; react

Scaffolding project <span class="hljs-keyword">in</span> C:\aprepare\t1\vite-project...

Done. Now run:

  cd vite-project
  npm install
  npm run dev
</code></pre>
<h3 id="t31.3 create-vite&#x6E90;&#x7801;&#x8C03;&#x8BD5;">1.3 create-vite&#x6E90;&#x7801;&#x8C03;&#x8BD5; <a href="#t31.3 create-vite&#x6E90;&#x7801;&#x8C03;&#x8BD5;"> # </a></h3>
<ul>
<li><a href="https://www.npmjs.com/package/minimist">minimist</a>&#x89E3;&#x6790;&#x53C2;&#x6570;&#x9009;&#x9879;,&#x7C7B;&#x4F3C;&#x7684;&#x8FD8;&#x6709;<a href="https://www.npmjs.com/package/yargs">yargs</a>&#x548C;<a href="https://www.npmjs.com/package/commander">commander</a></li>
<li><a href="https://www.npmjs.com/package/kolorist">kolorist</a>&#x5728;&#x63A7;&#x5236;&#x53F0;&#x6253;&#x5370;&#x989C;&#x8272;,&#x7C7B;&#x4F3C;&#x7684;&#x8FD8;&#x6709;<a href="https://www.npmjs.com/package/chalk">chalk</a></li>
<li><a href="https://www.npmjs.com/package/prompts">prompts</a>&#x4EA4;&#x4E92;&#x5F0F;&#x547D;&#x4EE4;&#x884C;&#xFF0C;&#x7C7B;&#x4F3C;&#x8FD8;&#x6709;<a href="https://www.npmjs.com/package/inquirer">inquirer</a></li>
</ul>
<pre><code class="lang-js">git clone https:<span class="hljs-comment">//github.com/vitejs/vite.git</span>
cd vite
yarn install
packages\create-vite\index.js
</code></pre>
<p>.vscode\launch.json</p>
<pre><code class="lang-json">{
    <span class="hljs-attr">&quot;version&quot;</span>: <span class="hljs-string">&quot;0.2.0&quot;</span>,
    <span class="hljs-attr">&quot;configurations&quot;</span>: [
        {
            <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;pwa-node&quot;</span>,
            <span class="hljs-attr">&quot;request&quot;</span>: <span class="hljs-string">&quot;launch&quot;</span>,
            <span class="hljs-attr">&quot;name&quot;</span>: <span class="hljs-string">&quot;Launch Program&quot;</span>,
            <span class="hljs-attr">&quot;skipFiles&quot;</span>: [
                <span class="hljs-string">&quot;&lt;node_internals&gt;/**&quot;</span>
            ],
            <span class="hljs-attr">&quot;program&quot;</span>: <span class="hljs-string">&quot;${workspaceFolder}\\packages\\create-vite\\index.js&quot;</span>,
            <span class="hljs-attr">&quot;args&quot;</span>: [<span class="hljs-string">&quot;create&quot;</span>,<span class="hljs-string">&quot;vite-project&quot;</span>]
        }
    ]
}
</code></pre>
<h3 id="t41.4 create-vite&#x529F;&#x80FD;">1.4 create-vite&#x529F;&#x80FD; <a href="#t41.4 create-vite&#x529F;&#x80FD;"> # </a></h3>
<ul>
<li>[&#x221A;] &#x652F;&#x6301;&#x53C2;&#x6570;&#x89E3;&#x6790;</li>
<li>[&#x221A;] &#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;&#x9879;&#x76EE;&#x540D;</li>
<li>[&#x221A;] &#x652F;&#x6301;&#x7A7A;&#x76EE;&#x5F55;&#x68C0;&#x67E5; </li>
<li>[&#x221A;] &#x652F;&#x6301;&#x9759;&#x6001;&#x9879;&#x76EE;&#x6A21;&#x677F;</li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;lerna <a href="https://github.com/lerna/lerna">lerna</a></li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x6587;&#x4EF6;&#x5F02;&#x6B65;&#x5199;&#x5165; <a href="https://github.com/facebook/create-react-app">create-react-app</a></li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x591A;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4; <a href="https://github.com/facebook/create-react-app">create-react-app</a></li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x6267;&#x884C;&#x52A8;&#x6001;<code>node</code>&#x547D;&#x4EE4; <a href="https://github.com/facebook/create-react-app">create-react-app</a></li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x81EA;&#x52A8;&#x5B89;&#x88C5;&#x4F9D;&#x8D56; <a href="https://github.com/facebook/create-react-app">create-react-app</a></li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x81EA;&#x52A8;&#x542F;&#x52A8;&#x670D;&#x52A1; <a href="https://github.com/facebook/create-react-app">create-react-app</a></li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x53C2;&#x6570;&#x914D;&#x7F6E; <a href="https://github.com/yarnpkg/yarn">yarn</a></li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;<code>gitub</code>&#x548C;<code>gitee</code>&#x4ED3;&#x5E93;&#x52A8;&#x6001;&#x8BFB;&#x53D6;</li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x6A21;&#x677F;&#x6807;&#x7B7E;&#x9009;&#x62E9;</li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x52A8;&#x6001;&#x6A21;&#x677F;&#x6E32;&#x67D3; </li>
<li>[&#xD7;] &#x4E0D;&#x652F;&#x6301;&#x63D2;&#x4EF6;&#x5316;&#x914D;&#x7F6E;&#x6280;&#x672F;&#x6808; <a href="https://github.com/vuejs/vue-cli">vue-cli</a></li>
</ul>
<h2 id="t52.&#x521D;&#x59CB;&#x5316;&#x9879;&#x76EE;">2.&#x521D;&#x59CB;&#x5316;&#x9879;&#x76EE; <a href="#t52.&#x521D;&#x59CB;&#x5316;&#x9879;&#x76EE;"> # </a></h2>
<h3 id="t62.1 lerna&#x521D;&#x59CB;&#x5316;">2.1 lerna&#x521D;&#x59CB;&#x5316; <a href="#t62.1 lerna&#x521D;&#x59CB;&#x5316;"> # </a></h3>
<pre><code class="lang-js">mkdir vite100
cd vite100
lerna init
</code></pre>
<h3 id="t72.2 &#x4F7F;&#x7528;yarn workspace">2.2 &#x4F7F;&#x7528;yarn workspace <a href="#t72.2 &#x4F7F;&#x7528;yarn workspace"> # </a></h3>
<ul>
<li>&#x5F00;&#x53D1;&#x591A;&#x4E2A;&#x4E92;&#x76F8;&#x4F9D;&#x8D56;&#x7684;package&#x65F6;&#xFF0C;workspace&#x4F1A;&#x81EA;&#x52A8;&#x5BF9;package&#x7684;&#x5F15;&#x7528;&#x8BBE;&#x7F6E;&#x8F6F;&#x94FE;&#x63A5;(symlink),&#x6BD4;yarn link&#x66F4;&#x52A0;&#x65B9;&#x4FBF;&#xFF0C;&#x4E14;&#x94FE;&#x63A5;&#x4EC5;&#x5C40;&#x9650;&#x5728;&#x5F53;&#x524D;workspace&#x4E2D;&#xFF0C;&#x4E0D;&#x4F1A;&#x5BF9;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x9020;&#x6210;&#x5F71;&#x54CD;</li>
<li>&#x6240;&#x6709;package&#x7684;&#x4F9D;&#x8D56;&#x4F1A;&#x5B89;&#x88C5;&#x5728;&#x6839;&#x76EE;&#x5F55;&#x7684;<code>node_modules</code>&#x4E0B;&#xFF0C;&#x8282;&#x7701;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#xFF0C;&#x4E14;&#x7ED9;&#x4E86;yarn&#x66F4;&#x5927;&#x7684;&#x4F9D;&#x8D56;&#x4F18;&#x5316;&#x7A7A;&#x95F4;</li>
<li>Yarn workspace&#x53EA;&#x4F1A;&#x5728;&#x6839;&#x76EE;&#x5F55;&#x5B89;&#x88C5;&#x4E00;&#x4E2A;node_modules&#xFF0C;&#x8FD9;&#x6709;&#x5229;&#x4E8E;&#x63D0;&#x5347;&#x4F9D;&#x8D56;&#x7684;&#x5B89;&#x88C5;&#x6548;&#x7387;&#x548C;&#x4E0D;&#x540C;package&#x95F4;&#x7684;&#x7248;&#x672C;&#x590D;&#x7528;&#x3002;&#x800C;Lerna&#x9ED8;&#x8BA4;&#x4F1A;&#x8FDB;&#x5230;&#x6BCF;&#x4E00;&#x4E2A;package&#x4E2D;&#x8FD0;&#x884C;yarn/npm install&#xFF0C;&#x5E76;&#x5728;&#x6BCF;&#x4E2A;package&#x4E2D;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;node_modules</li>
<li>yarn&#x5B98;&#x65B9;&#x63A8;&#x8350;&#x7684;&#x65B9;&#x6848;&#xFF0C;&#x662F;&#x96C6;&#x6210;yarn workspace&#x548C;lerna,&#x4F7F;&#x7528;yarn workspace&#x6765;&#x7BA1;&#x7406;&#x4F9D;&#x8D56;&#xFF0C;&#x4F7F;&#x7528;lerna&#x6765;&#x7BA1;&#x7406;npm&#x5305;&#x7684;&#x7248;&#x672C;&#x53D1;&#x5E03;</li>
</ul>
<h4 id="t82.2.1 lerna.json">2.2.1 lerna.json <a href="#t82.2.1 lerna.json"> # </a></h4>
<pre><code class="lang-diff">{
  &quot;packages&quot;: [
    &quot;packages/*&quot;
  ],
  &quot;version&quot;: &quot;0.0.0&quot;,
<span class="hljs-addition">+ &quot;npmClient&quot;: &quot;yarn&quot;,</span>
<span class="hljs-addition">+ &quot;useWorkspaces&quot;: true</span>
}
</code></pre>
<h4 id="t92.2.2 package.json">2.2.2 package.json <a href="#t92.2.2 package.json"> # </a></h4>
<pre><code class="lang-diff">{
  &quot;name&quot;: &quot;root&quot;,
  &quot;private&quot;: true,
  &quot;devDependencies&quot;: {
    &quot;lerna&quot;: &quot;^4.0.0&quot;
  },
<span class="hljs-addition">+  &quot;workspaces&quot;: [</span>
<span class="hljs-addition">+    &quot;packages/*&quot;</span>
<span class="hljs-addition">+ ]  </span>
}

</code></pre>
<h3 id="t102.3 &#x521B;&#x5EFA;&#x5B50;&#x5305;">2.3 &#x521B;&#x5EFA;&#x5B50;&#x5305; <a href="#t102.3 &#x521B;&#x5EFA;&#x5B50;&#x5305;"> # </a></h3>
<pre><code class="lang-js">lerna create @vite100/config -y <span class="hljs-comment">//&#x914D;&#x7F6E;&#x9879;</span>
lerna create @vite100/create -y <span class="hljs-comment">//&#x521B;&#x5EFA;&#x9879;&#x76EE;</span>
lerna create vite100 -y  <span class="hljs-comment">//&#x6838;&#x5FC3;&#x547D;&#x4EE4;</span>
lerna create @vite100/settings -y  <span class="hljs-comment">//&#x5E38;&#x91CF;&#x5B9A;&#x4E49;</span>
lerna create @vite100/utils -y <span class="hljs-comment">//&#x5DE5;&#x5177;&#x65B9;&#x6CD5;</span>
lerna create @vite100/cli-plugin-router -y <span class="hljs-comment">//&#x5DE5;&#x5177;&#x65B9;&#x6CD5;</span>
</code></pre>
<h3 id="t112.4 &#x5B89;&#x88C5;&#x4F9D;&#x8D56;">2.4 &#x5B89;&#x88C5;&#x4F9D;&#x8D56; <a href="#t112.4 &#x5B89;&#x88C5;&#x4F9D;&#x8D56;"> # </a></h3>
<ul>
<li><a href="https://www.npmjs.com/package/fs-extra">fs-extra</a> &#x52A0;&#x5F3A;&#x7248;&#x7684;&#x8BFB;&#x5199;&#x6A21;&#x5757;</li>
<li><a href="https://www.npmjs.com/package/clone-git-repo">clone-git-repo</a> &#x514B;&#x9686;git&#x4ED3;&#x5E93;</li>
<li><a href="https://www.npmjs.com/package/axios">axios</a> &#x8BF7;&#x6C42;&#x63A5;&#x53E3;</li>
<li><a href="https://www.npmjs.com/package/cross-spawn">cross-spawn</a> &#x5F00;&#x542F;&#x5B50;&#x8FDB;&#x7A0B;</li>
<li><a href="https://www.npmjs.com/package/userhome">userhome</a> &#x83B7;&#x53D6;&#x7528;&#x6237;&#x4E3B;&#x76EE;&#x5F55;</li>
<li><a href="https://www.npmjs.com/package/chalk">chalk</a> &#x63A7;&#x5236;&#x53F0;&#x6253;&#x5370;&#x5F69;&#x8272;&#x6587;&#x5B57;</li>
<li><a href="https://www.npmjs.com/package/ejs">ejs</a> &#x6A21;&#x677F;&#x6E32;&#x67D3;</li>
<li><a href="https://www.npmjs.com/package/execa">execa</a> &#x901A;&#x8FC7;&#x5B50;&#x8FDB;&#x7A0B;&#x6267;&#x884C;&#x547D;&#x4EE4;</li>
<li><a href="https://www.npmjs.com/package/glob">glob</a> &#x6309;&#x6A21;&#x5F0F;&#x5339;&#x914D;&#x6587;&#x4EF6;</li>
<li><a href="https://www.npmjs.com/package/inquirer">inquirer</a> &#x4EA4;&#x4E92;&#x5F0F;&#x547D;&#x4EE4;&#x884C;&#x9009;&#x62E9;</li>
<li><a href="https://www.npmjs.com/package/isbinaryfile">isbinaryfile</a> &#x5224;&#x65AD;&#x662F;&#x5426;&#x662F;&#x4E8C;&#x8FDB;&#x5236;&#x6587;&#x4EF6;</li>
<li><a href="https://www.npmjs.com/package/vue-codemod">vue-codemod</a> &#x901A;&#x8FC7;AST&#x4FEE;&#x6539;&#x6E90;&#x4EE3;&#x7801;</li>
<li><a href="https://www.npmjs.com/package/jscodeshift">jscodeshift</a> &#x901A;&#x8FC7;&#x8BED;&#x6CD5;&#x6811;&#x4FEE;&#x6539;&#x6E90;&#x4EE3;&#x7801;</li>
<li><a href="vite100">vite100</a> &#x6838;&#x5FC3;&#x547D;&#x4EE4;</li>
<li><a href="@vite100/settings">@vite100/settings</a> &#x5E38;&#x91CF;&#x914D;&#x7F6E;</li>
<li><a href="@vite100/utils">@vite100/utils</a> &#x5E2E;&#x52A9;&#x65B9;&#x6CD5;</li>
<li><a href="@vite100/config">@vite100/config</a> &#x914D;&#x7F6E;&#x53C2;&#x6570;</li>
<li><a href="@vite100/create">@vite100/create</a> &#x521B;&#x5EFA;&#x9879;&#x76EE;</li>
</ul>
<h4 id="t122.4.1 config\package.json">2.4.1 config\package.json <a href="#t122.4.1 config\package.json"> # </a></h4>
<p>packages\config\package.json</p>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;dependencies&quot;</span>: {
    <span class="hljs-attr">&quot;@vite100/settings&quot;</span>: <span class="hljs-string">&quot;^0.0.0&quot;</span>,
    <span class="hljs-attr">&quot;@vite100/utils&quot;</span>: <span class="hljs-string">&quot;^0.0.0&quot;</span>,
    <span class="hljs-attr">&quot;fs-extra&quot;</span>: <span class="hljs-string">&quot;^10.0.0&quot;</span>,
    <span class="hljs-attr">&quot;userhome&quot;</span>: <span class="hljs-string">&quot;^1.0.0&quot;</span>
   }
}
</code></pre>
<h4 id="t132.4.2  create\package.json">2.4.2  create\package.json <a href="#t132.4.2  create\package.json"> # </a></h4>
<p>packages\create\package.json</p>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;dependencies&quot;</span>: {
    <span class="hljs-attr">&quot;@vite100/settings&quot;</span>: <span class="hljs-string">&quot;^0.0.0&quot;</span>,
    <span class="hljs-attr">&quot;@vite100/utils&quot;</span>: <span class="hljs-string">&quot;^0.0.0&quot;</span>,
    <span class="hljs-attr">&quot;chalk&quot;</span>: <span class="hljs-string">&quot;^4.1.2&quot;</span>,
    <span class="hljs-attr">&quot;clone-git-repo&quot;</span>: <span class="hljs-string">&quot;^0.0.2&quot;</span>,
    <span class="hljs-attr">&quot;ejs&quot;</span>: <span class="hljs-string">&quot;^3.1.6&quot;</span>,
    <span class="hljs-attr">&quot;execa&quot;</span>: <span class="hljs-string">&quot;^5.1.1&quot;</span>,
    <span class="hljs-attr">&quot;fs-extra&quot;</span>: <span class="hljs-string">&quot;^10.0.0&quot;</span>,
    <span class="hljs-attr">&quot;glob&quot;</span>: <span class="hljs-string">&quot;^7.1.7&quot;</span>,
    <span class="hljs-attr">&quot;inquirer&quot;</span>: <span class="hljs-string">&quot;^8.1.2&quot;</span>,
    <span class="hljs-attr">&quot;isbinaryfile&quot;</span>: <span class="hljs-string">&quot;^4.0.8&quot;</span>,
    <span class="hljs-attr">&quot;vue-codemod&quot;</span>: <span class="hljs-string">&quot;^0.0.5&quot;</span>
  }
}
</code></pre>
<h4 id="t142.4.3 utils\package.json">2.4.3 utils\package.json <a href="#t142.4.3 utils\package.json"> # </a></h4>
<p>packages\utils\package.json</p>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;dependencies&quot;</span>: {
    <span class="hljs-attr">&quot;@vite100/settings&quot;</span>: <span class="hljs-string">&quot;^0.0.0&quot;</span>,
    <span class="hljs-attr">&quot;axios&quot;</span>: <span class="hljs-string">&quot;^0.21.2&quot;</span>,
    <span class="hljs-attr">&quot;cross-spawn&quot;</span>: <span class="hljs-string">&quot;^7.0.3&quot;</span>,
    <span class="hljs-attr">&quot;userhome&quot;</span>: <span class="hljs-string">&quot;^1.0.0&quot;</span>,
    <span class="hljs-attr">&quot;npmlog&quot;</span>: <span class="hljs-string">&quot;^5.0.1&quot;</span>,
    <span class="hljs-attr">&quot;ora&quot;</span>: <span class="hljs-string">&quot;^6.0.0&quot;</span>,
    <span class="hljs-attr">&quot;userhome&quot;</span>: <span class="hljs-string">&quot;^1.0.0&quot;</span>
  }
}
</code></pre>
<h4 id="t152.4.4 vite100\package.json">2.4.4 vite100\package.json <a href="#t152.4.4 vite100\package.json"> # </a></h4>
<p>packages\vite100\package.json</p>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;dependencies&quot;</span>: {
    <span class="hljs-attr">&quot;@vite100/config&quot;</span>: <span class="hljs-string">&quot;^0.0.0&quot;</span>,
    <span class="hljs-attr">&quot;@vite100/create&quot;</span>: <span class="hljs-string">&quot;^0.0.0&quot;</span>
  }
}
</code></pre>
<h4 id="t162.4.5 publishConfig">2.4.5 publishConfig <a href="#t162.4.5 publishConfig"> # </a></h4>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;publishConfig&quot;</span>: {
    <span class="hljs-attr">&quot;access&quot;</span>: <span class="hljs-string">&quot;public&quot;</span>,
    <span class="hljs-attr">&quot;registry&quot;</span>: <span class="hljs-string">&quot;http://registry.npmjs.org&quot;</span>
  }
}
</code></pre>
<p><img src="https://upload-markdown-images.oss-cn-beijing.aliyuncs.com/vite41_1630771189288.jpg" alt="vite100"></p>
<h3 id="t172.5 &#x914D;&#x7F6E;&#x547D;&#x4EE4;">2.5 &#x914D;&#x7F6E;&#x547D;&#x4EE4; <a href="#t172.5 &#x914D;&#x7F6E;&#x547D;&#x4EE4;"> # </a></h3>
<h4 id="t182.5.1 package.json">2.5.1 package.json <a href="#t182.5.1 package.json"> # </a></h4>
<p>packages\vite100\package.json</p>
<pre><code class="lang-diff">{
  &quot;name&quot;: &quot;vite100&quot;,
  &quot;version&quot;: &quot;0.0.0&quot;,
  &quot;dependencies&quot;: {
    &quot;@vite100/config&quot;:&quot;^0.0.0&quot;,
    &quot;@vite100/create&quot;:&quot;^0.0.0&quot;
  },
<span class="hljs-addition">+ &quot;bin&quot;:{</span>
<span class="hljs-addition">+   &quot;vite100&quot;: &quot;index.js&quot;</span>
<span class="hljs-addition">+ }</span>
}
</code></pre>
<h4 id="t192.5.2  index.js">2.5.2  index.js <a href="#t192.5.2  index.js"> # </a></h4>
<p>packages\vite100\index.js</p>
<pre><code class="lang-js"><span class="hljs-meta">#!/usr/bin/env node</span>

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>{
   <span class="hljs-keyword">let</span> argv = process.argv.slice(<span class="hljs-number">2</span>);
   <span class="hljs-built_in">console</span>.log(argv);
}

main().catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(err);
});

</code></pre>
<h4 id="t202.5.3 link">2.5.3 link <a href="#t202.5.3 link"> # </a></h4>
<ul>
<li>&#x4E00;&#x5B9A;&#x8981;&#x5148;&#x6DFB;&#x52A0;<code>#!/usr/bin/env node</code>&#x518D;link,&#x5426;&#x5219;&#x4F1A;&#x7528;&#x6587;&#x672C;&#x7F16;&#x8F91;&#x5668;&#x6253;&#x5F00;</li>
<li>&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x53EF;&#x4EE5;<code>vite100\packages\vite100</code>&#x76EE;&#x5F55;&#x4E2D;&#x6267;&#x884C;<code>yarn unlink</code>&#xFF0C;&#x518D;&#x91CD;&#x65B0;link</li>
</ul>
<pre><code class="lang-js">yarn link
yarn global bin 
<span class="hljs-attr">C</span>:\Users\zhangrenyang\AppData\Local\Yarn\bin
<span class="hljs-attr">C</span>:\Users\zhangrenyang\AppData\Local\Yarn\Data\link\vite100
npm bin -g
<span class="hljs-attr">C</span>:\Users\zhangrenyang\AppData\Roaming\npm
vite100 create vite-project
</code></pre>
<h2 id="t213.&#x5B9E;&#x73B0;&#x914D;&#x7F6E;&#x547D;&#x4EE4;">3.&#x5B9E;&#x73B0;&#x914D;&#x7F6E;&#x547D;&#x4EE4; <a href="#t213.&#x5B9E;&#x73B0;&#x914D;&#x7F6E;&#x547D;&#x4EE4;"> # </a></h2>
<h3 id="t223.1 &#x5B89;&#x88C5;&#x4F9D;&#x8D56;">3.1 &#x5B89;&#x88C5;&#x4F9D;&#x8D56; <a href="#t223.1 &#x5B89;&#x88C5;&#x4F9D;&#x8D56;"> # </a></h3>
<pre><code class="lang-js">yarn workspace @vite100/config  add userhome fs-extra
yarn workspace @vite100/utils  add cross-spawn userhome fs-extra
</code></pre>
<h3 id="t233.2 settings\index.js">3.2 settings\index.js <a href="#t233.2 settings\index.js"> # </a></h3>
<p>packages\settings\index.js</p>
<pre><code class="lang-js"><span class="hljs-comment">//&#x6267;&#x884C;&#x547D;&#x4EE4;&#x811A;&#x672C;</span>
exports.COMMAND_SOURCE = <span class="hljs-string">`
const args = JSON.parse(process.argv[1]);
const factory = require(&apos;.&apos;);
factory(args);
`</span>
<span class="hljs-comment">//&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x540D;&#x79F0;</span>
exports.RC_NAME = <span class="hljs-string">&quot;.vite100rc&quot;</span>;
</code></pre>
<h3 id="t243.3 config.js">3.3 config.js <a href="#t243.3 config.js"> # </a></h3>
<p>packages\utils\config.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> userhome = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;userhome&quot;</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs-extra&quot;</span>);
<span class="hljs-keyword">const</span> { RC_NAME } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vite100/settings&quot;</span>);
<span class="hljs-keyword">const</span> configPath = userhome(RC_NAME);
<span class="hljs-keyword">let</span> config = {};
<span class="hljs-keyword">if</span> (fs.existsSync(configPath)) {
  config = fs.readJSONSync(configPath);
}
config.configPath=configPath;
<span class="hljs-built_in">module</span>.exports = config;
</code></pre>
<h3 id="t253.4 executeNodeScript.js">3.4 executeNodeScript.js <a href="#t253.4 executeNodeScript.js"> # </a></h3>
<p>packages\utils\executeNodeScript.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> spawn = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;cross-spawn&quot;</span>);
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">executeNodeScript</span>(<span class="hljs-params">{ cwd }, source, args</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> childProcess = spawn(
        process.execPath,
        [<span class="hljs-string">&quot;-e&quot;</span>, source, <span class="hljs-string">&quot;--&quot;</span>, <span class="hljs-built_in">JSON</span>.stringify(args)],
        { cwd, <span class="hljs-attr">stdio</span>: <span class="hljs-string">&quot;inherit&quot;</span> }
      );
      childProcess.on(<span class="hljs-string">&quot;close&quot;</span>, resolve);
    });
}
<span class="hljs-built_in">module</span>.exports = executeNodeScript;
</code></pre>
<h3 id="t263.5 log.js">3.5 log.js <a href="#t263.5 log.js"> # </a></h3>
<p>packages\utils\log.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> log = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;npmlog&apos;</span>);
log.heading = <span class="hljs-string">&apos;vite100&apos;</span>;
<span class="hljs-built_in">module</span>.exports = log;
</code></pre>
<h3 id="t273.6 utils\index.js">3.6 utils\index.js <a href="#t273.6 utils\index.js"> # </a></h3>
<p>packages\utils\index.js</p>
<pre><code class="lang-js">exports.log = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./log&apos;</span>);
exports.executeNodeScript = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./executeNodeScript&apos;</span>);
exports.config = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./config&apos;</span>);
</code></pre>
<h3 id="t283.7 config\command.js">3.7 config\command.js <a href="#t283.7 config\command.js"> # </a></h3>
<p>packages\config\command.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> {executeNodeScript} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@vite100/utils&apos;</span>);
<span class="hljs-keyword">const</span> {COMMAND_SOURCE} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@vite100/settings&apos;</span>);
<span class="hljs-keyword">const</span> command = {
  <span class="hljs-attr">command</span>: <span class="hljs-string">&quot;config [key] [value]&quot;</span>,
  <span class="hljs-attr">describe</span>: <span class="hljs-string">&quot;&#x8BBE;&#x7F6E;&#x6216;&#x67E5;&#x770B;&#x914D;&#x7F6E;&#x9879;,&#x6BD4;&#x5982;GIT_TYPE&#x8BBE;&#x7F6E;&#x4ED3;&#x5E93;&#x7C7B;&#x578B;&#xFF0C;ORG_NAME&#x8BBE;&#x7F6E;&#x7EC4;&#x7EC7;&#x540D;&quot;</span>,
  <span class="hljs-attr">builder</span>: <span class="hljs-function">(<span class="hljs-params">yargs</span>) =&gt;</span> {},
  <span class="hljs-attr">handler</span>:<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">argv</span>)</span>{
    <span class="hljs-comment">//await executeNodeScript({ cwd: __dirname }, COMMAND_SOURCE,argv);</span>
    <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;.&apos;</span>)(argv);
  },
};
<span class="hljs-built_in">module</span>.exports = command;
</code></pre>
<h3 id="t293.8 config\index.js">3.8 config\index.js <a href="#t293.8 config\index.js"> # </a></h3>
<p>packages\config\index.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs-extra&quot;</span>);
<span class="hljs-keyword">const</span> { log ,config} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vite100/utils&quot;</span>);
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">factory</span>(<span class="hljs-params">argv</span>) </span>{
  <span class="hljs-keyword">const</span> { key, value } = argv;
  <span class="hljs-keyword">if</span> (key &amp;&amp; value) {
    config[key] = value;
    <span class="hljs-keyword">await</span> fs.writeJSON(config.configPath, config, { <span class="hljs-attr">spaces</span>: <span class="hljs-number">2</span> });
    log.info(<span class="hljs-string">&quot;vite100&quot;</span>,<span class="hljs-string">&quot;(%s=%s)&#x914D;&#x7F6E;&#x6210;&#x529F;&#x4FDD;&#x5B58;&#x81F3;%s&quot;</span>, key, value, config.configPath);
  }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(key){
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;%s=%s&apos;</span>,key, config[key]);
  }<span class="hljs-keyword">else</span>{
    <span class="hljs-built_in">console</span>.log(config);
  }
}
<span class="hljs-built_in">module</span>.exports = factory;
</code></pre>
<h3 id="t303.9 vite100\index.js">3.9 vite100\index.js <a href="#t303.9 vite100\index.js"> # </a></h3>
<p>packages\vite100\index.js</p>
<pre><code class="lang-diff">#!/usr/bin/env node
const yargs = require(&quot;yargs/yargs&quot;);
const configCmd = require(&quot;@vite100/config/command&quot;);
async function main() {
    const cli = yargs();
    cli
    .usage(`Usage: vite100 &lt;command&gt; [options]`)
    .demandCommand(1, &quot;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&quot;)
    .strict() 
    .recommendCommands()
<span class="hljs-addition">+   .command(configCmd)</span>
    .parse(process.argv.slice(2));
}

main().catch((err) =&gt; {
    console.error(err);
});
</code></pre>
<h2 id="t314.&#x521B;&#x5EFA;&#x9879;&#x76EE;&#x76EE;&#x5F55;">4.&#x521B;&#x5EFA;&#x9879;&#x76EE;&#x76EE;&#x5F55; <a href="#t314.&#x521B;&#x5EFA;&#x9879;&#x76EE;&#x76EE;&#x5F55;"> # </a></h2>
<h3 id="t324.1 create\command.js">4.1 create\command.js <a href="#t324.1 create\command.js"> # </a></h3>
<p>packages\create\command.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> {COMMAND_SOURCE} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@vite100/settings&apos;</span>);
<span class="hljs-keyword">const</span> {executeNodeScript} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;@vite100/utils&apos;</span>);
<span class="hljs-keyword">const</span> command = {
  <span class="hljs-attr">command</span>: <span class="hljs-string">&quot;create &lt;name&gt;&quot;</span>,
  <span class="hljs-attr">describe</span>: <span class="hljs-string">&quot;&#x521B;&#x5EFA;&#x9879;&#x76EE;&quot;</span>,
  <span class="hljs-attr">builder</span>: <span class="hljs-function">(<span class="hljs-params">yargs</span>) =&gt;</span> {
    yargs.positional(<span class="hljs-string">&quot;name&quot;</span>, {
      <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;string&quot;</span>,
      <span class="hljs-attr">describe</span>: <span class="hljs-string">&quot;&#x9879;&#x76EE;&#x540D;&#x79F0;&quot;</span>,
    });
  },
  <span class="hljs-attr">handler</span>:<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">argv</span>)</span>{
    <span class="hljs-keyword">let</span> args = {<span class="hljs-attr">projectName</span>:argv.name,<span class="hljs-attr">workingDirectory</span>:process.cwd()};
    <span class="hljs-comment">//await executeNodeScript({ cwd: __dirname }, COMMAND_SOURCE,args);</span>
    <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;.&apos;</span>)(args);
  }
};
<span class="hljs-built_in">module</span>.exports = command;
</code></pre>
<h3 id="t334.2 create\index.js">4.2 create\index.js <a href="#t334.2 create\index.js"> # </a></h3>
<p>packages\create\index.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs-extra&quot;</span>);
<span class="hljs-keyword">const</span> execa = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;execa&quot;</span>);
<span class="hljs-keyword">const</span> { red } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;chalk&quot;</span>);
<span class="hljs-keyword">const</span> { config, log } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vite100/utils&quot;</span>);

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">create</span>(<span class="hljs-params">argv</span>) </span>{
    <span class="hljs-keyword">const</span> { workingDirectory, projectName } = argv;
    <span class="hljs-keyword">const</span> { GIT_TYPE, ORG_NAME } = config;
    <span class="hljs-keyword">if</span> (!GIT_TYPE) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(red(<span class="hljs-string">&quot;X&quot;</span>) + <span class="hljs-string">&quot; &#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x4ED3;&#x5E93;&#x7C7B;&#x578B;!&quot;</span>);
    }
    <span class="hljs-keyword">if</span> (!ORG_NAME) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(red(<span class="hljs-string">&quot;X&quot;</span>) + <span class="hljs-string">&quot; &#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x7EC4;&#x7EC7;&#x540D;&#x79F0;!&quot;</span>);
    }
    <span class="hljs-keyword">const</span> projectDir = path.join(workingDirectory, projectName);
    log.info(<span class="hljs-string">&quot;vite100&quot;</span>, <span class="hljs-string">&quot;&#x521B;&#x5EFA;&#x7684;&#x9879;&#x76EE;&#x76EE;&#x5F55;&#x4E3A;%s&quot;</span>, projectDir);
}
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> create(...args).catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.error(err);
    });
};
</code></pre>
<h3 id="t344.3 vite100\index.js">4.3 vite100\index.js <a href="#t344.3 vite100\index.js"> # </a></h3>
<p>packages\vite100\index.js</p>
<pre><code class="lang-diff">#!/usr/bin/env node
const yargs = require(&quot;yargs/yargs&quot;);
const configCmd = require(&quot;@vite100/config/command&quot;);
<span class="hljs-addition">+const createCmd = require(&quot;@vite100/create/command&quot;);</span>
async function main() {
    const cli = yargs();
    cli
    .usage(`Usage: vite100 &lt;command&gt; [options]`)
    .demandCommand(1, &quot;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&quot;)
    .strict() 
    .recommendCommands()
<span class="hljs-addition">+   .command(createCmd)</span>
    .command(configCmd)
    .parse(process.argv.slice(2));
 }

 main().catch((err) =&gt; {
     console.error(err);
 });
</code></pre>
<h2 id="t355. &#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879;">5. &#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879; <a href="#t355. &#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879;"> # </a></h2>
<h3 id="t365.1 router.js">5.1 router.js <a href="#t365.1 router.js"> # </a></h3>
<p>packages\create\lib\promptModules\router.js</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-params">cli</span> =&gt;</span> {
    cli.injectFeature({
        <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;Router&apos;</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;router&apos;</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">&apos;&#x8BF7;&#x9009;&#x62E9;&#x8DEF;&#x7531;&#x6A21;&#x5F0F;&apos;</span>,
        <span class="hljs-attr">link</span>: <span class="hljs-string">&apos;https://www.npmjs.com/package/react-router-dom&apos;</span>
    })
    cli.injectPrompt({
        <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;historyMode&apos;</span>,
        <span class="hljs-attr">when</span>: <span class="hljs-function"><span class="hljs-params">answers</span> =&gt;</span> answers.features.includes(<span class="hljs-string">&apos;router&apos;</span>),
        <span class="hljs-attr">message</span>: <span class="hljs-string">&apos;&#x8BF7;&#x9009;&#x62E9;history&#x7684;&#x6A21;&#x5F0F;&apos;</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;list&apos;</span>,
        <span class="hljs-attr">choices</span>: [
            {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;hash&apos;</span>,
                <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;hash&apos;</span>
            },
            {
                <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;browser&apos;</span>,
                <span class="hljs-attr">value</span>: <span class="hljs-string">&apos;browser&apos;</span>
            }
        ],
        <span class="hljs-attr">default</span>: <span class="hljs-string">&apos;browser&apos;</span>
    })
    cli.injectPrompt({
        <span class="hljs-attr">name</span>: <span class="hljs-string">&apos;appTitle&apos;</span>,
        <span class="hljs-attr">when</span>: <span class="hljs-function"><span class="hljs-params">answers</span> =&gt;</span> answers.features.includes(<span class="hljs-string">&apos;router&apos;</span>),
        <span class="hljs-attr">message</span>: <span class="hljs-string">&apos;&#x8BF7;&#x8F93;&#x5165;&#x6839;&#x7EC4;&#x4EF6;&#x7684;&#x6807;&#x9898;&apos;</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">&apos;text&apos;</span>,
        <span class="hljs-attr">default</span>: <span class="hljs-string">&apos;AppTitle&apos;</span>
    })
    cli.onPromptComplete(<span class="hljs-function">(<span class="hljs-params">answers, projectOptions</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (answers.features.includes(<span class="hljs-string">&apos;router&apos;</span>)) {
            projectOptions.historyMode =answers.historyMode;
            projectOptions.appTitle=answers.appTitle;
        }
    })
}
</code></pre>
<h3 id="t375.2 getPromptModules.js">5.2 getPromptModules.js <a href="#t375.2 getPromptModules.js"> # </a></h3>
<p>packages\create\lib\getPromptModules.js</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPromptModules</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> [<span class="hljs-string">&apos;router&apos;</span>].map(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> <span class="hljs-built_in">require</span>(<span class="hljs-string">`./promptModules/<span class="hljs-subst">${file}</span>`</span>));
}
<span class="hljs-built_in">module</span>.exports = getPromptModules;
</code></pre>
<h3 id="t385.3 create\index.js">5.3 create\index.js <a href="#t385.3 create\index.js"> # </a></h3>
<p>packages\create\index.js</p>
<pre><code class="lang-diff">const path = require(&quot;path&quot;);
const { red } = require(&quot;chalk&quot;);
const { config, log } = require(&quot;@vite100/utils&quot;);
<span class="hljs-addition">+const getPromptModules = require(&apos;./lib/getPromptModules&apos;);</span>
async function create(argv) {
    const { workingDirectory, projectName } = argv;
    const { GIT_TYPE, ORG_NAME } = config;
    if (!GIT_TYPE) {
        throw new Error(red(&quot;X&quot;) + &quot; &#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x4ED3;&#x5E93;&#x7C7B;&#x578B;!&quot;);
    }
    if (!ORG_NAME) {
        throw new Error(red(&quot;X&quot;) + &quot; &#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x7EC4;&#x7EC7;&#x540D;&#x79F0;!&quot;);
    }
    const projectDir = path.join(workingDirectory, projectName);
    log.info(&quot;vite100&quot;, &quot;&#x521B;&#x5EFA;&#x7684;&#x9879;&#x76EE;&#x76EE;&#x5F55;&#x4E3A;%s&quot;, projectDir);
<span class="hljs-addition">+   let promptModules = getPromptModules();</span>
<span class="hljs-addition">+   console.info(&quot;&#x9009;&#x62E9;&#x9879;promptModules&quot;, promptModules);</span>
}
module.exports = (...args) =&gt; {
    return create(...args).catch(err =&gt; {
        console.error(err);
    });
};
</code></pre>
<h2 id="t396. &#x83B7;&#x53D6;&#x56DE;&#x7B54;">6. &#x83B7;&#x53D6;&#x56DE;&#x7B54; <a href="#t396. &#x83B7;&#x53D6;&#x56DE;&#x7B54;"> # </a></h2>
<h3 id="t406.1 PromptModuleAPI.js">6.1 PromptModuleAPI.js <a href="#t406.1 PromptModuleAPI.js"> # </a></h3>
<p>packages\create\lib\PromptModuleAPI.js</p>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PromptModuleAPI</span> </span>{
    <span class="hljs-keyword">constructor</span>(creator) {
        <span class="hljs-keyword">this</span>.creator = creator;
    }
    <span class="hljs-comment">//&#x63D2;&#x5165;&#x7279;&#x6027;</span>
    injectFeature(feature) {
        <span class="hljs-keyword">this</span>.creator.featurePrompt.choices.push(feature)
    }
    <span class="hljs-comment">//&#x63D2;&#x5165;&#x9009;&#x9879;</span>
    injectPrompt(prompt) {
        <span class="hljs-keyword">this</span>.creator.injectedPrompts.push(prompt)
    }
    <span class="hljs-comment">//&#x9009;&#x62E9;&#x5B8C;&#x6210;&#x540E;&#x7684;&#x56DE;&#x8C03;</span>
    onPromptComplete(cb) {
        <span class="hljs-keyword">this</span>.creator.promptCompleteCbs.push(cb)
    }
}
<span class="hljs-built_in">module</span>.exports = PromptModuleAPI;
</code></pre>
<h3 id="t416.2 Creator.js">6.2 Creator.js <a href="#t416.2 Creator.js"> # </a></h3>
<p>packages\create\lib\Creator.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> { prompt } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;inquirer&quot;</span>);
<span class="hljs-keyword">const</span> PromptModuleAPI = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./PromptModuleAPI&quot;</span>);
<span class="hljs-keyword">const</span> defaultFeaturePrompt = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;features&quot;</span>,
    <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;checkbox&quot;</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;&#x8BF7;&#x9009;&#x62E9;&#x9879;&#x76EE;&#x7279;&#x6027;:&quot;</span>,
    <span class="hljs-attr">choices</span>: [],
}
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Creator</span> </span>{
    <span class="hljs-keyword">constructor</span>(projectName, projectDir, promptModules) {
        <span class="hljs-keyword">this</span>.projectName = projectName;<span class="hljs-comment">//&#x9879;&#x76EE;&#x540D;&#x79F0;</span>
        <span class="hljs-keyword">this</span>.projectDir = projectDir;<span class="hljs-comment">//&#x9879;&#x76EE;&#x8DEF;&#x5F84;</span>
        <span class="hljs-keyword">this</span>.featurePrompt = defaultFeaturePrompt;<span class="hljs-comment">//&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x6846;</span>
        <span class="hljs-keyword">this</span>.injectedPrompts = [];<span class="hljs-comment">//&#x63D2;&#x5165;&#x63D2;&#x5165;&#x7684;&#x9009;&#x62E9;&#x6846;</span>
        <span class="hljs-keyword">this</span>.promptCompleteCbs = [];<span class="hljs-comment">//&#x9009;&#x62E9;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#x7684;&#x56DE;&#x8C03;</span>
        <span class="hljs-keyword">const</span> promptModuleAPI = <span class="hljs-keyword">new</span> PromptModuleAPI(<span class="hljs-keyword">this</span>);
        promptModules.forEach(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">module</span></span>) =&gt;</span> <span class="hljs-built_in">module</span>(promptModuleAPI));
    }
    <span class="hljs-keyword">async</span> create() {
        <span class="hljs-comment">//&#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879;</span>
        <span class="hljs-keyword">const</span> projectOptions = (<span class="hljs-keyword">this</span>.projectOptions = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.promptAndResolve());
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&apos;projectOptions&apos;</span>,projectOptions);
        <span class="hljs-comment">//{historyMode: &apos;browser&apos;,appTitle: &apos;AppTitle&apos;}</span>



    }
    <span class="hljs-keyword">async</span> promptAndResolve() {
        <span class="hljs-keyword">let</span> prompts = [<span class="hljs-keyword">this</span>.featurePrompt, ...this.injectedPrompts];
        <span class="hljs-keyword">let</span> answers = <span class="hljs-keyword">await</span> prompt(prompts);
        <span class="hljs-keyword">let</span> projectOptions = {<span class="hljs-attr">plugins</span>: {},};
        <span class="hljs-keyword">this</span>.promptCompleteCbs.forEach(<span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> cb(answers, projectOptions));
        <span class="hljs-keyword">return</span> projectOptions;
      }
}
<span class="hljs-built_in">module</span>.exports = Creator;
</code></pre>
<h3 id="t426.3 create\index.js">6.3 create\index.js <a href="#t426.3 create\index.js"> # </a></h3>
<p>packages\create\index.js</p>
<pre><code class="lang-diff">const path = require(&quot;path&quot;);
const { red } = require(&quot;chalk&quot;);
const { config, log } = require(&quot;@vite100/utils&quot;);
const getPromptModules = require(&apos;./lib/getPromptModules&apos;);
<span class="hljs-addition">+const Creator = require(&apos;./lib/Creator&apos;);</span>
async function create(argv) {
    const { workingDirectory, projectName } = argv;
    const { GIT_TYPE, ORG_NAME } = config;
    if (!GIT_TYPE) {
        throw new Error(red(&quot;X&quot;) + &quot; &#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x4ED3;&#x5E93;&#x7C7B;&#x578B;!&quot;);
    }
    if (!ORG_NAME) {
        throw new Error(red(&quot;X&quot;) + &quot; &#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x7EC4;&#x7EC7;&#x540D;&#x79F0;!&quot;);
    }
    const projectDir = path.join(workingDirectory, projectName);
    log.info(&quot;vite100&quot;, &quot;&#x521B;&#x5EFA;&#x7684;&#x9879;&#x76EE;&#x76EE;&#x5F55;&#x4E3A;%s&quot;, projectDir);
    let promptModules = getPromptModules();
    console.info(&quot;&#x9009;&#x62E9;&#x9879;promptModules&quot;, promptModules);
<span class="hljs-addition">+   let creator = new Creator(projectName, projectDir, promptModules);</span>
<span class="hljs-addition">+   await creator.create();</span>
}
module.exports = (...args) =&gt; {
    return create(...args).catch(err =&gt; {
        console.error(err);
    });
};
</code></pre>
<h2 id="t437. &#x51C6;&#x5907;&#x9879;&#x76EE;&#x76EE;&#x5F55;">7. &#x51C6;&#x5907;&#x9879;&#x76EE;&#x76EE;&#x5F55; <a href="#t437. &#x51C6;&#x5907;&#x9879;&#x76EE;&#x76EE;&#x5F55;"> # </a></h2>
<h3 id="t447.1 Creator.js">7.1 Creator.js <a href="#t447.1 Creator.js"> # </a></h3>
<p>packages\create\lib\Creator.js</p>
<pre><code class="lang-diff">const { prompt } = require(&quot;inquirer&quot;);
<span class="hljs-addition">+const fs = require(&quot;fs-extra&quot;);</span>
<span class="hljs-addition">+const { red } = require(&quot;chalk&quot;);</span>
const PromptModuleAPI = require(&quot;./PromptModuleAPI&quot;);
<span class="hljs-addition">+const { log } = require(&quot;@vite100/utils&quot;);</span>
const defaultFeaturePrompt = {
    name: &quot;features&quot;,
    type: &quot;checkbox&quot;,
    message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x9879;&#x76EE;&#x7279;&#x6027;:&quot;,
    choices: [],
}
class Creator {
    constructor(projectName, projectDir, promptModules) {
        this.projectName = projectName;//&#x9879;&#x76EE;&#x540D;&#x79F0;
        this.projectDir = projectDir;//&#x9879;&#x76EE;&#x8DEF;&#x5F84;
        this.featurePrompt = defaultFeaturePrompt;//&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x6846;
        this.injectedPrompts = [];//&#x63D2;&#x5165;&#x63D2;&#x5165;&#x7684;&#x9009;&#x62E9;&#x6846;
        this.promptCompleteCbs = [];//&#x9009;&#x62E9;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#x7684;&#x56DE;&#x8C03;
        const promptModuleAPI = new PromptModuleAPI(this);
        promptModules.forEach((module) =&gt; module(promptModuleAPI));
    }
    async create() {
        //&#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879;
        const projectOptions = (this.projectOptions = await this.promptAndResolve());
        console.log(&apos;projectOptions&apos;, projectOptions);
        //{historyMode: &apos;browser&apos;,appTitle: &apos;AppTitle&apos;}
<span class="hljs-addition">+       //&#x51C6;&#x5907;&#x9879;&#x76EE;&#x76EE;&#x5F55;</span>
<span class="hljs-addition">+       await this.prepareProjectDir();</span>
    }
<span class="hljs-addition">+   async prepareProjectDir() {</span>
<span class="hljs-addition">+       let { projectDir } = this;</span>
<span class="hljs-addition">+       try {</span>
<span class="hljs-addition">+           await fs.access(projectDir);</span>
<span class="hljs-addition">+           const files = await fs.readdir(projectDir);</span>
<span class="hljs-addition">+           if (files.length &gt; 0) {</span>
<span class="hljs-addition">+               const { overwrite } = await prompt({</span>
<span class="hljs-addition">+                   type: &quot;confirm&quot;,</span>
<span class="hljs-addition">+                   name: &quot;overwrite&quot;,</span>
<span class="hljs-addition">+                   message: `&#x76EE;&#x6807;&#x76EE;&#x5F55;&#x975E;&#x7A7A;&#xFF0C;&#x662F;&#x5426;&#x8981;&#x79FB;&#x9664;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x5E76;&#x7EE7;&#x7EED;?`,</span>
<span class="hljs-addition">+               });</span>
<span class="hljs-addition">+               if (overwrite) {</span>
<span class="hljs-addition">+                   await fs.emptyDir(projectDir);</span>
<span class="hljs-addition">+               } else {</span>
<span class="hljs-addition">+                   throw new Error(red(&quot;X&quot;) + &quot; &#x64CD;&#x4F5C;&#x88AB;&#x53D6;&#x6D88;&quot;);</span>
<span class="hljs-addition">+               }</span>
<span class="hljs-addition">+           }</span>
<span class="hljs-addition">+       } catch (error) {</span>
<span class="hljs-addition">+           await fs.mkdirp(projectDir);</span>
<span class="hljs-addition">+       }</span>
<span class="hljs-addition">+       log.info(&quot;vite100&quot;, &quot;%s&#x76EE;&#x5F55;&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&quot;, projectDir);</span>
<span class="hljs-addition">+   }</span>
    async promptAndResolve() {
        let prompts = [this.featurePrompt, ...this.injectedPrompts];
        let answers = await prompt(prompts);
        let projectOptions = { plugins: {}, };
        this.promptCompleteCbs.forEach((cb) =&gt; cb(answers, projectOptions));
        return projectOptions;
    }
}
module.exports = Creator;
</code></pre>
<h2 id="t458. &#x4E0B;&#x8F7D;&#x6A21;&#x677F;">8. &#x4E0B;&#x8F7D;&#x6A21;&#x677F; <a href="#t458. &#x4E0B;&#x8F7D;&#x6A21;&#x677F;"> # </a></h2>
<h3 id="t468.1 request.js">8.1 request.js <a href="#t468.1 request.js"> # </a></h3>
<p>packages\utils\request.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;axios&quot;</span>);
<span class="hljs-keyword">const</span> { GIT_TYPE } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;./config&quot;</span>);
<span class="hljs-keyword">const</span> GITEE = <span class="hljs-string">&quot;https://gitee.com/api/v5&quot;</span>;
<span class="hljs-keyword">const</span> GITHUB = <span class="hljs-string">&quot;https://api.github.com&quot;</span>;

<span class="hljs-keyword">const</span> BASE_URL = GIT_TYPE === <span class="hljs-string">&quot;gitee&quot;</span> ? GITEE : GITHUB;
<span class="hljs-keyword">const</span> request = axios.create({
    <span class="hljs-attr">baseURL</span>: BASE_URL,
    <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span>,
});

request.interceptors.response.use(
    <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> response.data;
    },
    (error) =&gt; {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(error);
    }
);

<span class="hljs-built_in">module</span>.exports = request;

</code></pre>
<h3 id="t478.2 withLoading.js">8.2 withLoading.js <a href="#t478.2 withLoading.js"> # </a></h3>
<p>packages\utils\withLoading.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withLoading</span>(<span class="hljs-params">message, fn, ...args</span>) </span>{
  <span class="hljs-keyword">const</span> ora = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&quot;ora&quot;</span>);
  <span class="hljs-keyword">const</span> spinner = ora.default(message);
  spinner.start();
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> fn(...args);
  spinner.succeed();
  <span class="hljs-keyword">return</span> result;
}
<span class="hljs-built_in">module</span>.exports = withLoading;
</code></pre>
<h3 id="t488.3 utils\index.js">8.3 utils\index.js <a href="#t488.3 utils\index.js"> # </a></h3>
<p>packages\utils\index.js</p>
<pre><code class="lang-diff">exports.log = require(&apos;./log&apos;);
exports.executeNodeScript = require(&apos;./executeNodeScript&apos;);
exports.config = require(&apos;./config&apos;);
<span class="hljs-addition">+exports.withLoading = require(&apos;./withLoading&apos;);</span>
<span class="hljs-addition">+exports.request = require(&apos;./request&apos;);</span>
</code></pre>
<h3 id="t498.4 settings\index.js">8.4 settings\index.js <a href="#t498.4 settings\index.js"> # </a></h3>
<p>packages\settings\index.js</p>
<pre><code class="lang-diff">//&#x6267;&#x884C;&#x547D;&#x4EE4;&#x811A;&#x672C;
exports.COMMAND_SOURCE = `
const args = JSON.parse(process.argv[1]);
const factory = require(&apos;.&apos;);
factory(args);
`
//&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x540D;&#x79F0;
exports.RC_NAME = &quot;.vite100rc&quot;;

<span class="hljs-addition">+//&#x6A21;&#x677F;&#x5B58;&#x653E;&#x540D;&#x79F0;</span>
<span class="hljs-addition">+exports.TEMPLATES = &quot;.vite100_templates&quot;;</span>
</code></pre>
<h3 id="t508.5 Creator.js">8.5 Creator.js <a href="#t508.5 Creator.js"> # </a></h3>
<p>packages\create\lib\Creator.js</p>
<pre><code class="lang-diff">const { prompt } = require(&quot;inquirer&quot;);
const fs = require(&quot;fs-extra&quot;);
const { red } = require(&quot;chalk&quot;);
<span class="hljs-addition">+const userhome = require(&quot;userhome&quot;);</span>
<span class="hljs-addition">+const {promisify} = require(&apos;util&apos;);</span>
<span class="hljs-addition">+const clone = promisify(require(&apos;clone-git-repo&apos;));</span>
const PromptModuleAPI = require(&quot;./PromptModuleAPI&quot;);
<span class="hljs-addition">+const { log,config,withLoading ,request} = require(&quot;@vite100/utils&quot;);</span>
<span class="hljs-addition">+const { TEMPLATES } = require(&quot;@vite100/settings&quot;);</span>
const defaultFeaturePrompt = {
    name: &quot;features&quot;,
    type: &quot;checkbox&quot;,
    message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x9879;&#x76EE;&#x7279;&#x6027;:&quot;,
    choices: [],
}
class Creator {
    constructor(projectName, projectDir, promptModules) {
        this.projectName = projectName;//&#x9879;&#x76EE;&#x540D;&#x79F0;
        this.projectDir = projectDir;//&#x9879;&#x76EE;&#x8DEF;&#x5F84;
        this.featurePrompt = defaultFeaturePrompt;//&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x6846;
        this.injectedPrompts = [];//&#x63D2;&#x5165;&#x63D2;&#x5165;&#x7684;&#x9009;&#x62E9;&#x6846;
        this.promptCompleteCbs = [];//&#x9009;&#x62E9;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#x7684;&#x56DE;&#x8C03;
        const promptModuleAPI = new PromptModuleAPI(this);
        promptModules.forEach((module) =&gt; module(promptModuleAPI));
    }
    async create() {
        //&#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879;
        const projectOptions = (this.projectOptions = await this.promptAndResolve());
        console.log(&apos;projectOptions&apos;, projectOptions);
        //{historyMode: &apos;browser&apos;,appTitle: &apos;AppTitle&apos;}
        //&#x51C6;&#x5907;&#x9879;&#x76EE;&#x76EE;&#x5F55;
        await this.prepareProjectDir();
<span class="hljs-addition">+       //&#x4E0B;&#x8F7D;&#x6A21;&#x677F;&#xFF0C;&#x7ED9;templateDir&#x8D4B;&#x503C;</span>
<span class="hljs-addition">+       await this.downloadTemplate();</span>
    }
<span class="hljs-addition">+    async downloadTemplate() {</span>
<span class="hljs-addition">+        const { GIT_TYPE, ORG_NAME } = config;</span>
<span class="hljs-addition">+        let repos = await withLoading(&quot;&#x8BFB;&#x53D6;&#x6A21;&#x677F;&#x5217;&#x8868;&quot;, async () =&gt;</span>
<span class="hljs-addition">+            request.get(`/orgs/${ORG_NAME}/repos`)</span>
<span class="hljs-addition">+        );</span>
<span class="hljs-addition">+        let { repo } = await prompt({</span>
<span class="hljs-addition">+            name: &quot;repo&quot;,</span>
<span class="hljs-addition">+            type: &quot;list&quot;,</span>
<span class="hljs-addition">+            message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x6A21;&#x677F;&quot;,</span>
<span class="hljs-addition">+            choices: repos.map((repo) =&gt; repo.name)</span>
<span class="hljs-addition">+        });</span>
<span class="hljs-addition">+        let tags = await withLoading(&quot;&#x8BFB;&#x53D6;&#x6807;&#x7B7E;&#x5217;&#x8868;&quot;, async () =&gt;</span>
<span class="hljs-addition">+            request.get(`/repos/${ORG_NAME}/${repo}/tags`)</span>
<span class="hljs-addition">+        );</span>
<span class="hljs-addition">+        let { tag } = await prompt({</span>
<span class="hljs-addition">+            name: &quot;tag&quot;,</span>
<span class="hljs-addition">+            type: &quot;list&quot;,</span>
<span class="hljs-addition">+            message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x7248;&#x672C;&quot;,</span>
<span class="hljs-addition">+            choices: tags,</span>
<span class="hljs-addition">+        });</span>
<span class="hljs-addition">+        let repository = GIT_TYPE + `:${ORG_NAME}/${repo}`;</span>
<span class="hljs-addition">+        if (tag) repository += `#${tag}`;</span>
<span class="hljs-addition">+        const downloadDirectory = userhome(TEMPLATES);</span>
<span class="hljs-addition">+        let templateDir = (this.templateDir = `${downloadDirectory}/${repo}/${tag}`);</span>
<span class="hljs-addition">+        log.info(&quot;vite3&quot;, &quot;&#x51C6;&#x5907;&#x4E0B;&#x8F7D;&#x6A21;&#x677F;&#x5230;%s&quot;, templateDir);</span>
<span class="hljs-addition">+        try {</span>
<span class="hljs-addition">+            await fs.access(templateDir);</span>
<span class="hljs-addition">+        } catch (error) {</span>
<span class="hljs-addition">+            log.info(&quot;vite100&quot;, &quot;&#x4ECE;&#x4ED3;&#x5E93;&#x4E0B;&#x8F7D;%s&quot;, repository);</span>
<span class="hljs-addition">+            await clone(repository, templateDir, { clone: true });</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+    }</span>
    async prepareProjectDir() {
        let { projectDir } = this;
        try {
            await fs.access(projectDir);
            const files = await fs.readdir(projectDir);
            if (files.length &gt; 0) {
                const { overwrite } = await prompt({
                    type: &quot;confirm&quot;,
                    name: &quot;overwrite&quot;,
                    message: `&#x76EE;&#x6807;&#x76EE;&#x5F55;&#x975E;&#x7A7A;&#xFF0C;&#x662F;&#x5426;&#x8981;&#x79FB;&#x9664;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x5E76;&#x7EE7;&#x7EED;?`,
                });
                if (overwrite) {
                    await fs.emptyDir(projectDir);
                } else {
                    throw new Error(red(&quot;X&quot;) + &quot; &#x64CD;&#x4F5C;&#x88AB;&#x53D6;&#x6D88;&quot;);
                }
            }
        } catch (error) {
            await fs.mkdirp(projectDir);
        }
        log.info(&quot;vite100&quot;, &quot;%s&#x76EE;&#x5F55;&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&quot;, projectDir);
    }
    async promptAndResolve() {
        let prompts = [this.featurePrompt, ...this.injectedPrompts];
        let answers = await prompt(prompts);
        let projectOptions = { plugins: {}, };
        this.promptCompleteCbs.forEach((cb) =&gt; cb(answers, projectOptions));
        return projectOptions;
    }
}
module.exports = Creator;
</code></pre>
<h2 id="t519.&#x542F;&#x52A8;&#x9879;&#x76EE;">9.&#x542F;&#x52A8;&#x9879;&#x76EE; <a href="#t519.&#x542F;&#x52A8;&#x9879;&#x76EE;"> # </a></h2>
<h3 id="t529.1 Creator.js">9.1 Creator.js <a href="#t529.1 Creator.js"> # </a></h3>
<p>packages\create\lib\Creator.js</p>
<pre><code class="lang-diff">const { prompt } = require(&quot;inquirer&quot;);
const fs = require(&quot;fs-extra&quot;);
const { red } = require(&quot;chalk&quot;);
const userhome = require(&quot;userhome&quot;);
const {promisify} = require(&apos;util&apos;);
<span class="hljs-addition">+const execa = require(&quot;execa&quot;);</span>
const clone = promisify(require(&apos;clone-git-repo&apos;));
const PromptModuleAPI = require(&quot;./PromptModuleAPI&quot;);
const { log,config,withLoading ,request} = require(&quot;@vite100/utils&quot;);
const { TEMPLATES } = require(&quot;@vite100/settings&quot;);
const defaultFeaturePrompt = {
    name: &quot;features&quot;,
    type: &quot;checkbox&quot;,
    message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x9879;&#x76EE;&#x7279;&#x6027;:&quot;,
    choices: [],
}
class Creator {
    constructor(projectName, projectDir, promptModules) {
        this.projectName = projectName;//&#x9879;&#x76EE;&#x540D;&#x79F0;
        this.projectDir = projectDir;//&#x9879;&#x76EE;&#x8DEF;&#x5F84;
        this.featurePrompt = defaultFeaturePrompt;//&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x6846;
        this.injectedPrompts = [];//&#x63D2;&#x5165;&#x63D2;&#x5165;&#x7684;&#x9009;&#x62E9;&#x6846;
        this.promptCompleteCbs = [];//&#x9009;&#x62E9;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#x7684;&#x56DE;&#x8C03;
        const promptModuleAPI = new PromptModuleAPI(this);
        promptModules.forEach((module) =&gt; module(promptModuleAPI));
    }
    async create() {
        //&#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879;
        const projectOptions = (this.projectOptions = await this.promptAndResolve());
        console.log(&apos;projectOptions&apos;, projectOptions);
        //{historyMode: &apos;browser&apos;,appTitle: &apos;AppTitle&apos;}
        //&#x51C6;&#x5907;&#x9879;&#x76EE;&#x76EE;&#x5F55;
        await this.prepareProjectDir();
        //&#x4E0B;&#x8F7D;&#x6A21;&#x677F;&#xFF0C;&#x7ED9;templateDir&#x8D4B;&#x503C;
        await this.downloadTemplate();
         //&#x628A;&#x9879;&#x76EE;&#x62F7;&#x8D1D;&#x5230;&#x6A21;&#x677F;&#x4E2D;
<span class="hljs-addition">+       await fs.copy(this.templateDir, this.projectDir);</span>
<span class="hljs-addition">+        //&#x521D;&#x59CB;&#x5316;git&#x4ED3;&#x5E93;</span>
<span class="hljs-addition">+       await execa(&quot;git&quot;, [&quot;init&quot;], { cwd: this.projectDir, stdio: &quot;inherit&quot; });</span>
<span class="hljs-addition">+       log.info(&quot;vite100&quot;, &quot;&#x5728;%s&#x5B89;&#x88C5;&#x4F9D;&#x8D56;&quot;, this.projectDir);</span>
<span class="hljs-addition">+       await execa(&quot;npm&quot;, [&quot;install&quot;], { cwd: this.projectDir, stdio: &quot;inherit&quot; });</span>
    }
    async downloadTemplate() {
        const { GIT_TYPE, ORG_NAME } = config;
        let repos = await withLoading(&quot;&#x8BFB;&#x53D6;&#x6A21;&#x677F;&#x5217;&#x8868;&quot;, async () =&gt;
            request.get(`/orgs/${ORG_NAME}/repos`)
        );
        let { repo } = await prompt({
            name: &quot;repo&quot;,
            type: &quot;list&quot;,
            message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x6A21;&#x677F;&quot;,
            choices: repos.map((repo) =&gt; repo.name)
        });
        let tags = await withLoading(&quot;&#x8BFB;&#x53D6;&#x6807;&#x7B7E;&#x5217;&#x8868;&quot;, async () =&gt;
            request.get(`/repos/${ORG_NAME}/${repo}/tags`)
        );
        let { tag } = await prompt({
            name: &quot;tag&quot;,
            type: &quot;list&quot;,
            message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x7248;&#x672C;&quot;,
            choices: tags,
        });
        let repository = GIT_TYPE + `:${ORG_NAME}/${repo}`;
        if (tag) repository += `#${tag}`;
        const downloadDirectory = userhome(TEMPLATES);
        let templateDir = (this.templateDir = `${downloadDirectory}/${repo}/${tag}`);
        log.info(&quot;vite3&quot;, &quot;&#x51C6;&#x5907;&#x4E0B;&#x8F7D;&#x6A21;&#x677F;&#x5230;%s&quot;, templateDir);
        try {
            await fs.access(templateDir);
        } catch (error) {
            log.info(&quot;vite100&quot;, &quot;&#x4ECE;&#x4ED3;&#x5E93;&#x4E0B;&#x8F7D;%s&quot;, repository);
            await clone(repository, templateDir, { clone: true });
        }
    }
    async prepareProjectDir() {
        let { projectDir } = this;
        try {
            await fs.access(projectDir);
            const files = await fs.readdir(projectDir);
            if (files.length &gt; 0) {
                const { overwrite } = await prompt({
                    type: &quot;confirm&quot;,
                    name: &quot;overwrite&quot;,
                    message: `&#x76EE;&#x6807;&#x76EE;&#x5F55;&#x975E;&#x7A7A;&#xFF0C;&#x662F;&#x5426;&#x8981;&#x79FB;&#x9664;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x5E76;&#x7EE7;&#x7EED;?`,
                });
                if (overwrite) {
                    await fs.emptyDir(projectDir);
                } else {
                    throw new Error(red(&quot;X&quot;) + &quot; &#x64CD;&#x4F5C;&#x88AB;&#x53D6;&#x6D88;&quot;);
                }
            }
        } catch (error) {
            await fs.mkdirp(projectDir);
        }
        log.info(&quot;vite100&quot;, &quot;%s&#x76EE;&#x5F55;&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&quot;, projectDir);
    }
    async promptAndResolve() {
        let prompts = [this.featurePrompt, ...this.injectedPrompts];
        let answers = await prompt(prompts);
        let projectOptions = { plugins: {}, };
        this.promptCompleteCbs.forEach((cb) =&gt; cb(answers, projectOptions));
        return projectOptions;
    }
}
module.exports = Creator;
</code></pre>
<h3 id="t539.2 create\index.js">9.2 create\index.js <a href="#t539.2 create\index.js"> # </a></h3>
<p>packages\create\index.js</p>
<pre><code class="lang-diff">const path = require(&quot;path&quot;);
const { red } = require(&quot;chalk&quot;);
<span class="hljs-addition">+const execa = require(&quot;execa&quot;);</span>
const { config, log } = require(&quot;@vite100/utils&quot;);
const getPromptModules = require(&apos;./lib/getPromptModules&apos;);
const Creator = require(&apos;./lib/Creator&apos;);
async function create(argv) {
    const { workingDirectory, projectName } = argv;
    const { GIT_TYPE, ORG_NAME } = config;
    if (!GIT_TYPE) {
        throw new Error(red(&quot;X&quot;) + &quot; &#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x4ED3;&#x5E93;&#x7C7B;&#x578B;!&quot;);
    }
    if (!ORG_NAME) {
        throw new Error(red(&quot;X&quot;) + &quot; &#x5C1A;&#x672A;&#x914D;&#x7F6E;&#x7EC4;&#x7EC7;&#x540D;&#x79F0;!&quot;);
    }
    const projectDir = path.join(workingDirectory, projectName);
    log.info(&quot;vite100&quot;, &quot;&#x521B;&#x5EFA;&#x7684;&#x9879;&#x76EE;&#x76EE;&#x5F55;&#x4E3A;%s&quot;, projectDir);
    let promptModules = getPromptModules();
    console.info(&quot;&#x9009;&#x62E9;&#x9879;promptModules&quot;, promptModules);
    let creator = new Creator(projectName, projectDir, promptModules);
    await creator.create();
<span class="hljs-addition">+   log.info(&quot;vite100&quot;, &quot;&#x542F;&#x52A8;&#x670D;&#x52A1;&quot;);</span>
<span class="hljs-addition">+   await execa(&quot;npm&quot;, [&quot;run&quot;, &quot;dev&quot;], { cwd: projectDir, stdio: &quot;inherit&quot; });</span>
}
module.exports = (...args) =&gt; {
    return create(...args).catch(err =&gt; {
        console.error(err);
    });
};
</code></pre>
<h2 id="t5410.&#x6DFB;&#x52A0;&#x8DEF;&#x7531;&#x63D2;&#x4EF6;">10.&#x6DFB;&#x52A0;&#x8DEF;&#x7531;&#x63D2;&#x4EF6; <a href="#t5410.&#x6DFB;&#x52A0;&#x8DEF;&#x7531;&#x63D2;&#x4EF6;"> # </a></h2>
<h3 id="t5510.1 router.js">10.1 router.js <a href="#t5510.1 router.js"> # </a></h3>
<p>packages\create\lib\promptModules\router.js</p>
<pre><code class="lang-diff">module.exports = cli =&gt; {
    cli.injectFeature({
        name: &apos;Router&apos;,
        value: &apos;router&apos;,
        description: &apos;&#x8BF7;&#x9009;&#x62E9;&#x8DEF;&#x7531;&#x6A21;&#x5F0F;&apos;,
        link: &apos;https://www.npmjs.com/package/react-router-dom&apos;
    })
    cli.injectPrompt({
        name: &apos;historyMode&apos;,
        when: answers =&gt; answers.features.includes(&apos;router&apos;),
        message: &apos;&#x8BF7;&#x9009;&#x62E9;history&#x7684;&#x6A21;&#x5F0F;&apos;,
        type: &apos;list&apos;,
        choices: [
            {
                name: &apos;hash&apos;,
                value: &apos;hash&apos;
            },
            {
                name: &apos;browser&apos;,
                value: &apos;browser&apos;
            }
        ],
        default: &apos;browser&apos;
    })
    cli.injectPrompt({
        name: &apos;appTitle&apos;,
        when: answers =&gt; answers.features.includes(&apos;router&apos;),
        message: &apos;&#x8BF7;&#x8F93;&#x5165;&#x6839;&#x7EC4;&#x4EF6;&#x7684;&#x6807;&#x9898;&apos;,
        type: &apos;text&apos;,
        default: &apos;AppTitle&apos;
    })
    cli.onPromptComplete((answers, projectOptions) =&gt; {
        if (answers.features.includes(&apos;router&apos;)) {
<span class="hljs-addition">+            projectOptions.plugins[&apos;cli-plugin-router&apos;] = {</span>
<span class="hljs-addition">+                historyMode: answers.historyMode</span>
<span class="hljs-addition">+            }</span>
            projectOptions.historyMode =answers.historyMode;
            projectOptions.appTitle=answers.appTitle;
        }
    })
}
</code></pre>
<h3 id="t5610.2 Creator.js">10.2 Creator.js <a href="#t5610.2 Creator.js"> # </a></h3>
<p>packages\create\lib\Creator.js</p>
<pre><code class="lang-diff">const { prompt } = require(&quot;inquirer&quot;);
<span class="hljs-addition">+const path = require(&quot;path&quot;);</span>
const fs = require(&quot;fs-extra&quot;);
const { red } = require(&quot;chalk&quot;);
const userhome = require(&quot;userhome&quot;);
const {promisify} = require(&apos;util&apos;);
const execa = require(&quot;execa&quot;);
const clone = promisify(require(&apos;clone-git-repo&apos;));
const PromptModuleAPI = require(&quot;./PromptModuleAPI&quot;);
const { log,config,withLoading ,request} = require(&quot;@vite100/utils&quot;);
const { TEMPLATES } = require(&quot;@vite100/settings&quot;);
const defaultFeaturePrompt = {
    name: &quot;features&quot;,
    type: &quot;checkbox&quot;,
    message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x9879;&#x76EE;&#x7279;&#x6027;:&quot;,
    choices: [],
}
class Creator {
    constructor(projectName, projectDir, promptModules) {
        this.projectName = projectName;//&#x9879;&#x76EE;&#x540D;&#x79F0;
        this.projectDir = projectDir;//&#x9879;&#x76EE;&#x8DEF;&#x5F84;
        this.featurePrompt = defaultFeaturePrompt;//&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x6846;
        this.injectedPrompts = [];//&#x63D2;&#x5165;&#x63D2;&#x5165;&#x7684;&#x9009;&#x62E9;&#x6846;
        this.promptCompleteCbs = [];//&#x9009;&#x62E9;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#x7684;&#x56DE;&#x8C03;
<span class="hljs-addition">+       this.plugins = [];//&#x63D2;&#x4EF6;</span>
        const promptModuleAPI = new PromptModuleAPI(this);
        promptModules.forEach((module) =&gt; module(promptModuleAPI));
    }
    async create() {
        //&#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879;
        const projectOptions = (this.projectOptions = await this.promptAndResolve());
        console.log(&apos;projectOptions&apos;, projectOptions);
        //{historyMode: &apos;browser&apos;,appTitle: &apos;AppTitle&apos;}
        //&#x51C6;&#x5907;&#x9879;&#x76EE;&#x76EE;&#x5F55;
        await this.prepareProjectDir();
        //&#x4E0B;&#x8F7D;&#x6A21;&#x677F;&#xFF0C;&#x7ED9;templateDir&#x8D4B;&#x503C;
        await this.downloadTemplate();
         //&#x628A;&#x9879;&#x76EE;&#x62F7;&#x8D1D;&#x5230;&#x6A21;&#x677F;&#x4E2D;
        await fs.copy(this.templateDir, this.projectDir);
<span class="hljs-addition">+       const pkgPath = path.join(this.projectDir, &apos;package.json&apos;);</span>
<span class="hljs-addition">+       let pkg = (this.pkg = await fs.readJSON(pkgPath));</span>
<span class="hljs-addition">+       const deps = Reflect.ownKeys(projectOptions.plugins);</span>
<span class="hljs-addition">+       deps.forEach(dep =&gt; pkg.devDependencies[dep] = `latest`);</span>
<span class="hljs-addition">+       await fs.writeJSON(pkgPath,pkg,{spaces:2});</span>
         //&#x521D;&#x59CB;&#x5316;git&#x4ED3;&#x5E93;
        await execa(&quot;git&quot;, [&quot;init&quot;], { cwd: this.projectDir, stdio: &quot;inherit&quot; });
        log.info(&quot;vite100&quot;, &quot;&#x5728;%s&#x5B89;&#x88C5;&#x4F9D;&#x8D56;&quot;, this.projectDir);
        await execa(&quot;npm&quot;, [&quot;install&quot;], { cwd: this.projectDir, stdio: &quot;inherit&quot; });

    }
    async downloadTemplate() {
        const { GIT_TYPE, ORG_NAME } = config;
        let repos = await withLoading(&quot;&#x8BFB;&#x53D6;&#x6A21;&#x677F;&#x5217;&#x8868;&quot;, async () =&gt;
            request.get(`/orgs/${ORG_NAME}/repos`)
        );
        let { repo } = await prompt({
            name: &quot;repo&quot;,
            type: &quot;list&quot;,
            message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x6A21;&#x677F;&quot;,
            choices: repos.map((repo) =&gt; repo.name)
        });
        let tags = await withLoading(&quot;&#x8BFB;&#x53D6;&#x6807;&#x7B7E;&#x5217;&#x8868;&quot;, async () =&gt;
            request.get(`/repos/${ORG_NAME}/${repo}/tags`)
        );
        let { tag } = await prompt({
            name: &quot;tag&quot;,
            type: &quot;list&quot;,
            message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x7248;&#x672C;&quot;,
            choices: tags,
        });
        let repository = GIT_TYPE + `:${ORG_NAME}/${repo}`;
        if (tag) repository += `#${tag}`;
        const downloadDirectory = userhome(TEMPLATES);
        let templateDir = (this.templateDir = `${downloadDirectory}/${repo}/${tag}`);
        log.info(&quot;vite3&quot;, &quot;&#x51C6;&#x5907;&#x4E0B;&#x8F7D;&#x6A21;&#x677F;&#x5230;%s&quot;, templateDir);
        try {
            await fs.access(templateDir);
        } catch (error) {
            log.info(&quot;vite100&quot;, &quot;&#x4ECE;&#x4ED3;&#x5E93;&#x4E0B;&#x8F7D;%s&quot;, repository);
            await clone(repository, templateDir, { clone: true });
        }
    }
    async prepareProjectDir() {
        let { projectDir } = this;
        try {
            await fs.access(projectDir);
            const files = await fs.readdir(projectDir);
            if (files.length &gt; 0) {
                const { overwrite } = await prompt({
                    type: &quot;confirm&quot;,
                    name: &quot;overwrite&quot;,
                    message: `&#x76EE;&#x6807;&#x76EE;&#x5F55;&#x975E;&#x7A7A;&#xFF0C;&#x662F;&#x5426;&#x8981;&#x79FB;&#x9664;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x5E76;&#x7EE7;&#x7EED;?`,
                });
                if (overwrite) {
                    await fs.emptyDir(projectDir);
                } else {
                    throw new Error(red(&quot;X&quot;) + &quot; &#x64CD;&#x4F5C;&#x88AB;&#x53D6;&#x6D88;&quot;);
                }
            }
        } catch (error) {
            await fs.mkdirp(projectDir);
        }
        log.info(&quot;vite100&quot;, &quot;%s&#x76EE;&#x5F55;&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&quot;, projectDir);
    }
    async promptAndResolve() {
        let prompts = [this.featurePrompt, ...this.injectedPrompts];
        let answers = await prompt(prompts);
        let projectOptions = { plugins: {}, };
        this.promptCompleteCbs.forEach((cb) =&gt; cb(answers, projectOptions));
        return projectOptions;
    }
}
module.exports = Creator;
</code></pre>
<h2 id="t5711. &#x89E3;&#x6790;&#x5E76;&#x5E94;&#x7528;&#x63D2;&#x4EF6;">11. &#x89E3;&#x6790;&#x5E76;&#x5E94;&#x7528;&#x63D2;&#x4EF6; <a href="#t5711. &#x89E3;&#x6790;&#x5E76;&#x5E94;&#x7528;&#x63D2;&#x4EF6;"> # </a></h2>
<h3 id="t5811.1 mergeDeps.js">11.1 mergeDeps.js <a href="#t5811.1 mergeDeps.js"> # </a></h3>
<p>packages\utils\mergeDeps.js</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeDeps</span>(<span class="hljs-params">sourceDeps, depsToInject</span>)</span>{
    <span class="hljs-keyword">let</span> result = <span class="hljs-built_in">Object</span>.assign({}, sourceDeps);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> depName <span class="hljs-keyword">in</span> depsToInject) {
        result[depName] = depsToInject[depName];
    }
    <span class="hljs-keyword">return</span> result;
}
<span class="hljs-built_in">module</span>.exports = mergeDeps;
</code></pre>
<h3 id="t5911.2 loadModule.js">11.2 loadModule.js <a href="#t5911.2 loadModule.js"> # </a></h3>
<p>packages\utils\loadModule.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;path&apos;</span>);
<span class="hljs-keyword">const</span> Module = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;module&apos;</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadModule</span>(<span class="hljs-params">request,context</span>)</span>{
  <span class="hljs-keyword">return</span> Module.createRequire(path.resolve(context,<span class="hljs-string">&apos;package.json&apos;</span>))(request);
}
<span class="hljs-built_in">module</span>.exports = loadModule;
</code></pre>
<h3 id="t6011.3 extractCallDir.js">11.3 extractCallDir.js <a href="#t6011.3 extractCallDir.js"> # </a></h3>
<p>packages\utils\extractCallDir.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;path&apos;</span>);
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">extractCallDir</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">const</span> obj = {}
    <span class="hljs-built_in">Error</span>.captureStackTrace(obj)
    <span class="hljs-keyword">const</span> callSite = obj.stack.split(<span class="hljs-string">&apos;\n&apos;</span>)[<span class="hljs-number">3</span>]
    <span class="hljs-keyword">const</span> namedStackRegExp = <span class="hljs-regexp">/\s\((.*):\d+:\d+\)$/</span>
    <span class="hljs-keyword">let</span> matchResult = callSite.match(namedStackRegExp)
    <span class="hljs-keyword">const</span> fileName = matchResult[<span class="hljs-number">1</span>]
    <span class="hljs-keyword">return</span> path.dirname(fileName)
}
<span class="hljs-built_in">module</span>.exports = extractCallDir;
</code></pre>
<h3 id="t6111.4 writeFileTree.js">11.4 writeFileTree.js <a href="#t6111.4 writeFileTree.js"> # </a></h3>
<p>packages\utils\writeFileTree.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;path&apos;</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;fs-extra&apos;</span>);
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeFileTree</span>(<span class="hljs-params">projectDir, files</span>) </span>{
    <span class="hljs-built_in">Object</span>.keys(files).forEach(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> {
        <span class="hljs-keyword">let</span> content = files[file];
        <span class="hljs-keyword">if</span> (file.endsWith(<span class="hljs-string">&apos;.ejs&apos;</span>)) file = file.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-4</span>);
        <span class="hljs-keyword">const</span> filePath = path.join(projectDir, file);
        fs.ensureDirSync(path.dirname(filePath));<span class="hljs-comment">//&#x5148;&#x786E;&#x4FDD;&#x6587;&#x4EF6;&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55; &#x662F;&#x5B58;&#x5728;</span>
        fs.writeFileSync(filePath,content);
    });
}

<span class="hljs-built_in">module</span>.exports = writeFileTree;
</code></pre>
<h3 id="t6211.5 utils\index.js">11.5 utils\index.js <a href="#t6211.5 utils\index.js"> # </a></h3>
<p>packages\utils\index.js</p>
<pre><code class="lang-diff"><span class="hljs-addition">+const path = require(&apos;path&apos;);</span>
exports.log = require(&apos;./log&apos;);
exports.executeNodeScript = require(&apos;./executeNodeScript&apos;);
exports.config = require(&apos;./config&apos;);
exports.withLoading = require(&apos;./withLoading&apos;);
exports.request = require(&apos;./request&apos;);
<span class="hljs-addition">+exports.loadModule = require(&apos;./loadModule&apos;);</span>
<span class="hljs-addition">+exports.mergeDeps = require(&apos;./mergeDeps&apos;);</span>
<span class="hljs-addition">+exports.extractCallDir = require(&apos;./extractCallDir&apos;);</span>
<span class="hljs-addition">+exports.writeFileTree = require(&apos;./writeFileTree&apos;);</span>
<span class="hljs-addition">+exports.isObject = val =&gt; typeof val === &apos;object&apos;;</span>
<span class="hljs-addition">+exports.isString = val =&gt; typeof val === &apos;string&apos;;</span>
</code></pre>
<h3 id="t6311.6 GeneratorAPI.js">11.6 GeneratorAPI.js <a href="#t6311.6 GeneratorAPI.js"> # </a></h3>
<p>packages\create\lib\GeneratorAPI.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;fs&apos;</span>);
<span class="hljs-keyword">const</span> ejs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;ejs&apos;</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;path&apos;</span>);
<span class="hljs-keyword">const</span> { promisify } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;util&apos;</span>);
<span class="hljs-keyword">const</span> glob = promisify(<span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;glob&apos;</span>));
<span class="hljs-keyword">const</span> { isBinaryFile } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;isbinaryfile&apos;</span>);
<span class="hljs-keyword">const</span> { runTransformation } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;vue-codemod&apos;</span>)
<span class="hljs-keyword">const</span> { isObject, isString, extractCallDir, mergeDeps } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;@vite100/utils&quot;</span>);
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GeneratorAPI</span> </span>{
    <span class="hljs-keyword">constructor</span>(id, creator, projectOptions) {
        <span class="hljs-keyword">this</span>.id = id;
        <span class="hljs-keyword">this</span>.creator = creator;
        <span class="hljs-keyword">this</span>.projectOptions = projectOptions;
    }
    <span class="hljs-comment">//&#x63D2;&#x5165;&#x6587;&#x4EF6;&#x5904;&#x7406;&#x4E2D;&#x95F4;&#x4EF6;</span>
    <span class="hljs-keyword">async</span> _injectFileMiddleware(middleware) {
        <span class="hljs-keyword">this</span>.creator.fileMiddlewares.push(middleware);
    }
    <span class="hljs-comment">//&#x6E32;&#x67D3;&#x62F7;&#x8D1D;&#x6587;&#x4EF6;</span>
    render(source) {
        <span class="hljs-keyword">const</span> baseDir = extractCallDir();
        <span class="hljs-keyword">if</span> (isString(source)) {
            source = path.resolve(baseDir, source)
            <span class="hljs-keyword">this</span>._injectFileMiddleware(<span class="hljs-keyword">async</span> (files, projectOptions) =&gt; {
                <span class="hljs-keyword">const</span> templateFiles = <span class="hljs-keyword">await</span> glob(<span class="hljs-string">&apos;**/*&apos;</span>, { <span class="hljs-attr">cwd</span>: source, <span class="hljs-attr">nodir</span>: <span class="hljs-literal">true</span> });
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; templateFiles.length; i++) {
                    <span class="hljs-keyword">let</span> templateFile = templateFiles[i];
                    files[templateFile] = <span class="hljs-keyword">await</span> renderFile(path.resolve(source, templateFile), projectOptions);
                }
            });
        }
    }
    <span class="hljs-comment">//&#x6269;&#x5C55;&#x4F9D;&#x8D56;&#x5305;</span>
    extendPackage(toMerge) {
        <span class="hljs-keyword">const</span> pkg = <span class="hljs-keyword">this</span>.creator.pkg;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> toMerge) {
            <span class="hljs-keyword">const</span> value = toMerge[key];
            <span class="hljs-keyword">let</span> existing = pkg[key];
            <span class="hljs-keyword">if</span> (isObject(value) &amp;&amp; (key === <span class="hljs-string">&apos;dependencies&apos;</span> || key === <span class="hljs-string">&apos;devDependencies&apos;</span>)) {
                pkg[key] = mergeDeps(existing || {}, value);
            } <span class="hljs-keyword">else</span> {
                pkg[key] = value;
            }
        }
    }
    <span class="hljs-comment">//&#x8F6C;&#x8BD1;&#x811A;&#x672C;</span>
    transformScript(file, codemod, projectOptions = {}) {
        <span class="hljs-keyword">this</span>._injectFileMiddleware(<span class="hljs-function">(<span class="hljs-params">files</span>) =&gt;</span> {
            files[file] = runTransformation(
                {
                    <span class="hljs-attr">path</span>: file,
                    <span class="hljs-attr">source</span>: files[file]
                },
                codemod,
                projectOptions
            )
        })
    }
    <span class="hljs-comment">//&#x63D2;&#x5165;&#x5BFC;&#x5165;&#x8BED;&#x53E5;</span>
    injectImport(file, newImport) {
        <span class="hljs-keyword">const</span> imports = (<span class="hljs-keyword">this</span>.creator.imports[file] = <span class="hljs-keyword">this</span>.creator.imports[file] || []);
        imports.push(newImport)
    }
    <span class="hljs-comment">//&#x5165;&#x53E3;&#x6587;&#x4EF6;&#x7684;&#x8DEF;&#x5F84;</span>
    <span class="hljs-keyword">get</span> entryFile() {
        <span class="hljs-keyword">return</span> <span class="hljs-string">&apos;src/index.js&apos;</span>;
    }
}
<span class="hljs-comment">//&#x6E32;&#x67D3;&#x6587;&#x4EF6;</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderFile</span>(<span class="hljs-params">templatePath, projectOptions</span>) </span>{
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">await</span> isBinaryFile(templatePath)) {
        <span class="hljs-keyword">return</span> fs.readFileSync(templatePath);
    }
    <span class="hljs-keyword">let</span> template = fs.readFileSync(templatePath, <span class="hljs-string">&apos;utf8&apos;</span>);
    <span class="hljs-keyword">return</span> ejs.render(template, projectOptions);
}

<span class="hljs-built_in">module</span>.exports = GeneratorAPI;
</code></pre>
<h3 id="t6411.7 injectImports.js">11.7 injectImports.js <a href="#t6411.7 injectImports.js"> # </a></h3>
<p>packages\create\lib\codemods\injectImports.js</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">injectImports</span>(<span class="hljs-params">fileInfo, api, { imports }</span>) </span>{
    <span class="hljs-keyword">const</span> jscodeshift = api.jscodeshift
    <span class="hljs-keyword">const</span> root = jscodeshift(fileInfo.source)
    <span class="hljs-keyword">const</span> declarations = root.find(jscodeshift.ImportDeclaration)
    <span class="hljs-keyword">const</span> toImportAST = <span class="hljs-function"><span class="hljs-params">imp</span> =&gt;</span> jscodeshift(<span class="hljs-string">`<span class="hljs-subst">${imp}</span>\n`</span>).nodes()[<span class="hljs-number">0</span>].program.body[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">const</span> importASTNodes = imports.map(toImportAST);
    <span class="hljs-keyword">if</span> (declarations.length) {
        declarations.at(<span class="hljs-number">-1</span>).insertAfter(importASTNodes)
    } <span class="hljs-keyword">else</span> {
        root.get().node.program.body.unshift(...importASTNodes)
    }
    <span class="hljs-keyword">return</span> root.toSource()
}

<span class="hljs-built_in">module</span>.exports = injectImports;
</code></pre>
<h3 id="t6511.8 Creator.js">11.8 Creator.js <a href="#t6511.8 Creator.js"> # </a></h3>
<p>packages\create\lib\Creator.js</p>
<pre><code class="lang-diff">const { prompt } = require(&quot;inquirer&quot;);
const path = require(&quot;path&quot;);
const fs = require(&quot;fs-extra&quot;);
const { red } = require(&quot;chalk&quot;);
const userhome = require(&quot;userhome&quot;);
const {promisify} = require(&apos;util&apos;);
const execa = require(&quot;execa&quot;);
<span class="hljs-addition">+const glob = promisify(require(&apos;glob&apos;));</span>
const clone = promisify(require(&apos;clone-git-repo&apos;));
<span class="hljs-addition">+const { runTransformation } = require(&apos;vue-codemod&apos;)</span>
const PromptModuleAPI = require(&quot;./PromptModuleAPI&quot;);
<span class="hljs-addition">+const GeneratorAPI = require(&apos;./GeneratorAPI&apos;);</span>
<span class="hljs-addition">+const { isBinaryFile } = require(&apos;isbinaryfile&apos;);</span>
<span class="hljs-addition">+const { log,config,withLoading ,request,loadModule,writeFileTree} = require(&quot;@vite100/utils&quot;);</span>
const { TEMPLATES } = require(&quot;@vite100/settings&quot;);
const defaultFeaturePrompt = {
    name: &quot;features&quot;,
    type: &quot;checkbox&quot;,
    message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x9879;&#x76EE;&#x7279;&#x6027;:&quot;,
    choices: [],
}
class Creator {
    constructor(projectName, projectDir, promptModules) {
        this.projectName = projectName;//&#x9879;&#x76EE;&#x540D;&#x79F0;
        this.projectDir = projectDir;//&#x9879;&#x76EE;&#x8DEF;&#x5F84;
        this.featurePrompt = defaultFeaturePrompt;//&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x6846;
        this.injectedPrompts = [];//&#x63D2;&#x5165;&#x63D2;&#x5165;&#x7684;&#x9009;&#x62E9;&#x6846;
        this.promptCompleteCbs = [];//&#x9009;&#x62E9;&#x7ED3;&#x675F;&#x4E4B;&#x540E;&#x7684;&#x56DE;&#x8C03;
        this.plugins = [];//&#x63D2;&#x4EF6;
<span class="hljs-addition">+       this.fileMiddlewares = [];//&#x6587;&#x4EF6;&#x4E2D;&#x95F4;&#x4EF6;</span>
<span class="hljs-addition">+       this.files = {};//&#x6700;&#x7EC8;&#x8F93;&#x51FA;&#x7684;&#x6587;&#x4EF6;&#x5217;&#x8868;</span>
<span class="hljs-addition">+       this.pkg = {};//&#x6211;&#x63CF;&#x8FF0;&#x5185;&#x5BB9;</span>
<span class="hljs-addition">+       this.imports={};//&#x989D;&#x5916;&#x7684;&#x5BFC;&#x5165;&#x8BED;&#x53E5;</span>
        const promptModuleAPI = new PromptModuleAPI(this);
        promptModules.forEach((module) =&gt; module(promptModuleAPI));
    }
    async create() {
        //&#x83B7;&#x53D6;&#x9009;&#x62E9;&#x9879;
        const projectOptions = (this.projectOptions = await this.promptAndResolve());
        console.log(&apos;projectOptions&apos;, projectOptions);
        //{historyMode: &apos;browser&apos;,appTitle: &apos;AppTitle&apos;}
        //&#x51C6;&#x5907;&#x9879;&#x76EE;&#x76EE;&#x5F55;
        await this.prepareProjectDir();
        //&#x4E0B;&#x8F7D;&#x6A21;&#x677F;&#xFF0C;&#x7ED9;templateDir&#x8D4B;&#x503C;
        await this.downloadTemplate();
         //&#x628A;&#x9879;&#x76EE;&#x62F7;&#x8D1D;&#x5230;&#x6A21;&#x677F;&#x4E2D;
        await fs.copy(this.templateDir, this.projectDir);
        const pkgPath = path.join(this.projectDir, &apos;package.json&apos;);
        let pkg = (this.pkg = await fs.readJSON(pkgPath));
        const deps = Reflect.ownKeys(projectOptions.plugins);
        deps.forEach(dep =&gt; pkg.devDependencies[dep] = `latest`);
        await fs.writeJSON(pkgPath,pkg,{spaces:2});
         //&#x521D;&#x59CB;&#x5316;git&#x4ED3;&#x5E93;
        await execa(&quot;git&quot;, [&quot;init&quot;], { cwd: this.projectDir, stdio: &quot;inherit&quot; });
        log.info(&quot;vite100&quot;, &quot;&#x5728;%s&#x5B89;&#x88C5;&#x4F9D;&#x8D56;&quot;, this.projectDir);
        await execa(&quot;npm&quot;, [&quot;install&quot;], { cwd: this.projectDir, stdio: &quot;inherit&quot; });
<span class="hljs-addition">+       //&#x89E3;&#x6790;&#x63D2;&#x4EF6;,&#x62FF;&#x5230;&#x63D2;&#x4EF6;&#x7684;generator&#x65B9;&#x6CD5;</span>
<span class="hljs-addition">+       const resolvedPlugins = await this.resolvePlugins(projectOptions.plugins);</span>
<span class="hljs-addition">+       //&#x5E94;&#x7528;&#x63D2;&#x4EF6;</span>
<span class="hljs-addition">+       await this.applyPlugins(resolvedPlugins);</span>
<span class="hljs-addition">+       await this.initFiles();</span>
<span class="hljs-addition">+       //&#x51C6;&#x5907;&#x6587;&#x4EF6;&#x5185;&#x5BB9;</span>
<span class="hljs-addition">+       await this.renderFiles();</span>
<span class="hljs-addition">+       //&#x5220;&#x9664;&#x63D2;&#x4EF6;&#x7684;&#x4F9D;&#x8D56;</span>
<span class="hljs-addition">+       deps.forEach(dep =&gt;  delete pkg.devDependencies[dep]);</span>
<span class="hljs-addition">+       this.files[&apos;package.json&apos;] = JSON.stringify(pkg,null,2);</span>
<span class="hljs-addition">+       //&#x628A;&#x6587;&#x4EF6;&#x5199;&#x5165;&#x786C;&#x76D8;</span>
<span class="hljs-addition">+       await writeFileTree(this.projectDir, this.files);</span>
<span class="hljs-addition">+       //&#x91CD;&#x65B0;&#x5B89;&#x88C5;&#x989D;&#x5916;&#x7684;&#x4F9D;&#x8D56;</span>
<span class="hljs-addition">+       await execa(&quot;npm&quot;, [&quot;install&quot;], { cwd: this.projectDir, stdio: &quot;inherit&quot; });</span>
    }
<span class="hljs-addition">+   async initFiles(){</span>
<span class="hljs-addition">+       const projectFiles = await glob(&apos;**/*&apos;, { cwd: this.projectDir, nodir: true });</span>
<span class="hljs-addition">+       for (let i = 0; i &lt; projectFiles.length; i++) {</span>
<span class="hljs-addition">+           let projectFile = projectFiles[i];</span>
<span class="hljs-addition">+           let projectFilePath = path.join(this.projectDir,projectFile);</span>
<span class="hljs-addition">+           let content;</span>
<span class="hljs-addition">+           if (await isBinaryFile(projectFilePath)) {</span>
<span class="hljs-addition">+               content =  await fs.readFile(projectFilePath);</span>
<span class="hljs-addition">+           }else{</span>
<span class="hljs-addition">+               content =  await fs.readFile(projectFilePath,&apos;utf8&apos;);</span>
<span class="hljs-addition">+           }</span>
<span class="hljs-addition">+           this.files[projectFile] = content;</span>
<span class="hljs-addition">+       }</span>
<span class="hljs-addition">+   }</span>
<span class="hljs-addition">+    async renderFiles() {</span>
<span class="hljs-addition">+        const {files,projectOptions} = this;</span>
<span class="hljs-addition">+        for (const middleware of this.fileMiddlewares) {</span>
<span class="hljs-addition">+          await middleware(files,projectOptions);</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+        Object.keys(files).forEach(file =&gt; {</span>
<span class="hljs-addition">+          let imports = this.imports[file]</span>
<span class="hljs-addition">+          if (imports &amp;&amp; imports.length &gt; 0) {</span>
<span class="hljs-addition">+            files[file] = runTransformation(</span>
<span class="hljs-addition">+              { path: file, source: files[file] },</span>
<span class="hljs-addition">+              require(&apos;./codemods/injectImports&apos;),</span>
<span class="hljs-addition">+              { imports }</span>
<span class="hljs-addition">+            )</span>
<span class="hljs-addition">+          }</span>
<span class="hljs-addition">+        })</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+    async resolvePlugins(rawPlugins) {</span>
<span class="hljs-addition">+        const plugins = [];</span>
<span class="hljs-addition">+        for (const id of Reflect.ownKeys(rawPlugins)) {</span>
<span class="hljs-addition">+          const apply = loadModule(`${id}/generator`, this.projectDir);</span>
<span class="hljs-addition">+          let options = rawPlugins[id];</span>
<span class="hljs-addition">+          plugins.push({ id, apply, options });</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+        return plugins;</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+    async applyPlugins(plugins) {</span>
<span class="hljs-addition">+        for (const plugin of plugins) {</span>
<span class="hljs-addition">+          const { id, apply, options } = plugin;</span>
<span class="hljs-addition">+          const generatorAPI = new GeneratorAPI(id, this, options);</span>
<span class="hljs-addition">+          await apply(generatorAPI, options);</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+      }</span>
    async downloadTemplate() {
        const { GIT_TYPE, ORG_NAME } = config;
        let repos = await withLoading(&quot;&#x8BFB;&#x53D6;&#x6A21;&#x677F;&#x5217;&#x8868;&quot;, async () =&gt;
            request.get(`/orgs/${ORG_NAME}/repos`)
        );
        let { repo } = await prompt({
            name: &quot;repo&quot;,
            type: &quot;list&quot;,
            message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x6A21;&#x677F;&quot;,
            choices: repos.map((repo) =&gt; repo.name)
        });
        let tags = await withLoading(&quot;&#x8BFB;&#x53D6;&#x6807;&#x7B7E;&#x5217;&#x8868;&quot;, async () =&gt;
            request.get(`/repos/${ORG_NAME}/${repo}/tags`)
        );
        let { tag } = await prompt({
            name: &quot;tag&quot;,
            type: &quot;list&quot;,
            message: &quot;&#x8BF7;&#x9009;&#x62E9;&#x7248;&#x672C;&quot;,
            choices: tags,
        });
        let repository = GIT_TYPE + `:${ORG_NAME}/${repo}`;
        if (tag) repository += `#${tag}`;
        const downloadDirectory = userhome(TEMPLATES);
        let templateDir = (this.templateDir = `${downloadDirectory}/${repo}/${tag}`);
        log.info(&quot;vite3&quot;, &quot;&#x51C6;&#x5907;&#x4E0B;&#x8F7D;&#x6A21;&#x677F;&#x5230;%s&quot;, templateDir);
        try {
            await fs.access(templateDir);
        } catch (error) {
            log.info(&quot;vite100&quot;, &quot;&#x4ECE;&#x4ED3;&#x5E93;&#x4E0B;&#x8F7D;%s&quot;, repository);
            await clone(repository, templateDir, { clone: true });
        }
    }
    async prepareProjectDir() {
        let { projectDir } = this;
        try {
            await fs.access(projectDir);
            const files = await fs.readdir(projectDir);
            if (files.length &gt; 0) {
                const { overwrite } = await prompt({
                    type: &quot;confirm&quot;,
                    name: &quot;overwrite&quot;,
                    message: `&#x76EE;&#x6807;&#x76EE;&#x5F55;&#x975E;&#x7A7A;&#xFF0C;&#x662F;&#x5426;&#x8981;&#x79FB;&#x9664;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#x5E76;&#x7EE7;&#x7EED;?`,
                });
                if (overwrite) {
                    await fs.emptyDir(projectDir);
                } else {
                    throw new Error(red(&quot;X&quot;) + &quot; &#x64CD;&#x4F5C;&#x88AB;&#x53D6;&#x6D88;&quot;);
                }
            }
        } catch (error) {
            await fs.mkdirp(projectDir);
        }
        log.info(&quot;vite100&quot;, &quot;%s&#x76EE;&#x5F55;&#x5DF2;&#x7ECF;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&quot;, projectDir);
    }
    async promptAndResolve() {
        let prompts = [this.featurePrompt, ...this.injectedPrompts];
        let answers = await prompt(prompts);
        let projectOptions = { plugins: {}, };
        this.promptCompleteCbs.forEach((cb) =&gt; cb(answers, projectOptions));
        return projectOptions;
    }
}
module.exports = Creator;
</code></pre>
<h2 id="t6612. &#x5B9E;&#x73B0;&#x63D2;&#x4EF6;">12. &#x5B9E;&#x73B0;&#x63D2;&#x4EF6; <a href="#t6612. &#x5B9E;&#x73B0;&#x63D2;&#x4EF6;"> # </a></h2>
<h3 id="t6712.1 App.js.ejs">12.1 App.js.ejs <a href="#t6712.1 App.js.ejs"> # </a></h3>
<p>packages\cli-plugin-router\template\src\App.js.ejs</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">%=appTitle%</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> App;
</code></pre>
<h3 id="t6812.2 routesConfig.js">12.2 routesConfig.js <a href="#t6812.2 routesConfig.js"> # </a></h3>
<p>packages\cli-plugin-router\template\src\routesConfig.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./App&apos;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> [
    {
        <span class="hljs-attr">path</span>: <span class="hljs-string">&apos;/&apos;</span>,
        <span class="hljs-attr">component</span>: App
    }
]
</code></pre>
<h3 id="t6912.3  generator.js">12.3  generator.js <a href="#t6912.3  generator.js"> # </a></h3>
<p>packages\cli-plugin-router\generator.js</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> (api, options) =&gt; {
    api.render(<span class="hljs-string">&apos;./template&apos;</span>);
    api.injectImport(api.entryFile,
        <span class="hljs-string">`import {<span class="hljs-subst">${options.historyMode === <span class="hljs-string">&apos;hash&apos;</span> ? <span class="hljs-string">&apos;HashRouter&apos;</span> : <span class="hljs-string">&apos;BrowserRouter&apos;</span>}</span> as Router,Route} from &apos;react-router-dom&apos;`</span>);
    api.injectImport(api.entryFile,
        <span class="hljs-string">`import routesConfig from &apos;./routesConfig&apos;`</span>);
    api.injectImport(api.entryFile,
        <span class="hljs-string">`import { renderRoutes } from &quot;react-router-config&quot;`</span>);
    api.transformScript(api.entryFile, <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;./injectRouter&apos;</span>))
    api.extendPackage({
        <span class="hljs-attr">dependencies</span>: {
            <span class="hljs-string">&apos;react-router-dom&apos;</span>: <span class="hljs-string">&apos;latest&apos;</span>,
            <span class="hljs-string">&apos;react-router-config&apos;</span>: <span class="hljs-string">&apos;latest&apos;</span>
        }
    });
}
</code></pre>
<h3 id="t7012.4 injectRouter.js">12.4 injectRouter.js <a href="#t7012.4 injectRouter.js"> # </a></h3>
<p>packages\cli-plugin-router\injectRouter.js</p>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function">(<span class="hljs-params">file, api</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> jscodeshift = api.jscodeshift
    <span class="hljs-keyword">const</span> root = jscodeshift(file.source)
    <span class="hljs-keyword">const</span> appImportDeclaration = root.find(jscodeshift.ImportDeclaration, (node) =&gt; {
        <span class="hljs-keyword">if</span>(node.specifiers[<span class="hljs-number">0</span>].local.name === <span class="hljs-string">&apos;App&apos;</span>){
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
        }
    })
    <span class="hljs-keyword">if</span>(appImportDeclaration)
        appImportDeclaration.remove();

    <span class="hljs-keyword">const</span> appJSXElement = root.find(jscodeshift.JSXElement, (node) =&gt; {
        <span class="hljs-keyword">if</span> (node.openingElement.name.name === <span class="hljs-string">&apos;App&apos;</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
        }
    })
    <span class="hljs-keyword">if</span>(appJSXElement)
     appJSXElement.replaceWith(<span class="hljs-function">(<span class="hljs-params">{ node }</span>) =&gt;</span> {
         <span class="hljs-keyword">return</span> jscodeshift.jsxElement(
            jscodeshift.jsxOpeningElement(jscodeshift.jsxIdentifier(<span class="hljs-string">&apos;Router&apos;</span>)), jscodeshift.jsxClosingElement(jscodeshift.jsxIdentifier(<span class="hljs-string">&apos;Router&apos;</span>)), [
                jscodeshift.jsxExpressionContainer(
                    jscodeshift.callExpression(jscodeshift.identifier(<span class="hljs-string">&apos;renderRoutes&apos;</span>),[jscodeshift.identifier(<span class="hljs-string">&apos;routesConfig&apos;</span>)])
                )
            ], <span class="hljs-literal">false</span>
         );
    })
    <span class="hljs-keyword">return</span> root.toSource()
}
</code></pre>
<h2 id="t7113.&#x53D1;&#x5E03;">13.&#x53D1;&#x5E03; <a href="#t7113.&#x53D1;&#x5E03;"> # </a></h2>
<h3 id="t7213.1 &#x521B;&#x5EFA;&#x7EC4;&#x7EC7;">13.1 &#x521B;&#x5EFA;&#x7EC4;&#x7EC7; <a href="#t7213.1 &#x521B;&#x5EFA;&#x7EC4;&#x7EC7;"> # </a></h3>
<ul>
<li><a href="https://www.npmjs.com/org/create">create</a></li>
</ul>
<h3 id="t7313.2 &#x53D1;&#x5E03;">13.2 &#x53D1;&#x5E03; <a href="#t7313.2 &#x53D1;&#x5E03;"> # </a></h3>
<p>package.json</p>
<pre><code class="lang-js">{
  <span class="hljs-string">&quot;publishConfig&quot;</span>: {
    <span class="hljs-string">&quot;access&quot;</span>: <span class="hljs-string">&quot;public&quot;</span>,
    <span class="hljs-string">&quot;registry&quot;</span>: <span class="hljs-string">&quot;http://registry.npmjs.org&quot;</span>
  }
}
</code></pre>
<pre><code class="lang-js">npm whoami
npm login
zhangrenyang2000
lerna publish
</code></pre>
<h2 id="t7414.&#x53C2;&#x8003;">14.&#x53C2;&#x8003; <a href="#t7414.&#x53C2;&#x8003;"> # </a></h2>
<h3 id="t7514.1 lerna">14.1 lerna <a href="#t7514.1 lerna"> # </a></h3>
<table>
<thead>
<tr>
<th style="text-align:left">&#x547D;&#x4EE4;</th>
<th style="text-align:left">&#x529F;&#x80FD;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">lerna bootstrap</td>
<td style="text-align:left">&#x5B89;&#x88C5;&#x4F9D;&#x8D56;</td>
</tr>
<tr>
<td style="text-align:left">lerna clean</td>
<td style="text-align:left">&#x5220;&#x9664;&#x5404;&#x4E2A;&#x5305;&#x4E0B;&#x7684;node_modules</td>
</tr>
<tr>
<td style="text-align:left">lerna init</td>
<td style="text-align:left">&#x521B;&#x5EFA;&#x65B0;&#x7684;lerna&#x5E93;</td>
</tr>
<tr>
<td style="text-align:left">lerna list</td>
<td style="text-align:left">&#x67E5;&#x770B;&#x672C;&#x5730;&#x5305;&#x5217;&#x8868;</td>
</tr>
<tr>
<td style="text-align:left">lerna changed</td>
<td style="text-align:left">&#x663E;&#x793A;&#x81EA;&#x4E0A;&#x6B21;release tag&#x4EE5;&#x6765;&#x6709;&#x4FEE;&#x6539;&#x7684;&#x5305;&#xFF0C; &#x9009;&#x9879;&#x901A; list</td>
</tr>
<tr>
<td style="text-align:left">lerna diff</td>
<td style="text-align:left">&#x663E;&#x793A;&#x81EA;&#x4E0A;&#x6B21;release tag&#x4EE5;&#x6765;&#x6709;&#x4FEE;&#x6539;&#x7684;&#x5305;&#x7684;&#x5DEE;&#x5F02;&#xFF0C; &#x6267;&#x884C; git diff</td>
</tr>
<tr>
<td style="text-align:left">lerna exec</td>
<td style="text-align:left">&#x5728;&#x6BCF;&#x4E2A;&#x5305;&#x76EE;&#x5F55;&#x4E0B;&#x6267;&#x884C;&#x4EFB;&#x610F;&#x547D;&#x4EE4;</td>
</tr>
<tr>
<td style="text-align:left">lerna run</td>
<td style="text-align:left">&#x6267;&#x884C;&#x6BCF;&#x4E2A;&#x5305;package.json&#x4E2D;&#x7684;&#x811A;&#x672C;&#x547D;&#x4EE4;</td>
</tr>
<tr>
<td style="text-align:left">lerna add</td>
<td style="text-align:left">&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x5305;&#x7684;&#x7248;&#x672C;&#x4E3A;&#x5404;&#x4E2A;&#x5305;&#x7684;&#x4F9D;&#x8D56;</td>
</tr>
<tr>
<td style="text-align:left">lerna import</td>
<td style="text-align:left">&#x5F15;&#x5165;package</td>
</tr>
<tr>
<td style="text-align:left">lerna link</td>
<td style="text-align:left">&#x94FE;&#x63A5;&#x4E92;&#x76F8;&#x5F15;&#x7528;&#x7684;&#x5E93;</td>
</tr>
<tr>
<td style="text-align:left">lerna create</td>
<td style="text-align:left">&#x65B0;&#x5EFA;package</td>
</tr>
<tr>
<td style="text-align:left">lerna publish</td>
<td style="text-align:left">&#x53D1;&#x5E03;</td>
</tr>
</tbody>
</table>
<h3 id="t7614.3 yarn">14.3 yarn <a href="#t7614.3 yarn"> # </a></h3>
<table>
<thead>
<tr>
<th style="text-align:left">&#x547D;&#x4EE4;</th>
<th style="text-align:left">&#x8BF4;&#x660E;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">yarn -v</td>
<td style="text-align:left">&#x67E5;&#x770B;yarn&#x7248;&#x672C;</td>
</tr>
<tr>
<td style="text-align:left">yarn config list</td>
<td style="text-align:left">&#x67E5;&#x770B;yarn&#x7684;&#x6240;&#x6709;&#x914D;&#x7F6E;</td>
</tr>
<tr>
<td style="text-align:left">yarn config set registry <a href="https://registry.npm.taobao.org/">https://registry.npm.taobao.org/</a></td>
<td style="text-align:left">&#x4FEE;&#x6539;yarn&#x7684;&#x6E90;&#x955C;&#x50CF;&#x4E3A;&#x6DD8;&#x5B9D;&#x6E90;</td>
</tr>
<tr>
<td style="text-align:left">yarn config set global-folder &quot;D:\RTE\Yarn\global&quot;</td>
<td style="text-align:left">&#x4FEE;&#x6539;&#x5168;&#x5C40;&#x5B89;&#x88C5;&#x76EE;&#x5F55;, &#x5148;&#x521B;&#x5EFA;&#x597D;&#x76EE;&#x5F55;(global), &#x6211;&#x653E;&#x5728;&#x4E86;Yarn&#x5B89;&#x88C5;&#x76EE;&#x5F55;&#x4E0B;(D:\RTE\Yarn\global)</td>
</tr>
<tr>
<td style="text-align:left">yarn config set prefix &quot;D:\RTE\Yarn\global\&quot;</td>
<td style="text-align:left">&#x4FEE;&#x6539;&#x5168;&#x5C40;&#x5B89;&#x88C5;&#x76EE;&#x5F55;&#x7684;bin&#x76EE;&#x5F55;&#x4F4D;&#x7F6E;</td>
</tr>
<tr>
<td style="text-align:left">yarn config set cache-folder &quot;D:\RTE\Yarn\cache&quot;</td>
<td style="text-align:left">&#x4FEE;&#x6539;&#x5168;&#x5C40;&#x7F13;&#x5B58;&#x76EE;&#x5F55;, &#x5148;&#x521B;&#x5EFA;&#x597D;&#x76EE;&#x5F55;(cache), &#x548C;global&#x653E;&#x5728;&#x540C;&#x4E00;&#x5C42;&#x76EE;&#x5F55;&#x4E0B;</td>
</tr>
<tr>
<td style="text-align:left">yarn config list</td>
<td style="text-align:left">&#x67E5;&#x770B;&#x6240;&#x6709;&#x914D;&#x7F6E;</td>
</tr>
<tr>
<td style="text-align:left">yarn global bin</td>
<td style="text-align:left">&#x67E5;&#x770B;&#x5F53;&#x524D;yarn&#x7684;bin&#x7684;&#x4F4D;&#x7F6E;</td>
</tr>
<tr>
<td style="text-align:left">yarn global dir</td>
<td style="text-align:left">&#x67E5;&#x770B;&#x5F53;&#x524D;yarn&#x7684;&#x5168;&#x5C40;&#x5B89;&#x88C5;&#x4F4D;&#x7F6E;</td>
</tr>
</tbody>
</table>
<h3 id="t7714.4  workspace">14.4  workspace <a href="#t7714.4  workspace"> # </a></h3>
<ul>
<li><a href="https://yarn.bootcss.com/docs/">yarn&#x5B98;&#x7F51;</a></li>
<li>yarn add &lt;package...&gt; [--ignore-workspace-root-check/-W]</li>
<li>yarn add &lt;package...&gt; [--dev/-D]</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">&#x4F5C;&#x7528;</th>
<th style="text-align:left">&#x547D;&#x4EE4;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&#x67E5;&#x770B;&#x5DE5;&#x4F5C;&#x7A7A;&#x95F4;&#x4FE1;&#x606F;</td>
<td style="text-align:left">yarn workspaces info</td>
</tr>
<tr>
<td style="text-align:left">&#x7ED9;&#x6240;&#x6709;&#x7684;&#x7A7A;&#x95F4;&#x6DFB;&#x52A0;&#x4F9D;&#x8D56;</td>
<td style="text-align:left">yarn workspaces run add lodash</td>
</tr>
<tr>
<td style="text-align:left">&#x7ED9;&#x6839;&#x7A7A;&#x95F4;&#x6DFB;&#x52A0;&#x4F9D;&#x8D56;</td>
<td style="text-align:left">yarn add -W -D typescript jest</td>
</tr>
<tr>
<td style="text-align:left">&#x7ED9;&#x67D0;&#x4E2A;&#x9879;&#x76EE;&#x6DFB;&#x52A0;&#x4F9D;&#x8D56;</td>
<td style="text-align:left">yarn workspace create-react-app3 add commander</td>
</tr>
<tr>
<td style="text-align:left">&#x5220;&#x9664;&#x6240;&#x6709;&#x7684; node_modules</td>
<td style="text-align:left">lerna clean &#x7B49;&#x4E8E; yarn workspaces run clean</td>
</tr>
<tr>
<td style="text-align:left">&#x5B89;&#x88C5;&#x548C;link&#x6240;&#x6709;&#x7684;&#x540D;</td>
<td style="text-align:left">yarn install &#x7B49;&#x4E8E; lerna bootstrap --npm-client yarn --use-workspaces</td>
</tr>
<tr>
<td style="text-align:left">&#x91CD;&#x65B0;&#x83B7;&#x53D6;&#x6240;&#x6709;&#x7684; node_modules</td>
<td style="text-align:left">yarn install --force</td>
</tr>
<tr>
<td style="text-align:left">&#x67E5;&#x770B;&#x7F13;&#x5B58;&#x76EE;&#x5F55;</td>
<td style="text-align:left">yarn cache dir</td>
</tr>
<tr>
<td style="text-align:left">&#x6E05;&#x9664;&#x672C;&#x5730;&#x7F13;&#x5B58;</td>
<td style="text-align:left">yarn cache clean</td>
</tr>
<tr>
<td style="text-align:left">&#x5728;&#x6240;&#x6709;package&#x4E2D;&#x8FD0;&#x884C;&#x6307;&#x5B9A;&#x7684;&#x547D;&#x4EE4;</td>
<td style="text-align:left">yarn workspaces run <command></td>
</tr>
</tbody>
</table>
<h3 id="t7814.3 yargs">14.3 yargs <a href="#t7814.3 yargs"> # </a></h3>
<ul>
<li><a href="https://www.npmjs.com/package/yargs">yargs</a>&#x5E2E;&#x52A9;&#x4F60;&#x6784;&#x5EFA;&#x4EA4;&#x4E92;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x4EE5;&#x89E3;&#x6790;&#x53C2;&#x6570;&#x751F;&#x6210;&#x4F18;&#x96C5;&#x7684;&#x7528;&#x6237;&#x754C;&#x9762;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> yargs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;yargs/yargs&quot;</span>);
<span class="hljs-keyword">const</span> cli = yargs();
cli
    .usage(<span class="hljs-string">`Usage: vite100 &lt;command&gt; [options]`</span>)
    .demandCommand(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x547D;&#x4EE4;&quot;</span>)
    .strict()
    .recommendCommands()
    .command({
        <span class="hljs-attr">command</span>: <span class="hljs-string">&quot;create &lt;name&gt;&quot;</span>,
        <span class="hljs-attr">describe</span>: <span class="hljs-string">&quot;&#x521B;&#x5EFA;&#x9879;&#x76EE;&quot;</span>,
        <span class="hljs-attr">builder</span>: <span class="hljs-function">(<span class="hljs-params">yargs</span>) =&gt;</span> {
            yargs.positional(<span class="hljs-string">&quot;name&quot;</span>, {
                <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;string&quot;</span>,
                <span class="hljs-attr">describe</span>: <span class="hljs-string">&quot;&#x9879;&#x76EE;&#x540D;&#x79F0;&quot;</span>,
            });
        },
        <span class="hljs-attr">handler</span>: <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">argv</span>) </span>{
           <span class="hljs-built_in">console</span>.log(argv);
           <span class="hljs-comment">//{ _: [ &apos;create&apos; ], &apos;$0&apos;: &apos;doc\\1.yargs.js&apos;, name: &apos;p1&apos; }</span>
        }
    })
    .parse(process.argv.slice(<span class="hljs-number">2</span>));

</code></pre>
<h3 id="t7914.5 node -e">14.5 node -e <a href="#t7914.5 node -e"> # </a></h3>
<ul>
<li><a href="https://nodejs.org/api/cli.html#cli_e_eval_script">node -e</a>&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x6267;&#x884C;&#x4E00;&#x6BB5;js&#x811A;&#x672C;&#x5E76;&#x8F93;&#x5165;</li>
<li>-e, --eval &quot;script&quot;</li>
<li>&#x8BBE;&#x7F6E;<code>stdion: &apos;inherit&apos;</code>,&#x5F53;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x65F6;,&#x5B50;&#x8FDB;&#x7A0B;&#x5C06;&#x4F1A;&#x7EE7;&#x627F;&#x4E3B;&#x8FDB;&#x7A0B;&#x7684;stdin&#x3001;stdout&#x548C;stderr</li>
</ul>
<pre><code class="lang-js">node -e <span class="hljs-string">&quot;console.log(process.argv)&quot;</span> -- a b
node -e <span class="hljs-string">&quot;console.log(JSON.parse(process.argv[1]))&quot;</span> -- <span class="hljs-string">&quot;{\&quot;name\&quot;:\&quot;zhufeng\&quot;}&quot;</span>
node -e <span class="hljs-string">&quot;console.log(process.cwd())&quot;</span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> spawn = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;cross-spawn&quot;</span>);
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">executeNodeScript</span>(<span class="hljs-params">{ cwd }, source, args</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> childProcess = spawn(
        process.execPath,
        [<span class="hljs-string">&quot;-e&quot;</span>, source, <span class="hljs-string">&quot;--&quot;</span>, <span class="hljs-built_in">JSON</span>.stringify(args)],
        { cwd, <span class="hljs-attr">stdio</span>: <span class="hljs-string">&quot;inherit&quot;</span> }
      );
      childProcess.on(<span class="hljs-string">&quot;close&quot;</span>, resolve);
    });
}
<span class="hljs-built_in">module</span>.exports = executeNodeScript;
</code></pre>
<h3 id="t8014.6 clone">14.6 clone <a href="#t8014.6 clone"> # </a></h3>
<ul>
<li><a href="https://www.npmjs.com/package/clone-git-repo">clone-git-repo</a>&#x7528;&#x6765;&#x514B;&#x9686;&#x548C;&#x4E0B;&#x8F7D;&#x4ED3;&#x5E93;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> clone = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;clone-git-repo&apos;</span>);
<span class="hljs-keyword">let</span> repository = <span class="hljs-string">&apos;gitee:zhufengtemplate/template-react#v1.0&apos;</span>;
clone(repository,<span class="hljs-string">&apos;./output&apos;</span>, {<span class="hljs-attr">clone</span>:<span class="hljs-literal">true</span>},<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
    <span class="hljs-built_in">console</span>.log(err);
})
</code></pre>
<h3 id="t8114.7 jscodeshift">14.7 jscodeshift <a href="#t8114.7 jscodeshift"> # </a></h3>
<ul>
<li><a href="https://www.npmjs.com/package/jscodeshift">jscodeshift</a>&#x662F;&#x4E00;&#x4E2A;&#x6267;&#x884C;&#x4EE3;&#x7801;&#x66F4;&#x6539;&#x7684;&#x5DE5;&#x5177;&#x5305;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">let</span> jscodeshift = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;jscodeshift&apos;</span>);
<span class="hljs-keyword">const</span> ast =  jscodeshift(<span class="hljs-string">`import ReactDOM from &quot;react-dom&quot;`</span>);
<span class="hljs-built_in">console</span>.log(ast.nodes());
<span class="hljs-built_in">console</span>.log(ast.nodes()[<span class="hljs-number">0</span>]);
<span class="hljs-built_in">console</span>.log(ast.nodes()[<span class="hljs-number">0</span>].program);
<span class="hljs-built_in">console</span>.log(ast.nodes()[<span class="hljs-number">0</span>].program.body[<span class="hljs-number">0</span>]);
</code></pre>
<h3 id="t8214.8 vue-codemod">14.8 vue-codemod <a href="#t8214.8 vue-codemod"> # </a></h3>
<ul>
<li><a href="https://www.npmjs.com/package/vue-codemod">vue-codemod</a>&#x5305;&#x542B;&#x4E86;&#x4EE3;&#x7801;&#x53D8;&#x91CF;&#x811A;&#x672C;&#x7684;&#x5DE5;&#x5177;&#x96C6;</li>
</ul>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> { runTransformation } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&apos;vue-codemod&apos;</span>)
<span class="hljs-keyword">let</span> file = <span class="hljs-string">&apos;index.js&apos;</span>;
<span class="hljs-keyword">let</span> source = <span class="hljs-string">`
import React from &apos;react&apos;;
`</span>;
<span class="hljs-keyword">let</span> imports = [<span class="hljs-string">&apos;import ReactDOM from &quot;react-dom&quot;&apos;</span>];
<span class="hljs-keyword">let</span> transformed = runTransformation(
    { <span class="hljs-attr">path</span>: file, source },
    injectImports,
    { imports }
)
<span class="hljs-built_in">console</span>.log(transformed);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">injectImports</span>(<span class="hljs-params">fileInfo, api, { imports }</span>) </span>{
    <span class="hljs-keyword">const</span> jscodeshift = api.jscodeshift
    <span class="hljs-keyword">const</span> root = jscodeshift(fileInfo.source)
    <span class="hljs-keyword">const</span> declarations = root.find(jscodeshift.ImportDeclaration)
    <span class="hljs-keyword">const</span> toImportAST = <span class="hljs-function"><span class="hljs-params">imp</span> =&gt;</span> jscodeshift(<span class="hljs-string">`<span class="hljs-subst">${imp}</span>\n`</span>).nodes()[<span class="hljs-number">0</span>].program.body[<span class="hljs-number">0</span>]
    <span class="hljs-keyword">const</span> importASTNodes = imports.map(toImportAST);
    <span class="hljs-keyword">if</span> (declarations.length) {
        declarations.at(<span class="hljs-number">-1</span>).insertAfter(importASTNodes)
    } <span class="hljs-keyword">else</span> {
        root.get().node.program.body.unshift(...importASTNodes)
    }
    <span class="hljs-keyword">return</span> root.toSource()
}
</code></pre>

    </div>
</div>
<div class="modal fade" id="loginModal" tabindex="-1" role="dialog"
    aria-labelledby="loginModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                    aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="loginModalLabel">请登录</h4>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="username" class="control-label">姓名:</label>
                        <input type="text" class="form-control" id="username" placeholder="珠峰架构VIP会员系统用户名">
                    </div>
                    <div class="form-group">
                        <label for="password" class="control-label">密码:</label>
                        <input type="text" class="form-control" id="password" placeholder="珠峰架构VIP会员系统密码">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                    data-dismiss="modal">登录</button>
            </div>
        </div>
    </div>
</div>

<script>
let zhufengjiagou = localStorage.getItem('zhufengjiagou');
const host = 'http://login.zhufengpeixun.com';
if(zhufengjiagou){
  fetch(host+'/check',{method:"GET",mode: 'cors',
　　headers: {'Content-Type': 'application/json', authorization: `Bearer ${zhufengjiagou}`}}).then(response => response.json()).then(res => {
    if(res.success){
     
    }else{
      $('#loginModal').modal('show')
    }
  }) 
}else{
   $('#loginModal').modal('show')
}

$('#loginModal').on('hidden.bs.modal', function (event) {
  var modal = $(this)
  let username = modal.find('.modal-body #username').val();
  let password = modal.find('.modal-body #password').val();
  fetch(host+'/login',{method:"POST",mode: 'cors',
　　headers: {'Content-Type': 'application/json'},
　　body:JSON.stringify({username,password})}).then(response => response.json()).then(res => {
  console.log(res);
    if(res.success){
      localStorage.setItem('zhufengjiagou',res.zhufengjiagou);
    }else{
      window.location.href = 'http://www.zhufengpeixun.cn';
    }
  })
})
</script>
<script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script src="../static/bootstrap/bootstrap.min.js"></script>
<script>
$('.warpper .page-toc ul ul li a').on('click',function(){
  $('.warpper .page-toc ul ul li a').removeClass('my-active')
  $(this).addClass('my-active')
})
$('.logo').on('mouseenter',function(){
  $('.nav').height('450px');
})
$('.nav').on('mouseleave',function(){
  $('.nav').height('80px');
})
$('.logo').on('click',function(){
  // $(".nav").css("display", "none");
 $('.warpper').css('padding','0px');
})
</script><script type="text/javascript" src="../static/js/theme.js"></script>
</body>
</html>
